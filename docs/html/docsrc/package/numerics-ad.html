
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>Automatic Differentiation &#8212; PorePy 1.5 documentation</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/nature.css" />
    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="1. How-To docstring" href="../howto/howto-docstring.html" />
    <link rel="prev" title="Numerics" href="numerics.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="../howto/howto-docstring.html" title="1. How-To docstring"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="numerics.html" title="Numerics"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../home.html">PorePy</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="numerics.html" accesskey="U">Numerics</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Automatic Differentiation</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="automatic-differentiation">
<h1>Automatic Differentiation<a class="headerlink" href="#automatic-differentiation" title="Permalink to this heading">¶</a></h1>
<p>The AD framework (<em>Algorithmic</em> or <em>Automatic</em> Differentiation) allows an object-oriented
representation of variables and other mathematical terms, which appear in equations
and models. The goal as for any AD framework is to provide a cheap and and automated evaluation
of derivatives, to be utilized in numerical approximation techniques.</p>
<p>All classes and functions can be accessed as shown the following example:</p>
<div class="literal-block-wrapper docutils container" id="id1">
<div class="code-block-caption"><span class="caption-text">Access to AD submodule</span><a class="headerlink" href="#id1" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">porepy</span> <span class="k">as</span> <span class="nn">pp</span>

<span class="n">a</span> <span class="o">=</span> <span class="n">pp</span><span class="o">.</span><span class="n">ad</span><span class="o">.</span><span class="n">Scalar</span><span class="p">(</span><span class="mf">1.</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>PorePy uses the <em>Forward Accumulation</em> technique. The numerical value of a nested expression
and its derivative are evaluated recursively and inside out using the chain rule.
The order of evaluations of subterms is given by Python’s
<a class="reference external" href="https://docs.python.org/3.6/reference/expressions.html#operator-precedence">operator precedence</a>.</p>
<p>Central to the AD framework are the classes <a class="reference internal" href="#porepy.ad.Ad_array" title="porepy.ad.Ad_array"><code class="xref py py-class docutils literal notranslate"><span class="pre">Ad_array</span></code></a> and <a class="reference internal" href="#porepy.ad.Operator" title="porepy.ad.Operator"><code class="xref py py-class docutils literal notranslate"><span class="pre">Operator</span></code></a>.
They provide access to numeric values and derivatives of basic arithmetic operations, and a
tree-like data structure for the recursive evaluation respectively.
It also provides a wrapper for discretizations of operators like the mathematical divergence,
enabling the user to program equations in a symbolic way.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The expression <em>operator</em> might cause confusion.
In the sense of <code class="docutils literal notranslate"><span class="pre">porepy.ad</span></code>, every object is an operator returning a numerical
representation of the represented term, based on some information. What information is
necessary and what is provided is documented in individual classes.</p>
</div>
<p>PorePy AD provides objects for</p>
<blockquote>
<div><ul class="simple">
<li><p><a class="reference internal" href="#elemental-ad-data-structures">Elemental AD data structures</a></p></li>
<li><p><a class="reference internal" href="#common-mathematical-functions">Common mathematical functions</a></p></li>
<li><p><a class="reference internal" href="#ad-representation-of-constant-scalars-vectors-and-matrices">AD-representation of constant scalars, vectors and matrices</a></p></li>
<li><p><a class="reference internal" href="#variables-on-single-and-mixed-dimensional-domains">Variables on single and mixed-dimensional domains</a></p></li>
<li><p><a class="reference internal" href="#operator-functions">Operator functions</a></p></li>
<li><p><a class="reference internal" href="#grid-operators">Grid operators</a></p></li>
<li><p><a class="reference internal" href="#numerical-discretization-schemes">Numerical discretization schemes</a></p></li>
<li><p><a class="reference internal" href="#ad-equation-manager">AD Equation Manager</a></p></li>
</ul>
</div></blockquote>
<section id="elemental-ad-data-structures">
<h2>Elemental AD data structures<a class="headerlink" href="#elemental-ad-data-structures" title="Permalink to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="porepy.ad.Ad_array">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Ad_array</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">jac</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#porepy.ad.Ad_array" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="porepy.ad.Ad_array.copy">
<span class="sig-name descname"><span class="pre">copy</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#porepy.ad.Ad_array.copy" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="porepy.ad.Ad_array.diagvec_mul_jac">
<span class="sig-name descname"><span class="pre">diagvec_mul_jac</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#porepy.ad.Ad_array.diagvec_mul_jac" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="porepy.ad.Ad_array.full_jac">
<span class="sig-name descname"><span class="pre">full_jac</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#porepy.ad.Ad_array.full_jac" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="porepy.ad.Ad_array.jac_mul_diagvec">
<span class="sig-name descname"><span class="pre">jac_mul_diagvec</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#porepy.ad.Ad_array.jac_mul_diagvec" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="porepy.ad.Operator">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Operator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subdomains</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.11)"><span class="pre">List</span></a><span class="p"><span class="pre">[</span></span><span class="pre">Grid</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interfaces</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.11)"><span class="pre">List</span></a><span class="p"><span class="pre">[</span></span><span class="pre">MortarGrid</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tree</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#porepy.ad.Tree" title="porepy.numerics.ad.operators.Tree"><span class="pre">Tree</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#porepy.ad.Operator" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Parent class for all AD operators.</p>
<p>This class is not meant to be initiated directly, rather the various
subclasses should be used. Instances of this class will still be created when
subclasses are combined by operations.</p>
<p>Contains a tree structure of child operators for the recursive forward evaluation.</p>
<p>Provides overload functions for basic arithmetic operations.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><em>str</em></a>) – Name of this operator. Used for string representations</p></li>
<li><p><strong>subdomains</strong> (<em>Grid</em><em>, </em><em>default=None</em>) – List of subdomains on which the operator is
defined. Will be empty for operators not associated with specific subdomains.</p></li>
<li><p><strong>interfaces</strong> (<em>MortarGrid</em><em>, </em><em>default=None</em>) – List of edges (tuple of subdomains) in the
mixed-dimensional grid on which the operator is defined.
Will be empty for operators not associated with specific subdomains.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="porepy.ad.Operator.interfaces">
<span class="sig-name descname"><span class="pre">interfaces</span></span><a class="headerlink" href="#porepy.ad.Operator.interfaces" title="Permalink to this definition">¶</a></dt>
<dd><p>See description of argument <code class="docutils literal notranslate"><span class="pre">interfaces</span></code>.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="porepy.ad.Operator.subdomains">
<span class="sig-name descname"><span class="pre">subdomains</span></span><a class="headerlink" href="#porepy.ad.Operator.subdomains" title="Permalink to this definition">¶</a></dt>
<dd><p>See description of argument <code class="docutils literal notranslate"><span class="pre">subdomains</span></code>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="porepy.ad.Operator.discretize">
<span class="sig-name descname"><span class="pre">discretize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mdg</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">MixedDimensionalGrid</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><span class="pre">None</span></a></span></span><a class="headerlink" href="#porepy.ad.Operator.discretize" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform the <code class="docutils literal notranslate"><span class="pre">discretize</span></code> function of all child operators which are discretizations
using data from mdg.</p>
<p>IMPLEMENTATION NOTE: The discretizations was identified at initialization of
Expression - it is now done here to accommodate updates (?) and</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="porepy.ad.Operator.evaluate">
<span class="sig-name descname"><span class="pre">evaluate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dof_manager</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DofManager</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)"><span class="pre">ndarray</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#porepy.ad.Ad_array" title="porepy.numerics.ad.forward_mode.Ad_array"><span class="pre">Ad_array</span></a></span></span><a class="headerlink" href="#porepy.ad.Operator.evaluate" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate the residual and Jacobian matrix for a given state.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dof_manager</strong> (<em>pp.DofManager</em>) – used to represent the problem. Will be used
to parse the sub-operators that combine to form this operator.</p></li>
<li><p><strong>state</strong> (<em>np.ndarray</em><em>, </em><em>optional</em>) – State vector for which the residual and its
derivatives should be formed. If not provided, the state will be pulled from
the previous iterate (if this exists), or alternatively from the state
at the previous time step.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A representation of the residual and Jacobian.
Note that the Jacobian matrix need not be invertible, or ever square;
this depends on the operator.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#porepy.ad.Ad_array" title="porepy.ad.Ad_array"><code class="xref py py-class docutils literal notranslate"><span class="pre">Ad_array</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="porepy.ad.Operator.is_leaf">
<span class="sig-name descname"><span class="pre">is_leaf</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><span class="pre">bool</span></a></span></span><a class="headerlink" href="#porepy.ad.Operator.is_leaf" title="Permalink to this definition">¶</a></dt>
<dd><p>Check if this operator is a leaf in the tree-representation of an expression.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>True if the operator has no children. Note that this implies that the
method parse() is expected to be implemented.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)">bool</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="porepy.ad.Operator.parse">
<span class="sig-name descname"><span class="pre">parse</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mdg</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">MixedDimensionalGrid</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.11)"><span class="pre">Any</span></a></span></span><a class="headerlink" href="#porepy.ad.Operator.parse" title="Permalink to this definition">¶</a></dt>
<dd><p>Translate the operator into a numerical expression.</p>
<p>Subclasses that represent atomic operators (leaves in a tree-representation of
an operator) should override this method to return e.g. a number, an array or a
matrix.
This method should not be called on operators that are formed as combinations
of atomic operators; such operators should be evaluated by the method <a class="reference internal" href="#porepy.ad.Operator.evaluate" title="porepy.ad.Operator.evaluate"><code class="xref py py-meth docutils literal notranslate"><span class="pre">evaluate()</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>mdg</strong> – Mixed-dimensional grid on which this operator is to be parsed.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A numerical format representing this operators value on given domain.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="porepy.ad.Operator.set_name">
<span class="sig-name descname"><span class="pre">set_name</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><span class="pre">str</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><span class="pre">None</span></a></span></span><a class="headerlink" href="#porepy.ad.Operator.set_name" title="Permalink to this definition">¶</a></dt>
<dd><p>Reset this object’s name originally passed at instantiation</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="porepy.ad.Operator.viz">
<span class="sig-name descname"><span class="pre">viz</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#porepy.ad.Operator.viz" title="Permalink to this definition">¶</a></dt>
<dd><p>Draws a visualization of the operator tree that has this operator as its root.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="porepy.ad.Tree">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Tree</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">operation</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Operation</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">children</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.11)"><span class="pre">List</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.11)"><span class="pre">Union</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#porepy.ad.Operator" title="porepy.numerics.ad.operators.Operator"><span class="pre">Operator</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#porepy.ad.Ad_array" title="porepy.numerics.ad.forward_mode.Ad_array"><span class="pre">Ad_array</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#porepy.ad.Tree" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Simple implementation of a Tree class. Used to represent combinations of
Ad operators.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>operation</strong> – see <code class="xref py py-data docutils literal notranslate"><span class="pre">Operation</span></code></p></li>
<li><p><strong>children</strong> – List of children, either as Ad arrays or other <a class="reference internal" href="#porepy.ad.Operator" title="porepy.ad.Operator"><code class="xref py py-class docutils literal notranslate"><span class="pre">Operator</span></code></a>.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="porepy.ad.Tree.add_child">
<span class="sig-name descname"><span class="pre">add_child</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">node</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.11)"><span class="pre">Union</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#porepy.ad.Operator" title="porepy.numerics.ad.operators.Operator"><span class="pre">Operator</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#porepy.ad.Ad_array" title="porepy.numerics.ad.forward_mode.Ad_array"><span class="pre">Ad_array</span></a><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><span class="pre">None</span></a></span></span><a class="headerlink" href="#porepy.ad.Tree.add_child" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds a child to this instance.</p>
</dd></dl>

</dd></dl>

</section>
<section id="module-porepy.numerics.ad.functions">
<span id="common-mathematical-functions"></span><h2>Common mathematical functions<a class="headerlink" href="#module-porepy.numerics.ad.functions" title="Permalink to this heading">¶</a></h2>
<p>This module contains functions to be wrapped in a pp.ad.Function and used as part
of compound pp.ad.Operators, i.e. as (terms of) equations.</p>
<p>Some functions depend on non-ad objects. This requires that the function (f) be wrapped
in an ad Function using partial evaluation:</p>
<blockquote>
<div><p>from functools import partial
AdFunction = pp.ad.Function(partial(f, other_parameter), “name”)
equation: pp.ad.Operator = AdFunction(var) - 2 * var</p>
</div></blockquote>
<p>with var being some ad variable.</p>
<p>Note that while the argument to AdFunction is a pp.ad.Operator, the wrapping in
pp.ad.Function implies that upon parsing, the argument passed to f will be an Ad_array.</p>
<dl class="py class">
<dt class="sig sig-object py" id="porepy.numerics.ad.functions.RegularizedHeaviside">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">RegularizedHeaviside</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">regularization</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.11)"><span class="pre">Callable</span></a></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/porepy/numerics/ad/functions.html#RegularizedHeaviside"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#porepy.numerics.ad.functions.RegularizedHeaviside" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="porepy.numerics.ad.functions.abs">
<span class="sig-name descname"><span class="pre">abs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">var</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/porepy/numerics/ad/functions.html#abs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#porepy.numerics.ad.functions.abs" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="porepy.numerics.ad.functions.arccos">
<span class="sig-name descname"><span class="pre">arccos</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">var</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/porepy/numerics/ad/functions.html#arccos"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#porepy.numerics.ad.functions.arccos" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="porepy.numerics.ad.functions.arccosh">
<span class="sig-name descname"><span class="pre">arccosh</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">var</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/porepy/numerics/ad/functions.html#arccosh"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#porepy.numerics.ad.functions.arccosh" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="porepy.numerics.ad.functions.arcsin">
<span class="sig-name descname"><span class="pre">arcsin</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">var</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/porepy/numerics/ad/functions.html#arcsin"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#porepy.numerics.ad.functions.arcsin" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="porepy.numerics.ad.functions.arcsinh">
<span class="sig-name descname"><span class="pre">arcsinh</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">var</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/porepy/numerics/ad/functions.html#arcsinh"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#porepy.numerics.ad.functions.arcsinh" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="porepy.numerics.ad.functions.arctan">
<span class="sig-name descname"><span class="pre">arctan</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">var</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/porepy/numerics/ad/functions.html#arctan"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#porepy.numerics.ad.functions.arctan" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="porepy.numerics.ad.functions.arctanh">
<span class="sig-name descname"><span class="pre">arctanh</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">var</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/porepy/numerics/ad/functions.html#arctanh"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#porepy.numerics.ad.functions.arctanh" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="porepy.numerics.ad.functions.characteristic_function">
<span class="sig-name descname"><span class="pre">characteristic_function</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><span class="pre">float</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">var</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#porepy.ad.Ad_array" title="porepy.numerics.ad.forward_mode.Ad_array"><span class="pre">Ad_array</span></a></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/porepy/numerics/ad/functions.html#characteristic_function"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#porepy.numerics.ad.functions.characteristic_function" title="Permalink to this definition">¶</a></dt>
<dd><p>Characteristic function of an ad variable.</p>
<p>Returns 1 if var.val is within absolute tolerance = tol of zero. The derivative is set to
zero independent of var.val.</p>
<dl class="simple">
<dt>Usage note:</dt><dd><p>See module level documentation on how to wrap functions like this in ad.Function.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tol</strong> – float
Absolute tolerance for comparison with 0 using np.isclose.</p></li>
<li><p><strong>var</strong> – pp.ad.Ad_array
Ad operator (variable or expression).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>pp.ad.Ad_array</dt><dd><p>The characteristic function of var with appropriate val and jac attributes.</p>
</dd>
</dl>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="porepy.numerics.ad.functions.cos">
<span class="sig-name descname"><span class="pre">cos</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">var</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/porepy/numerics/ad/functions.html#cos"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#porepy.numerics.ad.functions.cos" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="porepy.numerics.ad.functions.cosh">
<span class="sig-name descname"><span class="pre">cosh</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">var</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/porepy/numerics/ad/functions.html#cosh"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#porepy.numerics.ad.functions.cosh" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="porepy.numerics.ad.functions.exp">
<span class="sig-name descname"><span class="pre">exp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">var</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/porepy/numerics/ad/functions.html#exp"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#porepy.numerics.ad.functions.exp" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="porepy.numerics.ad.functions.heaviside">
<span class="sig-name descname"><span class="pre">heaviside</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">var</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zerovalue</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><span class="pre">float</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.5</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/porepy/numerics/ad/functions.html#heaviside"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#porepy.numerics.ad.functions.heaviside" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="porepy.numerics.ad.functions.heaviside_smooth">
<span class="sig-name descname"><span class="pre">heaviside_smooth</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">var</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><span class="pre">float</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.001</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/porepy/numerics/ad/functions.html#heaviside_smooth"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#porepy.numerics.ad.functions.heaviside_smooth" title="Permalink to this definition">¶</a></dt>
<dd><p>Smooth (regularized) version of the Heaviside function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>var</strong> – Ad_array or ndarray
Input array.</p></li>
<li><p><strong>eps</strong> – float, optional
Regularization parameter. The default is 1E-3. The function will
convergence to the Heaviside function in the limit when eps –&gt; 0</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>Ad_array or ndarray (depending on the input)</dt><dd><p>Regularized heaviside function (and its Jacobian if applicable).</p>
</dd>
</dl>
</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<dl class="simple">
<dt>The analytical expression for the smooth version Heaviside function reads:</dt><dd><p>H_eps(x) = (1/2) * (1 + (2/pi) * arctan(x/eps)),</p>
</dd>
<dt>with its derivative smoothly approximating the Dirac delta function:</dt><dd><p>d(H(x))/dx = delta_eps = (1/pi) * (eps / (eps^2 + x^2)).</p>
</dd>
</dl>
<p>Reference: <a class="reference external" href="https://ieeexplore.ieee.org/document/902291">https://ieeexplore.ieee.org/document/902291</a></p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="porepy.numerics.ad.functions.l2_norm">
<span class="sig-name descname"><span class="pre">l2_norm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dim</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">var</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#porepy.ad.Ad_array" title="porepy.numerics.ad.forward_mode.Ad_array"><span class="pre">Ad_array</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#porepy.ad.Ad_array" title="porepy.numerics.ad.forward_mode.Ad_array"><span class="pre">Ad_array</span></a></span></span><a class="reference internal" href="../../_modules/porepy/numerics/ad/functions.html#l2_norm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#porepy.numerics.ad.functions.l2_norm" title="Permalink to this definition">¶</a></dt>
<dd><p>L2 norm of a vector variable.</p>
<p>For the example of dim=3 components and n vectors, the ordering is assumed
to be <code class="docutils literal notranslate"><span class="pre">[u0,</span> <span class="pre">v0,</span> <span class="pre">w0,</span> <span class="pre">u1,</span> <span class="pre">v1,</span> <span class="pre">w1,</span> <span class="pre">...,</span> <span class="pre">un,</span> <span class="pre">vn,</span> <span class="pre">wn]</span></code></p>
<p>Vectors satisfying ui=vi=wi=0 are assigned zero entries in the jacobi matrix</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>See module level documentation on how to wrap functions like this in ad.Function.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dim</strong> – int
Dimension, i.e. number of vector components.</p></li>
<li><p><strong>var</strong> – pp.ad.Ad_array
Ad operator (variable or expression) which is argument of the norm
function.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>pp.ad.Ad_array</dt><dd><p>The norm of var with appropriate val and jac attributes.</p>
</dd>
</dl>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="porepy.numerics.ad.functions.log">
<span class="sig-name descname"><span class="pre">log</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">var</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/porepy/numerics/ad/functions.html#log"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#porepy.numerics.ad.functions.log" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="porepy.numerics.ad.functions.maximum">
<span class="sig-name descname"><span class="pre">maximum</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">var0</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#porepy.ad.Ad_array" title="porepy.numerics.ad.forward_mode.Ad_array"><span class="pre">Ad_array</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">var1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.11)"><span class="pre">Union</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#porepy.ad.Ad_array" title="porepy.numerics.ad.forward_mode.Ad_array"><span class="pre">Ad_array</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)"><span class="pre">ndarray</span></a><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#porepy.ad.Ad_array" title="porepy.numerics.ad.forward_mode.Ad_array"><span class="pre">Ad_array</span></a></span></span><a class="reference internal" href="../../_modules/porepy/numerics/ad/functions.html#maximum"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#porepy.numerics.ad.functions.maximum" title="Permalink to this definition">¶</a></dt>
<dd><p>Ad maximum function represented as an Ad_array.</p>
<p>The second argument is allowed to be constant, with a numpy array originally
wrapped in a pp.ad.Array, whereas the first argument is expected to be an
Ad_array originating from a pp.ad.Operator.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>var0</strong> – pp.ad.Ad_array
Ad operator (variable or expression).</p></li>
<li><p><strong>var1</strong> – Union[pp.ad.Ad_array, pp.ad.Array]
Ad operator (variable or expression) OR ad Array.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>pp.ad.Ad_array</dt><dd><p>The maximum of var0 and var1 with appropriate val and jac attributes.</p>
</dd>
</dl>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="porepy.numerics.ad.functions.sign">
<span class="sig-name descname"><span class="pre">sign</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">var</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/porepy/numerics/ad/functions.html#sign"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#porepy.numerics.ad.functions.sign" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="porepy.numerics.ad.functions.sin">
<span class="sig-name descname"><span class="pre">sin</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">var</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/porepy/numerics/ad/functions.html#sin"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#porepy.numerics.ad.functions.sin" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="porepy.numerics.ad.functions.sinh">
<span class="sig-name descname"><span class="pre">sinh</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">var</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/porepy/numerics/ad/functions.html#sinh"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#porepy.numerics.ad.functions.sinh" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="porepy.numerics.ad.functions.tan">
<span class="sig-name descname"><span class="pre">tan</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">var</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/porepy/numerics/ad/functions.html#tan"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#porepy.numerics.ad.functions.tan" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="porepy.numerics.ad.functions.tanh">
<span class="sig-name descname"><span class="pre">tanh</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">var</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/porepy/numerics/ad/functions.html#tanh"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#porepy.numerics.ad.functions.tanh" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</section>
<section id="ad-representation-of-constant-scalars-vectors-and-matrices">
<h2>AD-representation of constant scalars, vectors and matrices<a class="headerlink" href="#ad-representation-of-constant-scalars-vectors-and-matrices" title="Permalink to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="porepy.ad.Scalar">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Scalar</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><span class="pre">float</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#porepy.ad.Scalar" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#porepy.ad.Operator" title="porepy.numerics.ad.operators.Operator"><code class="xref py py-class docutils literal notranslate"><span class="pre">Operator</span></code></a></p>
<p>Ad representation of a scalar.</p>
<p>This is a shallow wrapper around a real scalar. It may be useful to combine
the scalar with other types of Ad objects.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>value</strong> – Number to be wrapped as an AD operator.</p></li>
<li><p><strong>name</strong> – Name of this operator</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="porepy.ad.Scalar.parse">
<span class="sig-name descname"><span class="pre">parse</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mdg</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">MixedDimensionalGrid</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><span class="pre">float</span></a></span></span><a class="headerlink" href="#porepy.ad.Scalar.parse" title="Permalink to this definition">¶</a></dt>
<dd><p>See <a class="reference internal" href="#porepy.ad.Operator.parse" title="porepy.ad.Operator.parse"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Operator.parse()</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The wrapped number.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="porepy.ad.Array">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Array</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">values</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)"><span class="pre">ndarray</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#porepy.ad.Array" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#porepy.ad.Operator" title="porepy.numerics.ad.operators.Operator"><code class="xref py py-class docutils literal notranslate"><span class="pre">Operator</span></code></a></p>
<p>AD representation of a numpy array.</p>
<p>For sparse matrices, use <a class="reference internal" href="#porepy.ad.Matrix" title="porepy.ad.Matrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">Matrix</span></code></a> instead.</p>
<p>This is a shallow wrapper around the real array; it is needed to combine the array
with other types of AD operators.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>values</strong> – Numpy array to be represented.</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="porepy.ad.Array.parse">
<span class="sig-name descname"><span class="pre">parse</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mdg</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">MixedDimensionalGrid</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)"><span class="pre">ndarray</span></a></span></span><a class="headerlink" href="#porepy.ad.Array.parse" title="Permalink to this definition">¶</a></dt>
<dd><p>See <a class="reference internal" href="#porepy.ad.Operator.parse" title="porepy.ad.Operator.parse"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Operator.parse()</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The wrapped array</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="porepy.ad.Matrix">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Matrix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mat</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.sparse.spmatrix.html#scipy.sparse.spmatrix" title="(in SciPy v1.9.3)"><span class="pre">spmatrix</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#porepy.ad.Matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#porepy.ad.Operator" title="porepy.numerics.ad.operators.Operator"><code class="xref py py-class docutils literal notranslate"><span class="pre">Operator</span></code></a></p>
<p>Ad representation of a sparse matrix.</p>
<p>For dense matrices, use <a class="reference internal" href="#porepy.ad.Array" title="porepy.ad.Array"><code class="xref py py-class docutils literal notranslate"><span class="pre">Array</span></code></a> instead.</p>
<p>This is a shallow wrapper around the real matrix; it is needed to combine the matrix
with other types of Ad objects.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mat</strong> – Sparse matrix to be wrapped as an AD operator.</p></li>
<li><p><strong>name</strong> – Name of this operator</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="porepy.ad.Matrix.shape">
<span class="sig-name descname"><span class="pre">shape</span></span><a class="headerlink" href="#porepy.ad.Matrix.shape" title="Permalink to this definition">¶</a></dt>
<dd><p>Shape of the wrapped matrix.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.11)">tuple</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="porepy.ad.Matrix.parse">
<span class="sig-name descname"><span class="pre">parse</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mdg</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">MixedDimensionalGrid</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.sparse.spmatrix.html#scipy.sparse.spmatrix" title="(in SciPy v1.9.3)"><span class="pre">spmatrix</span></a></span></span><a class="headerlink" href="#porepy.ad.Matrix.parse" title="Permalink to this definition">¶</a></dt>
<dd><p>See <a class="reference internal" href="#porepy.ad.Operator.parse" title="porepy.ad.Operator.parse"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Operator.parse()</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The wrapped matrix.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="porepy.ad.Matrix.transpose">
<span class="sig-name descname"><span class="pre">transpose</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#porepy.ad.Matrix" title="porepy.numerics.ad.operators.Matrix"><span class="pre">Matrix</span></a></span></span><a class="headerlink" href="#porepy.ad.Matrix.transpose" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns an AD operator representing the transposed matrix.</p>
</dd></dl>

</dd></dl>

</section>
<section id="variables-on-single-and-mixed-dimensional-domains">
<h2>Variables on single and mixed-dimensional domains<a class="headerlink" href="#variables-on-single-and-mixed-dimensional-domains" title="Permalink to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="porepy.ad.Variable">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Variable</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">ndof</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Dict" title="(in Python v3.11)"><span class="pre">Dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subdomains</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.11)"><span class="pre">List</span></a><span class="p"><span class="pre">[</span></span><span class="pre">Grid</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interfaces</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.11)"><span class="pre">List</span></a><span class="p"><span class="pre">[</span></span><span class="pre">MortarGrid</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_cells</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">previous_timestep</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">previous_iteration</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#porepy.ad.Variable" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#porepy.ad.Operator" title="porepy.numerics.ad.operators.Operator"><code class="xref py py-class docutils literal notranslate"><span class="pre">Operator</span></code></a></p>
<p>AD operator representing a variable defined on a single <code class="xref py py-class docutils literal notranslate"><span class="pre">Grid</span></code> or
<code class="xref py py-class docutils literal notranslate"><span class="pre">MortarGrid</span></code>.</p>
<p>For combinations of variables on different subdomains, see <a class="reference internal" href="#porepy.ad.MergedVariable" title="porepy.ad.MergedVariable"><code class="xref py py-class docutils literal notranslate"><span class="pre">MergedVariable</span></code></a>.</p>
<p>A conversion of the variable into numerical value should be done with respect to the
state of an array; see <a class="reference internal" href="#porepy.ad.Operator.evaluate" title="porepy.ad.Operator.evaluate"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Operator.evaluate()</span></code></a>. Therefore, the variable does not
implement the method <a class="reference internal" href="#porepy.ad.Operator.parse" title="porepy.ad.Operator.parse"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Operator.parse()</span></code></a>.</p>
<p>A variable is associated with either a grid or an interface. Therefore it is assumed that
either <code class="docutils literal notranslate"><span class="pre">subdomains</span></code> or <code class="docutils literal notranslate"><span class="pre">interfaces</span></code> is passed as an argument.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><em>str</em></a>) – Variable name.</p></li>
<li><p><strong>ndof</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.11)"><em>dict</em></a>) – Number of dofs per grid element.
Valid keys are <code class="docutils literal notranslate"><span class="pre">cells</span></code>, <code class="docutils literal notranslate"><span class="pre">faces</span></code> and <code class="docutils literal notranslate"><span class="pre">nodes</span></code>.</p></li>
<li><p><strong>subdomains</strong> (<em>length=1</em>) – List containing a single <code class="xref py py-class docutils literal notranslate"><span class="pre">Grid</span></code>.</p></li>
<li><p><strong>interfaces</strong> (<em>length=1</em>) – List containing a single <code class="xref py py-class docutils literal notranslate"><span class="pre">MortarGrid</span></code>.</p></li>
<li><p><strong>num_cells</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a>) – Number of cells in the grid.
Only relevant if this is an interface variable.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="porepy.ad.Variable.id">
<span class="sig-name descname"><span class="pre">id</span></span><a class="headerlink" href="#porepy.ad.Variable.id" title="Permalink to this definition">¶</a></dt>
<dd><p>Unique identifier of this variable.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)">int</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="porepy.ad.Variable.prev_iter">
<span class="sig-name descname"><span class="pre">prev_iter</span></span><a class="headerlink" href="#porepy.ad.Variable.prev_iter" title="Permalink to this definition">¶</a></dt>
<dd><p>Indicates whether the variable represents the state at the
previous iteration.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>boolean</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="porepy.ad.Variable.prev_time">
<span class="sig-name descname"><span class="pre">prev_time</span></span><a class="headerlink" href="#porepy.ad.Variable.prev_time" title="Permalink to this definition">¶</a></dt>
<dd><p>Indicates whether the variable represents the state at the
previous time step.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>boolean</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="porepy.ad.Variable.subdomains">
<span class="sig-name descname"><span class="pre">subdomains</span></span><a class="headerlink" href="#porepy.ad.Variable.subdomains" title="Permalink to this definition">¶</a></dt>
<dd><p>Subdomain on which this variable is defined;
see argument <code class="docutils literal notranslate"><span class="pre">subdomains</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.11)">list</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="porepy.ad.Variable.interfaces">
<span class="sig-name descname"><span class="pre">interfaces</span></span><a class="headerlink" href="#porepy.ad.Variable.interfaces" title="Permalink to this definition">¶</a></dt>
<dd><p>Edge (tuple of subdomains) on which this variable is defined;
see argument <code class="docutils literal notranslate"><span class="pre">interfaces</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.11)">list</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="porepy.ad.Variable.previous_iteration">
<span class="sig-name descname"><span class="pre">previous_iteration</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#porepy.ad.Variable" title="porepy.numerics.ad.operators.Variable"><span class="pre">Variable</span></a></span></span><a class="headerlink" href="#porepy.ad.Variable.previous_iteration" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A representation of this variable on the previous time iteration,
with its <code class="docutils literal notranslate"><span class="pre">prev_iter</span></code> attribute set to <code class="docutils literal notranslate"><span class="pre">True</span></code>.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#porepy.ad.Variable" title="porepy.ad.Variable">Variable</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="porepy.ad.Variable.previous_timestep">
<span class="sig-name descname"><span class="pre">previous_timestep</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#porepy.ad.Variable" title="porepy.numerics.ad.operators.Variable"><span class="pre">Variable</span></a></span></span><a class="headerlink" href="#porepy.ad.Variable.previous_timestep" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A representation of this variable at the previous time step,
with its <code class="docutils literal notranslate"><span class="pre">prev_time</span></code> attribute set to <code class="docutils literal notranslate"><span class="pre">True</span></code>.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#porepy.ad.Variable" title="porepy.ad.Variable">Variable</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="porepy.ad.Variable.size">
<span class="sig-name descname"><span class="pre">size</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><span class="pre">int</span></a></span></span><a class="headerlink" href="#porepy.ad.Variable.size" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The number of dofs of this variable on its grid.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)">int</a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="porepy.ad.MergedVariable">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">MergedVariable</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">variables</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.11)"><span class="pre">List</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#porepy.ad.Variable" title="porepy.numerics.ad.operators.Variable"><span class="pre">Variable</span></a><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#porepy.ad.MergedVariable" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#porepy.ad.Variable" title="porepy.numerics.ad.operators.Variable"><code class="xref py py-class docutils literal notranslate"><span class="pre">Variable</span></code></a></p>
<p>AD operator representing a collection of variables that individually live on separate
subdomains or interfaces, but treated jointly in the mixed-dimensional sense.</p>
<p>Conversion of the variables into numerical value should be done with respect to the
state of an array; see <a class="reference internal" href="#porepy.ad.Operator.evaluate" title="porepy.ad.Operator.evaluate"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Operator.evaluate()</span></code></a>. Therefore, the MergedVariable does not
implement the method <a class="reference internal" href="#porepy.ad.Operator.parse" title="porepy.ad.Operator.parse"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Operator.parse()</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>variables</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.11)"><em>list</em></a>) – List of variables to be merged. Should all have the same name.</p>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="porepy.ad.MergedVariable.sub_vars">
<span class="sig-name descname"><span class="pre">sub_vars</span></span><a class="headerlink" href="#porepy.ad.MergedVariable.sub_vars" title="Permalink to this definition">¶</a></dt>
<dd><p>List of variable on different subdomains or interfaces.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List of Variable</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="porepy.ad.MergedVariable.id">
<span class="sig-name descname"><span class="pre">id</span></span><a class="headerlink" href="#porepy.ad.MergedVariable.id" title="Permalink to this definition">¶</a></dt>
<dd><p>Counter of all variables. Used to identify variables. Usage of this
term is not clear, it may change.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)">int</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="porepy.ad.MergedVariable.prev_iter">
<span class="sig-name descname"><span class="pre">prev_iter</span></span><a class="headerlink" href="#porepy.ad.MergedVariable.prev_iter" title="Permalink to this definition">¶</a></dt>
<dd><p>Indicates whether the variable represents the state at the
previous iteration.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>boolean</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="porepy.ad.MergedVariable.prev_time">
<span class="sig-name descname"><span class="pre">prev_time</span></span><a class="headerlink" href="#porepy.ad.MergedVariable.prev_time" title="Permalink to this definition">¶</a></dt>
<dd><p>Indicates whether the variable represents the state at the
previous time step.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>boolean</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">It</span> <span class="pre">is</span> <span class="pre">assumed</span> <span class="pre">that</span> <span class="pre">exactly</span> <span class="pre">one</span> <span class="pre">of</span> <span class="pre">subdomains</span> <span class="pre">and</span> <span class="pre">interfaces</span> <span class="pre">is</span> <span class="pre">defined.</span></span></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="porepy.ad.MergedVariable.copy">
<span class="sig-name descname"><span class="pre">copy</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#porepy.ad.MergedVariable" title="porepy.numerics.ad.operators.MergedVariable"><span class="pre">MergedVariable</span></a></span></span><a class="headerlink" href="#porepy.ad.MergedVariable.copy" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A shallow copy should be sufficient here; the attributes are not expected to
change.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="porepy.ad.MergedVariable.previous_iteration">
<span class="sig-name descname"><span class="pre">previous_iteration</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#porepy.ad.MergedVariable" title="porepy.numerics.ad.operators.MergedVariable"><span class="pre">MergedVariable</span></a></span></span><a class="headerlink" href="#porepy.ad.MergedVariable.previous_iteration" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A representation of this merged variable on the previous
iteration, with its <code class="docutils literal notranslate"><span class="pre">prev_iter</span></code> attribute set to <code class="docutils literal notranslate"><span class="pre">True</span></code></p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#porepy.ad.Variable" title="porepy.ad.Variable">Variable</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="porepy.ad.MergedVariable.previous_timestep">
<span class="sig-name descname"><span class="pre">previous_timestep</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#porepy.ad.MergedVariable" title="porepy.numerics.ad.operators.MergedVariable"><span class="pre">MergedVariable</span></a></span></span><a class="headerlink" href="#porepy.ad.MergedVariable.previous_timestep" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A representation of this merged variable on the previous time
iteration, with its <code class="docutils literal notranslate"><span class="pre">prev_iter</span></code> attribute set to <code class="docutils literal notranslate"><span class="pre">True</span></code>.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#porepy.ad.Variable" title="porepy.ad.Variable">Variable</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="porepy.ad.MergedVariable.size">
<span class="sig-name descname"><span class="pre">size</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><span class="pre">int</span></a></span></span><a class="headerlink" href="#porepy.ad.MergedVariable.size" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Total size of this merged variable (sum of sizes of respective sub-variables).</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)">int</a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="operator-functions">
<h2>Operator functions<a class="headerlink" href="#operator-functions" title="Permalink to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="porepy.numerics.ad.operator_functions.AbstractFunction">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">AbstractFunction</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">func</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.11)"><span class="pre">Callable</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">array_compatible</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ad_compatible</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/porepy/numerics/ad/operator_functions.html#AbstractFunction"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#porepy.numerics.ad.operator_functions.AbstractFunction" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#porepy.ad.Operator" title="porepy.numerics.ad.operators.Operator"><code class="xref py py-class docutils literal notranslate"><span class="pre">Operator</span></code></a></p>
<p>Abstract class for all operator functions, i.e. functions evaluated on some other AD
operators.</p>
<p>Implements the callable-functionality and provides abstract methods for obtaining function
values and the Jacobian.
The abstraction intends to provide means for approximating operators, where values are
e.g. interpolated and the Jacobian is approximated using FD.</p>
<dl>
<dt>IMPLEMENTATION NOTE:</dt><dd><p>One can flag the operator as <code class="docutils literal notranslate"><span class="pre">ad_compatible</span></code>. If flagged, the AD framework passes
AD arrays directly to the callable <code class="docutils literal notranslate"><span class="pre">func</span></code> and will <strong>not</strong> call the abstract methods
for values and the Jacobian during operator parsing.
If for some reason one wants to flag the function as AD compatible, but still have the
abstract methods called, this is as of now <strong>not</strong> supported.</p>
<p>For now only one child class, porepy.ad.Function, flags itself always as AD compatible.</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="porepy.numerics.ad.operator_functions.AbstractFunction.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">func</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.11)"><span class="pre">Callable</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">array_compatible</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ad_compatible</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/porepy/numerics/ad/operator_functions.html#AbstractFunction.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#porepy.numerics.ad.operator_functions.AbstractFunction.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Configures this instance as a valid AD operator.
The passed callable is expected to take numerical information in some form and
return numerical information in the same form form.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>func</strong> (<em>Callable</em>) – callable Python object representing a (numeric) function</p></li>
<li><p><strong>name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><em>str</em></a>) – name of this instance as an AD operator</p></li>
<li><p><strong>array_compatible</strong> (<em>default=False</em>) – If true, the callable <code class="docutils literal notranslate"><span class="pre">func</span></code> will be called
using arrays (numpy.typing.ArrayLike). Flagging this true, the user ensures
that the callable can work with arrays and return respectively
formatted output. If false, the function will be evaluated element-wise
(scalar input)</p></li>
<li><p><strong>ad_compatible</strong> (<em>default=False</em>) – <p>If true, the callable <code class="docutils literal notranslate"><span class="pre">func</span></code> will be called using
the porepy.ad.Ad_array.</p>
<p>Important NOTE: As of now, this will effectively bypass the abstract methods
for generating values and the Jacobian, assuming both will be provided
correctly by the return value of <code class="docutils literal notranslate"><span class="pre">func</span></code></p>
</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="porepy.numerics.ad.operator_functions.AbstractFunction.get_jacobian">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_jacobian</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#porepy.ad.Ad_array" title="porepy.numerics.ad.forward_mode.Ad_array"><span class="pre">Ad_array</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.sparse.spmatrix.html#scipy.sparse.spmatrix" title="(in SciPy v1.9.3)"><span class="pre">spmatrix</span></a></span></span><a class="reference internal" href="../../_modules/porepy/numerics/ad/operator_functions.html#AbstractFunction.get_jacobian"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#porepy.numerics.ad.operator_functions.AbstractFunction.get_jacobian" title="Permalink to this definition">¶</a></dt>
<dd><p>Abstract method for evaluating the Jacobian of the callable passed at instantiation.</p>
<p>This method will be called during the operator parsing.
The AD arrays passed as arguments will be in the same order as the operators passed to
the call to this instance.</p>
<p>The returned numpy array will be be set as ‘jac’ argument for the AD array representing
this instance.</p>
<p>NOTE: the necessary dimensions for the jacobian can be extracted from the dimensions
of the Jacobians of passed Ad_array instances.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>*args</strong> – Ad_array representation of the operators passed during the call to this
instance</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>numeric representation of the Jacobian of this function</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)">numpy.ndarray</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="porepy.numerics.ad.operator_functions.AbstractFunction.get_values">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_values</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#porepy.ad.Ad_array" title="porepy.numerics.ad.forward_mode.Ad_array"><span class="pre">Ad_array</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)"><span class="pre">ndarray</span></a></span></span><a class="reference internal" href="../../_modules/porepy/numerics/ad/operator_functions.html#AbstractFunction.get_values"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#porepy.numerics.ad.operator_functions.AbstractFunction.get_values" title="Permalink to this definition">¶</a></dt>
<dd><p>Abstract method for evaluating the callable passed at instantiation.</p>
<p>This method will be called during the operator parsing.
The AD arrays passed as arguments will be in the same order as the operators passed to
the call to this instance.</p>
<p>The returned numpy array will be set as ‘val’ argument for the AD array representing
this instance.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>*args</strong> – Ad_array representation of the operators passed during the call to this
instance</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>numeric function values</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)">numpy.ndarray</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="porepy.numerics.ad.operator_functions.AbstractFunction.parse">
<span class="sig-name descname"><span class="pre">parse</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">md</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">MixedDimensionalGrid</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/porepy/numerics/ad/operator_functions.html#AbstractFunction.parse"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#porepy.numerics.ad.operator_functions.AbstractFunction.parse" title="Permalink to this definition">¶</a></dt>
<dd><p>Parsing to a numerical value.</p>
<p>The real work will be done by combining the function with arguments, during
parsing of an operator tree.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>md</strong> – Mixed-dimensional grid.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The instance itself</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="porepy.numerics.ad.operator_functions.AbstractJacobianFunction">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">AbstractJacobianFunction</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">func</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.11)"><span class="pre">Callable</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">array_compatible</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ad_compatible</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/porepy/numerics/ad/operator_functions.html#AbstractJacobianFunction"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#porepy.numerics.ad.operator_functions.AbstractJacobianFunction" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#porepy.numerics.ad.operator_functions.AbstractFunction" title="porepy.numerics.ad.operator_functions.AbstractFunction"><code class="xref py py-class docutils literal notranslate"><span class="pre">AbstractFunction</span></code></a></p>
<p>‘Half’-abstract base class, providing a call to the callable <code class="docutils literal notranslate"><span class="pre">func</span></code> in order to obtain
numeric function values.</p>
<p>What remains abstract is the Jacobian.</p>
<dl class="py method">
<dt class="sig sig-object py" id="porepy.numerics.ad.operator_functions.AbstractJacobianFunction.get_values">
<span class="sig-name descname"><span class="pre">get_values</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#porepy.ad.Ad_array" title="porepy.numerics.ad.forward_mode.Ad_array"><span class="pre">Ad_array</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)"><span class="pre">ndarray</span></a></span></span><a class="reference internal" href="../../_modules/porepy/numerics/ad/operator_functions.html#AbstractJacobianFunction.get_values"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#porepy.numerics.ad.operator_functions.AbstractJacobianFunction.get_values" title="Permalink to this definition">¶</a></dt>
<dd><p>Abstract method for evaluating the callable passed at instantiation.</p>
<p>This method will be called during the operator parsing.
The AD arrays passed as arguments will be in the same order as the operators passed to
the call to this instance.</p>
<p>The returned numpy array will be set as ‘val’ argument for the AD array representing
this instance.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>*args</strong> – Ad_array representation of the operators passed during the call to this
instance</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>numeric function values</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)">numpy.ndarray</a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<span class="target" id="module-porepy.numerics.ad.operator_functions"></span><p>Contains callable operators representing functions to be called with other
operators as input arguments.
Contains also a decorator class for callables, which transforms them automatically in the
specified operator function type.</p>
<dl class="py class">
<dt class="sig sig-object py" id="porepy.numerics.ad.operator_functions.ADmethod">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ADmethod</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">func:</span> <span class="pre">~typing.Optional[~typing.Callable]</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ad_function_type:</span> <span class="pre">~typing.Type[~porepy.numerics.ad.operator_functions.AbstractFunction]</span> <span class="pre">=</span> <span class="pre">&lt;class</span> <span class="pre">'porepy.numerics.ad.operator_functions.Function'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">operator_kwargs:</span> <span class="pre">dict</span> <span class="pre">=</span> <span class="pre">{}</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/porepy/numerics/ad/operator_functions.html#ADmethod"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#porepy.numerics.ad.operator_functions.ADmethod" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Automatic-Differentiation method/function.</p>
<p>(Decorator) Class for methods representing e.g., physical properties.
The decorated function is expected to take scalars/vectors and return a scalar/vector.
See example usage below.</p>
<p>The return value will be an AD operator of a type passed to the decorator.</p>
<div class="literal-block-wrapper docutils container" id="id2">
<div class="code-block-caption"><span class="caption-text">Example usage</span><a class="headerlink" href="#id2" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">porepy</span> <span class="k">as</span> <span class="nn">pp</span>

<span class="c1"># decorating class methods</span>
<span class="k">class</span> <span class="nc">IdealGas</span><span class="p">:</span>

    <span class="nd">@ADmethod</span><span class="p">(</span><span class="n">ad_operator</span><span class="o">=</span><span class="n">pp</span><span class="o">.</span><span class="n">ad</span><span class="o">.</span><span class="n">DiagonalJacobianFunction</span><span class="p">,</span>
              <span class="n">operators_args</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;multipliers&quot;</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]})</span>
    <span class="k">def</span> <span class="nf">density</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">p</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">T</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">p</span><span class="o">/</span><span class="n">T</span>

<span class="c1"># decorating function</span>
<span class="nd">@ADmethod</span><span class="p">(</span><span class="n">ad_operator</span><span class="o">=</span><span class="n">pp</span><span class="o">.</span><span class="n">ad</span><span class="o">.</span><span class="n">Function</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">dummy_rel_perm</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">s</span><span class="o">**</span><span class="mi">2</span>
</pre></div>
</div>
</div>
<p>With above code, the density of an instance of ‘IdealGas’ can be called using
<a class="reference internal" href="#porepy.ad.MergedVariable" title="porepy.numerics.ad.operators.MergedVariable"><code class="xref py py-class docutils literal notranslate"><span class="pre">MergedVariable</span></code></a> representing
pressure and temperature.
Analogously, <cite>dummy_rel_perm</cite> can be called with one representing the saturation.</p>
<dl class="py method">
<dt class="sig sig-object py" id="porepy.numerics.ad.operator_functions.ADmethod.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">func:</span> <span class="pre">~typing.Optional[~typing.Callable]</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ad_function_type:</span> <span class="pre">~typing.Type[~porepy.numerics.ad.operator_functions.AbstractFunction]</span> <span class="pre">=</span> <span class="pre">&lt;class</span> <span class="pre">'porepy.numerics.ad.operator_functions.Function'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">operator_kwargs:</span> <span class="pre">dict</span> <span class="pre">=</span> <span class="pre">{}</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><span class="pre">None</span></a></span></span><a class="reference internal" href="../../_modules/porepy/numerics/ad/operator_functions.html#ADmethod.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#porepy.numerics.ad.operator_functions.ADmethod.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Decorator class constructor.
Saves information about the requested AD Function type and keyword arguments necessary
for its instantiation.</p>
<p>NOTE: If used as decorator WITHOUT explicit instantiation, the instantiation will be
done implicitly with above default arguments (that’s how Python decorators work).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>func</strong> – decorated function object</p></li>
<li><p><strong>ad_function_type</strong> – type reference to an AD operator function to be instantiated.
When instantiated, that instance will effectively replace <code class="docutils literal notranslate"><span class="pre">func</span></code>.</p></li>
<li><p><strong>operator_kwargs</strong> – keyword arguments to be passed when instantiating an operator
of type <code class="docutils literal notranslate"><span class="pre">ad_function_type</span></code>.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="porepy.numerics.ad.operator_functions.ADmethod.ad_wrapper">
<span class="sig-name descname"><span class="pre">ad_wrapper</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#porepy.numerics.ad.operator_functions.AbstractFunction" title="porepy.numerics.ad.operator_functions.AbstractFunction"><span class="pre">AbstractFunction</span></a></span></span><a class="reference internal" href="../../_modules/porepy/numerics/ad/operator_functions.html#ADmethod.ad_wrapper"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#porepy.numerics.ad.operator_functions.ADmethod.ad_wrapper" title="Permalink to this definition">¶</a></dt>
<dd><p>Actual wrapper function.
Constructs the necessary AD-Operator class wrapping the decorated callable
and performs the evaluation/call.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>*args</strong> – arguments for the call to the wrapping AD operator function</p></li>
<li><p><strong>**kwargs</strong> – keyword argument for the call to the wrapping Ad operator function</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="porepy.numerics.ad.operator_functions.ConstantFunction">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ConstantFunction</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">values</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)"><span class="pre">ndarray</span></a></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/porepy/numerics/ad/operator_functions.html#ConstantFunction"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#porepy.numerics.ad.operator_functions.ConstantFunction" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#porepy.numerics.ad.operator_functions.AbstractFunction" title="porepy.numerics.ad.operator_functions.AbstractFunction"><code class="xref py py-class docutils literal notranslate"><span class="pre">AbstractFunction</span></code></a></p>
<p>“Function representing constant, scalar values with no dependencies and ergo a
zero Jacobian.</p>
<p>It still has to be called though since it fulfills the notion of a ‘function’.</p>
<dl class="py method">
<dt class="sig sig-object py" id="porepy.numerics.ad.operator_functions.ConstantFunction.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">values</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)"><span class="pre">ndarray</span></a></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/porepy/numerics/ad/operator_functions.html#ConstantFunction.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#porepy.numerics.ad.operator_functions.ConstantFunction.__init__" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>values</strong> – constant values per cell</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="porepy.numerics.ad.operator_functions.ConstantFunction.get_jacobian">
<span class="sig-name descname"><span class="pre">get_jacobian</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#porepy.ad.Ad_array" title="porepy.numerics.ad.forward_mode.Ad_array"><span class="pre">Ad_array</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.sparse.spmatrix.html#scipy.sparse.spmatrix" title="(in SciPy v1.9.3)"><span class="pre">spmatrix</span></a></span></span><a class="reference internal" href="../../_modules/porepy/numerics/ad/operator_functions.html#ConstantFunction.get_jacobian"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#porepy.numerics.ad.operator_functions.ConstantFunction.get_jacobian" title="Permalink to this definition">¶</a></dt>
<dd><p>IMPLEMENTATION NOTE:
The return value is not a sparse matrix as imposed by the parent method signature,
but a zero.
Numerical operations with a zero always works with any numeric formats in
numpy, scipy and PorePy’s AD framework.
Since the constant function (most likely) gets no arguments passed,
we have no way of knowing the necessary SHAPE for a zero matrix. Hence scalar.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The trivial derivative of a constant.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="porepy.numerics.ad.operator_functions.ConstantFunction.get_values">
<span class="sig-name descname"><span class="pre">get_values</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#porepy.ad.Ad_array" title="porepy.numerics.ad.forward_mode.Ad_array"><span class="pre">Ad_array</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)"><span class="pre">ndarray</span></a></span></span><a class="reference internal" href="../../_modules/porepy/numerics/ad/operator_functions.html#ConstantFunction.get_values"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#porepy.numerics.ad.operator_functions.ConstantFunction.get_values" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The values passed at instantiation.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="porepy.numerics.ad.operator_functions.DiagonalJacobianFunction">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">DiagonalJacobianFunction</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">func</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.11)"><span class="pre">Callable</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">multipliers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.11)"><span class="pre">Union</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.11)"><span class="pre">List</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><span class="pre">float</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><span class="pre">float</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">array_compatible</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/porepy/numerics/ad/operator_functions.html#DiagonalJacobianFunction"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#porepy.numerics.ad.operator_functions.DiagonalJacobianFunction" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#porepy.numerics.ad.operator_functions.AbstractJacobianFunction" title="porepy.numerics.ad.operator_functions.AbstractJacobianFunction"><code class="xref py py-class docutils literal notranslate"><span class="pre">AbstractJacobianFunction</span></code></a></p>
<p>Approximates the Jacobian of the function using identities and scalar
multipliers per dependency.</p>
<dl class="py method">
<dt class="sig sig-object py" id="porepy.numerics.ad.operator_functions.DiagonalJacobianFunction.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">func</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.11)"><span class="pre">Callable</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">multipliers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.11)"><span class="pre">Union</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.11)"><span class="pre">List</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><span class="pre">float</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><span class="pre">float</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">array_compatible</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/porepy/numerics/ad/operator_functions.html#DiagonalJacobianFunction.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#porepy.numerics.ad.operator_functions.DiagonalJacobianFunction.__init__" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>multipliers</strong> – scalar multipliers for the identity blocks in the Jacobian,
per dependency of <code class="docutils literal notranslate"><span class="pre">func</span></code>. The order in <code class="docutils literal notranslate"><span class="pre">multipliers</span></code> is expected to match
the order of AD operators passed to the call of this function.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="porepy.numerics.ad.operator_functions.DiagonalJacobianFunction.get_jacobian">
<span class="sig-name descname"><span class="pre">get_jacobian</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#porepy.ad.Ad_array" title="porepy.numerics.ad.forward_mode.Ad_array"><span class="pre">Ad_array</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.sparse.spmatrix.html#scipy.sparse.spmatrix" title="(in SciPy v1.9.3)"><span class="pre">spmatrix</span></a></span></span><a class="reference internal" href="../../_modules/porepy/numerics/ad/operator_functions.html#DiagonalJacobianFunction.get_jacobian"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#porepy.numerics.ad.operator_functions.DiagonalJacobianFunction.get_jacobian" title="Permalink to this definition">¶</a></dt>
<dd><p>The approximate Jacobian consists of identity blocks times scalar multiplier
per every function dependency.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="porepy.numerics.ad.operator_functions.Function">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Function</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">func</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.11)"><span class="pre">Callable</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">array_compatible</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/porepy/numerics/ad/operator_functions.html#Function"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#porepy.numerics.ad.operator_functions.Function" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#porepy.numerics.ad.operator_functions.AbstractFunction" title="porepy.numerics.ad.operator_functions.AbstractFunction"><code class="xref py py-class docutils literal notranslate"><span class="pre">AbstractFunction</span></code></a></p>
<p>Ad representation of an analytically given function,
where it is expected that passing Ad_arrays directly to <code class="docutils literal notranslate"><span class="pre">func</span></code> will
return the proper result.</p>
<p>Here the values AND the Jacobian are obtained exactly by the AD framework.</p>
<p>The intended use is as a wrapper for operations on pp.ad.Ad_array objects,
in forms which are not directly or easily expressed by the rest of the Ad
framework.</p>
<p>NOTE: This is a special case where the abstract methods for getting values and the Jacobian
are formally implemented but never used by the AD framework (see <code class="docutils literal notranslate"><span class="pre">ad_compatible</span></code>)</p>
<dl class="py method">
<dt class="sig sig-object py" id="porepy.numerics.ad.operator_functions.Function.get_jacobian">
<span class="sig-name descname"><span class="pre">get_jacobian</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#porepy.ad.Ad_array" title="porepy.numerics.ad.forward_mode.Ad_array"><span class="pre">Ad_array</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)"><span class="pre">ndarray</span></a></span></span><a class="reference internal" href="../../_modules/porepy/numerics/ad/operator_functions.html#Function.get_jacobian"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#porepy.numerics.ad.operator_functions.Function.get_jacobian" title="Permalink to this definition">¶</a></dt>
<dd><p>Abstract method for evaluating the Jacobian of the callable passed at instantiation.</p>
<p>This method will be called during the operator parsing.
The AD arrays passed as arguments will be in the same order as the operators passed to
the call to this instance.</p>
<p>The returned numpy array will be be set as ‘jac’ argument for the AD array representing
this instance.</p>
<p>NOTE: the necessary dimensions for the jacobian can be extracted from the dimensions
of the Jacobians of passed Ad_array instances.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>*args</strong> – Ad_array representation of the operators passed during the call to this
instance</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>numeric representation of the Jacobian of this function</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)">numpy.ndarray</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="porepy.numerics.ad.operator_functions.Function.get_values">
<span class="sig-name descname"><span class="pre">get_values</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#porepy.ad.Ad_array" title="porepy.numerics.ad.forward_mode.Ad_array"><span class="pre">Ad_array</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)"><span class="pre">ndarray</span></a></span></span><a class="reference internal" href="../../_modules/porepy/numerics/ad/operator_functions.html#Function.get_values"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#porepy.numerics.ad.operator_functions.Function.get_values" title="Permalink to this definition">¶</a></dt>
<dd><p>Abstract method for evaluating the callable passed at instantiation.</p>
<p>This method will be called during the operator parsing.
The AD arrays passed as arguments will be in the same order as the operators passed to
the call to this instance.</p>
<p>The returned numpy array will be set as ‘val’ argument for the AD array representing
this instance.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>*args</strong> – Ad_array representation of the operators passed during the call to this
instance</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>numeric function values</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)">numpy.ndarray</a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="porepy.numerics.ad.operator_functions.InterpolatedFunction">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">InterpolatedFunction</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">func</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.11)"><span class="pre">Callable</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_val</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)"><span class="pre">ndarray</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_val</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)"><span class="pre">ndarray</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">npt</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)"><span class="pre">ndarray</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">preval</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">array_compatible</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/porepy/numerics/ad/operator_functions.html#InterpolatedFunction"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#porepy.numerics.ad.operator_functions.InterpolatedFunction" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#porepy.numerics.ad.operator_functions.AbstractFunction" title="porepy.numerics.ad.operator_functions.AbstractFunction"><code class="xref py py-class docutils literal notranslate"><span class="pre">AbstractFunction</span></code></a></p>
<p>Represents the passed function as an interpolation of chosen order on a cartesian,
uniform grid.</p>
<p>The image of the function is expected to be of dimension 1, while the domain can be
multidimensional.</p>
<dl class="py method">
<dt class="sig sig-object py" id="porepy.numerics.ad.operator_functions.InterpolatedFunction.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">func</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.11)"><span class="pre">Callable</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_val</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)"><span class="pre">ndarray</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_val</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)"><span class="pre">ndarray</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">npt</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)"><span class="pre">ndarray</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">preval</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">array_compatible</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/porepy/numerics/ad/operator_functions.html#InterpolatedFunction.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#porepy.numerics.ad.operator_functions.InterpolatedFunction.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>All vector-valued ndarray arguments are assumed to be column vectors.
Each row-entry represents a value for an argument of <code class="docutils literal notranslate"><span class="pre">func</span></code> in
respective order.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>min_val</strong> – lower bounds for the domain of <code class="docutils literal notranslate"><span class="pre">func</span></code>.</p></li>
<li><p><strong>max_val</strong> – upper bound for the domain.</p></li>
<li><p><strong>npt</strong> – number of interpolation points per dimension of the domain.</p></li>
<li><p><strong>order</strong> – Order of interpolation. Supports currently only linear order.</p></li>
<li><p><strong>preval</strong> (<em>default=False</em>) – If True, pre-evaluates the values of the function at
the points of interpolation and stores them.
If False, evaluates them if necessary.
Influences the runtime.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="porepy.numerics.ad.operator_functions.InterpolatedFunction.get_jacobian">
<span class="sig-name descname"><span class="pre">get_jacobian</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#porepy.ad.Ad_array" title="porepy.numerics.ad.forward_mode.Ad_array"><span class="pre">Ad_array</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.sparse.spmatrix.html#scipy.sparse.spmatrix" title="(in SciPy v1.9.3)"><span class="pre">spmatrix</span></a></span></span><a class="reference internal" href="../../_modules/porepy/numerics/ad/operator_functions.html#InterpolatedFunction.get_jacobian"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#porepy.numerics.ad.operator_functions.InterpolatedFunction.get_jacobian" title="Permalink to this definition">¶</a></dt>
<dd><p>Abstract method for evaluating the Jacobian of the callable passed at instantiation.</p>
<p>This method will be called during the operator parsing.
The AD arrays passed as arguments will be in the same order as the operators passed to
the call to this instance.</p>
<p>The returned numpy array will be be set as ‘jac’ argument for the AD array representing
this instance.</p>
<p>NOTE: the necessary dimensions for the jacobian can be extracted from the dimensions
of the Jacobians of passed Ad_array instances.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>*args</strong> – Ad_array representation of the operators passed during the call to this
instance</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>numeric representation of the Jacobian of this function</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)">numpy.ndarray</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="porepy.numerics.ad.operator_functions.InterpolatedFunction.get_values">
<span class="sig-name descname"><span class="pre">get_values</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#porepy.ad.Ad_array" title="porepy.numerics.ad.forward_mode.Ad_array"><span class="pre">Ad_array</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)"><span class="pre">ndarray</span></a></span></span><a class="reference internal" href="../../_modules/porepy/numerics/ad/operator_functions.html#InterpolatedFunction.get_values"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#porepy.numerics.ad.operator_functions.InterpolatedFunction.get_values" title="Permalink to this definition">¶</a></dt>
<dd><p>Abstract method for evaluating the callable passed at instantiation.</p>
<p>This method will be called during the operator parsing.
The AD arrays passed as arguments will be in the same order as the operators passed to
the call to this instance.</p>
<p>The returned numpy array will be set as ‘val’ argument for the AD array representing
this instance.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>*args</strong> – Ad_array representation of the operators passed during the call to this
instance</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>numeric function values</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)">numpy.ndarray</a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="grid-operators">
<h2>Grid operators<a class="headerlink" href="#grid-operators" title="Permalink to this heading">¶</a></h2>
<p>qwer</p>
</section>
<section id="numerical-discretization-schemes">
<h2>Numerical discretization schemes<a class="headerlink" href="#numerical-discretization-schemes" title="Permalink to this heading">¶</a></h2>
<p>qwer</p>
</section>
<section id="ad-equation-manager">
<h2>AD Equation Manager<a class="headerlink" href="#ad-equation-manager" title="Permalink to this heading">¶</a></h2>
<p>qwer</p>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <div>
    <h3><a href="../../home.html">Table of Contents</a></h3>
    <ul>
<li><a class="reference internal" href="#">Automatic Differentiation</a><ul>
<li><a class="reference internal" href="#elemental-ad-data-structures">Elemental AD data structures</a></li>
<li><a class="reference internal" href="#module-porepy.numerics.ad.functions">Common mathematical functions</a></li>
<li><a class="reference internal" href="#ad-representation-of-constant-scalars-vectors-and-matrices">AD-representation of constant scalars, vectors and matrices</a></li>
<li><a class="reference internal" href="#variables-on-single-and-mixed-dimensional-domains">Variables on single and mixed-dimensional domains</a></li>
<li><a class="reference internal" href="#operator-functions">Operator functions</a></li>
<li><a class="reference internal" href="#grid-operators">Grid operators</a></li>
<li><a class="reference internal" href="#numerical-discretization-schemes">Numerical discretization schemes</a></li>
<li><a class="reference internal" href="#ad-equation-manager">AD Equation Manager</a></li>
</ul>
</li>
</ul>

  </div>
  <div>
    <h4>Previous topic</h4>
    <p class="topless"><a href="numerics.html"
                          title="previous chapter">Numerics</a></p>
  </div>
  <div>
    <h4>Next topic</h4>
    <p class="topless"><a href="../howto/howto-docstring.html"
                          title="next chapter"><span class="section-number">1. </span>How-To docstring</a></p>
  </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="../howto/howto-docstring.html" title="1. How-To docstring"
             >next</a> |</li>
        <li class="right" >
          <a href="numerics.html" title="Numerics"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../home.html">PorePy</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="numerics.html" >Numerics</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Automatic Differentiation</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2022 UiB Center for Modeling of Coupled Subsurface Dynamics, GNU LESSER GENERAL PUBLIC LICENSE Version 3, 29 June 2007..
    </div>
  </body>
</html>