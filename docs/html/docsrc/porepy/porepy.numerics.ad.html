<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>porepy.numerics.ad package &mdash; PorePy 1.6.0 documentation</title>
      <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
    <link rel="canonical" href="https://pmgbergen.github.io/porepy/docsrc/porepy/porepy.numerics.ad.html" />
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/sphinx_highlight.js"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="porepy.numerics.ad.discretizations module" href="porepy.numerics.ad.discretizations.html" />
    <link rel="prev" title="porepy.numerics package" href="porepy.numerics.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: #2980B9" >
            <a href="../../index.html" class="icon icon-home"> PorePy
          </a>
              <div class="version">
                1.6.0
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="porepy.html">porepy package</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="porepy.fracs.html">porepy.fracs package</a><ul>
<li class="toctree-l3"><a class="reference internal" href="porepy.fracs.fracture.html">porepy.fracs.fracture module</a></li>
<li class="toctree-l3"><a class="reference internal" href="porepy.fracs.fracture_importer.html">porepy.fracs.fracture_importer module</a></li>
<li class="toctree-l3"><a class="reference internal" href="porepy.fracs.fracture_network_2d.html">porepy.fracs.fracture_network_2d module</a></li>
<li class="toctree-l3"><a class="reference internal" href="porepy.fracs.fracture_network_3d.html">porepy.fracs.fracture_network_3d module</a></li>
<li class="toctree-l3"><a class="reference internal" href="porepy.fracs.gmsh_interface.html">porepy.fracs.gmsh_interface module</a></li>
<li class="toctree-l3"><a class="reference internal" href="porepy.fracs.line_fracture.html">porepy.fracs.line_fracture module</a></li>
<li class="toctree-l3"><a class="reference internal" href="porepy.fracs.meshing.html">porepy.fracs.meshing module</a></li>
<li class="toctree-l3"><a class="reference internal" href="porepy.fracs.msh_2_grid.html">porepy.fracs.msh_2_grid module</a></li>
<li class="toctree-l3"><a class="reference internal" href="porepy.fracs.non_conforming.html">porepy.fracs.non_conforming module</a></li>
<li class="toctree-l3"><a class="reference internal" href="porepy.fracs.plane_fracture.html">porepy.fracs.plane_fracture module</a></li>
<li class="toctree-l3"><a class="reference internal" href="porepy.fracs.simplex.html">porepy.fracs.simplex module</a></li>
<li class="toctree-l3"><a class="reference internal" href="porepy.fracs.split_grid.html">porepy.fracs.split_grid module</a></li>
<li class="toctree-l3"><a class="reference internal" href="porepy.fracs.structured.html">porepy.fracs.structured module</a></li>
<li class="toctree-l3"><a class="reference internal" href="porepy.fracs.tools.html">porepy.fracs.tools module</a></li>
<li class="toctree-l3"><a class="reference internal" href="porepy.fracs.utils.html">porepy.fracs.utils module</a></li>
<li class="toctree-l3"><a class="reference internal" href="porepy.fracs.wells_3d.html">porepy.fracs.wells_3d module</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="porepy.geometry.html">porepy.geometry package</a><ul>
<li class="toctree-l3"><a class="reference internal" href="porepy.geometry.bounding_box.html">porepy.geometry.bounding_box module</a></li>
<li class="toctree-l3"><a class="reference internal" href="porepy.geometry.constrain_geometry.html">porepy.geometry.constrain_geometry module</a></li>
<li class="toctree-l3"><a class="reference internal" href="porepy.geometry.distances.html">porepy.geometry.distances module</a></li>
<li class="toctree-l3"><a class="reference internal" href="porepy.geometry.geometry_property_checks.html">porepy.geometry.geometry_property_checks module</a></li>
<li class="toctree-l3"><a class="reference internal" href="porepy.geometry.half_space.html">porepy.geometry.half_space module</a></li>
<li class="toctree-l3"><a class="reference internal" href="porepy.geometry.intersections.html">porepy.geometry.intersections module</a></li>
<li class="toctree-l3"><a class="reference internal" href="porepy.geometry.map_geometry.html">porepy.geometry.map_geometry module</a></li>
<li class="toctree-l3"><a class="reference internal" href="porepy.geometry.point_in_polyhedron_test.html">porepy.geometry.point_in_polyhedron_test module</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="porepy.grids.html">porepy.grids package</a><ul>
<li class="toctree-l3"><a class="reference internal" href="porepy.grids.standard_grids.html">porepy.grids.standard_grids package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="porepy.grids.standard_grids.md_grids_2d.html">porepy.grids.standard_grids.md_grids_2d module</a></li>
<li class="toctree-l4"><a class="reference internal" href="porepy.grids.standard_grids.md_grids_3d.html">porepy.grids.standard_grids.md_grids_3d module</a></li>
<li class="toctree-l4"><a class="reference internal" href="porepy.grids.standard_grids.utils.html">porepy.grids.standard_grids.utils module</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="porepy.grids.boundary_grid.html">porepy.grids.boundary_grid module</a></li>
<li class="toctree-l3"><a class="reference internal" href="porepy.grids.coarsening.html">porepy.grids.coarsening module</a></li>
<li class="toctree-l3"><a class="reference internal" href="porepy.grids.grid.html">porepy.grids.grid module</a></li>
<li class="toctree-l3"><a class="reference internal" href="porepy.grids.grid_extrusion.html">porepy.grids.grid_extrusion module</a></li>
<li class="toctree-l3"><a class="reference internal" href="porepy.grids.match_grids.html">porepy.grids.match_grids module</a></li>
<li class="toctree-l3"><a class="reference internal" href="porepy.grids.md_grid.html">porepy.grids.md_grid module</a></li>
<li class="toctree-l3"><a class="reference internal" href="porepy.grids.mortar_grid.html">porepy.grids.mortar_grid module</a></li>
<li class="toctree-l3"><a class="reference internal" href="porepy.grids.partition.html">porepy.grids.partition module</a></li>
<li class="toctree-l3"><a class="reference internal" href="porepy.grids.point_grid.html">porepy.grids.point_grid module</a></li>
<li class="toctree-l3"><a class="reference internal" href="porepy.grids.refinement.html">porepy.grids.refinement module</a></li>
<li class="toctree-l3"><a class="reference internal" href="porepy.grids.simplex.html">porepy.grids.simplex module</a></li>
<li class="toctree-l3"><a class="reference internal" href="porepy.grids.structured.html">porepy.grids.structured module</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="porepy.models.html">porepy.models package</a><ul>
<li class="toctree-l3"><a class="reference internal" href="porepy.models.verification_setups.html">porepy.models.verification_setups package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="porepy.models.verification_setups.manu_flow_comp_frac.html">porepy.models.verification_setups.manu_flow_comp_frac module</a></li>
<li class="toctree-l4"><a class="reference internal" href="porepy.models.verification_setups.manu_flow_incomp_frac.html">porepy.models.verification_setups.manu_flow_incomp_frac module</a></li>
<li class="toctree-l4"><a class="reference internal" href="porepy.models.verification_setups.manu_poromech_nofrac.html">porepy.models.verification_setups.manu_poromech_nofrac module</a></li>
<li class="toctree-l4"><a class="reference internal" href="porepy.models.verification_setups.verifications_utils.html">porepy.models.verification_setups.verifications_utils module</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="porepy.models.abstract_equations.html">porepy.models.abstract_equations module</a></li>
<li class="toctree-l3"><a class="reference internal" href="porepy.models.abstract_model.html">porepy.models.abstract_model module</a></li>
<li class="toctree-l3"><a class="reference internal" href="porepy.models.constitutive_laws.html">porepy.models.constitutive_laws module</a></li>
<li class="toctree-l3"><a class="reference internal" href="porepy.models.contact_mechanics_biot_model.html">porepy.models.contact_mechanics_biot_model module</a></li>
<li class="toctree-l3"><a class="reference internal" href="porepy.models.contact_mechanics_model.html">porepy.models.contact_mechanics_model module</a></li>
<li class="toctree-l3"><a class="reference internal" href="porepy.models.energy_balance.html">porepy.models.energy_balance module</a></li>
<li class="toctree-l3"><a class="reference internal" href="porepy.models.fluid_mass_balance.html">porepy.models.fluid_mass_balance module</a></li>
<li class="toctree-l3"><a class="reference internal" href="porepy.models.geometry.html">porepy.models.geometry module</a></li>
<li class="toctree-l3"><a class="reference internal" href="porepy.models.incompressible_flow_model.html">porepy.models.incompressible_flow_model module</a></li>
<li class="toctree-l3"><a class="reference internal" href="porepy.models.mass_and_energy_balance.html">porepy.models.mass_and_energy_balance module</a></li>
<li class="toctree-l3"><a class="reference internal" href="porepy.models.material_constants.html">porepy.models.material_constants module</a></li>
<li class="toctree-l3"><a class="reference internal" href="porepy.models.momentum_balance.html">porepy.models.momentum_balance module</a></li>
<li class="toctree-l3"><a class="reference internal" href="porepy.models.poromechanics.html">porepy.models.poromechanics module</a></li>
<li class="toctree-l3"><a class="reference internal" href="porepy.models.run_models.html">porepy.models.run_models module</a></li>
<li class="toctree-l3"><a class="reference internal" href="porepy.models.slightly_compressible_flow_model.html">porepy.models.slightly_compressible_flow_model module</a></li>
<li class="toctree-l3"><a class="reference internal" href="porepy.models.solution_strategy.html">porepy.models.solution_strategy module</a></li>
<li class="toctree-l3"><a class="reference internal" href="porepy.models.thermoporomechanics.html">porepy.models.thermoporomechanics module</a></li>
<li class="toctree-l3"><a class="reference internal" href="porepy.models.thm_model.html">porepy.models.thm_model module</a></li>
<li class="toctree-l3"><a class="reference internal" href="porepy.models.units.html">porepy.models.units module</a></li>
</ul>
</li>
<li class="toctree-l2 current"><a class="reference internal" href="porepy.numerics.html">porepy.numerics package</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="#">porepy.numerics.ad package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="porepy.numerics.ad.discretizations.html">porepy.numerics.ad.discretizations module</a></li>
<li class="toctree-l4"><a class="reference internal" href="porepy.numerics.ad.equation_manager.html">porepy.numerics.ad.equation_manager module</a></li>
<li class="toctree-l4"><a class="reference internal" href="porepy.numerics.ad.equation_system.html">porepy.numerics.ad.equation_system module</a></li>
<li class="toctree-l4"><a class="reference internal" href="porepy.numerics.ad.forward_mode.html">porepy.numerics.ad.forward_mode module</a></li>
<li class="toctree-l4"><a class="reference internal" href="porepy.numerics.ad.functions.html">porepy.numerics.ad.functions module</a></li>
<li class="toctree-l4"><a class="reference internal" href="porepy.numerics.ad.grid_operators.html">porepy.numerics.ad.grid_operators module</a></li>
<li class="toctree-l4"><a class="reference internal" href="porepy.numerics.ad.operator_functions.html">porepy.numerics.ad.operator_functions module</a></li>
<li class="toctree-l4"><a class="reference internal" href="porepy.numerics.ad.operators.html">porepy.numerics.ad.operators module</a></li>
<li class="toctree-l4"><a class="reference internal" href="porepy.numerics.ad.time_derivatives.html">porepy.numerics.ad.time_derivatives module</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="porepy.numerics.fem.html">porepy.numerics.fem package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="porepy.numerics.fem.rt0.html">porepy.numerics.fem.rt0 module</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="porepy.numerics.fracture_deformation.html">porepy.numerics.fracture_deformation package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="porepy.numerics.fracture_deformation.conforming_propagation.html">porepy.numerics.fracture_deformation.conforming_propagation module</a></li>
<li class="toctree-l4"><a class="reference internal" href="porepy.numerics.fracture_deformation.contact_conditions.html">porepy.numerics.fracture_deformation.contact_conditions module</a></li>
<li class="toctree-l4"><a class="reference internal" href="porepy.numerics.fracture_deformation.propagate_fracture.html">porepy.numerics.fracture_deformation.propagate_fracture module</a></li>
<li class="toctree-l4"><a class="reference internal" href="porepy.numerics.fracture_deformation.propagation_model.html">porepy.numerics.fracture_deformation.propagation_model module</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="porepy.numerics.fv.html">porepy.numerics.fv package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="porepy.numerics.fv.biot.html">porepy.numerics.fv.biot module</a></li>
<li class="toctree-l4"><a class="reference internal" href="porepy.numerics.fv.fv_elliptic.html">porepy.numerics.fv.fv_elliptic module</a></li>
<li class="toctree-l4"><a class="reference internal" href="porepy.numerics.fv.fvutils.html">porepy.numerics.fv.fvutils module</a></li>
<li class="toctree-l4"><a class="reference internal" href="porepy.numerics.fv.mass_matrix.html">porepy.numerics.fv.mass_matrix module</a></li>
<li class="toctree-l4"><a class="reference internal" href="porepy.numerics.fv.mpfa.html">porepy.numerics.fv.mpfa module</a></li>
<li class="toctree-l4"><a class="reference internal" href="porepy.numerics.fv.mpsa.html">porepy.numerics.fv.mpsa module</a></li>
<li class="toctree-l4"><a class="reference internal" href="porepy.numerics.fv.source.html">porepy.numerics.fv.source module</a></li>
<li class="toctree-l4"><a class="reference internal" href="porepy.numerics.fv.tpfa.html">porepy.numerics.fv.tpfa module</a></li>
<li class="toctree-l4"><a class="reference internal" href="porepy.numerics.fv.upwind.html">porepy.numerics.fv.upwind module</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="porepy.numerics.interface_laws.html">porepy.numerics.interface_laws package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="porepy.numerics.interface_laws.abstract_interface_law.html">porepy.numerics.interface_laws.abstract_interface_law module</a></li>
<li class="toctree-l4"><a class="reference internal" href="porepy.numerics.interface_laws.cell_dof_face_dof_map.html">porepy.numerics.interface_laws.cell_dof_face_dof_map module</a></li>
<li class="toctree-l4"><a class="reference internal" href="porepy.numerics.interface_laws.contact_mechanics_interface_laws.html">porepy.numerics.interface_laws.contact_mechanics_interface_laws module</a></li>
<li class="toctree-l4"><a class="reference internal" href="porepy.numerics.interface_laws.elliptic_discretization.html">porepy.numerics.interface_laws.elliptic_discretization module</a></li>
<li class="toctree-l4"><a class="reference internal" href="porepy.numerics.interface_laws.elliptic_interface_laws.html">porepy.numerics.interface_laws.elliptic_interface_laws module</a></li>
<li class="toctree-l4"><a class="reference internal" href="porepy.numerics.interface_laws.hyperbolic_interface_laws.html">porepy.numerics.interface_laws.hyperbolic_interface_laws module</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="porepy.numerics.linalg.html">porepy.numerics.linalg package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="porepy.numerics.linalg.matrix_operations.html">porepy.numerics.linalg.matrix_operations module</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="porepy.numerics.mixed_dim.html">porepy.numerics.mixed_dim package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="porepy.numerics.mixed_dim.assembler.html">porepy.numerics.mixed_dim.assembler module</a></li>
<li class="toctree-l4"><a class="reference internal" href="porepy.numerics.mixed_dim.assembler_filters.html">porepy.numerics.mixed_dim.assembler_filters module</a></li>
<li class="toctree-l4"><a class="reference internal" href="porepy.numerics.mixed_dim.dof_manager.html">porepy.numerics.mixed_dim.dof_manager module</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="porepy.numerics.nonlinear.html">porepy.numerics.nonlinear package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="porepy.numerics.nonlinear.nonlinear_solvers.html">porepy.numerics.nonlinear.nonlinear_solvers module</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="porepy.numerics.solvers.html">porepy.numerics.solvers package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="porepy.numerics.solvers.andersonacceleration.html">porepy.numerics.solvers.andersonacceleration module</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="porepy.numerics.vem.html">porepy.numerics.vem package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="porepy.numerics.vem.dual_elliptic.html">porepy.numerics.vem.dual_elliptic module</a></li>
<li class="toctree-l4"><a class="reference internal" href="porepy.numerics.vem.hybrid.html">porepy.numerics.vem.hybrid module</a></li>
<li class="toctree-l4"><a class="reference internal" href="porepy.numerics.vem.mass_matrix.html">porepy.numerics.vem.mass_matrix module</a></li>
<li class="toctree-l4"><a class="reference internal" href="porepy.numerics.vem.mvem.html">porepy.numerics.vem.mvem module</a></li>
<li class="toctree-l4"><a class="reference internal" href="porepy.numerics.vem.vem_source.html">porepy.numerics.vem.vem_source module</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="porepy.numerics.discretization.html">porepy.numerics.discretization module</a></li>
<li class="toctree-l3"><a class="reference internal" href="porepy.numerics.displacement_correlation.html">porepy.numerics.displacement_correlation module</a></li>
<li class="toctree-l3"><a class="reference internal" href="porepy.numerics.linear_solvers.html">porepy.numerics.linear_solvers module</a></li>
<li class="toctree-l3"><a class="reference internal" href="porepy.numerics.time_step_control.html">porepy.numerics.time_step_control module</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="porepy.params.html">porepy.params package</a><ul>
<li class="toctree-l3"><a class="reference internal" href="porepy.params.bc.html">porepy.params.bc module</a></li>
<li class="toctree-l3"><a class="reference internal" href="porepy.params.data.html">porepy.params.data module</a></li>
<li class="toctree-l3"><a class="reference internal" href="porepy.params.fluid.html">porepy.params.fluid module</a></li>
<li class="toctree-l3"><a class="reference internal" href="porepy.params.parameter_dictionaries.html">porepy.params.parameter_dictionaries module</a></li>
<li class="toctree-l3"><a class="reference internal" href="porepy.params.rock.html">porepy.params.rock module</a></li>
<li class="toctree-l3"><a class="reference internal" href="porepy.params.tensor.html">porepy.params.tensor module</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="porepy.utils.html">porepy.utils package</a><ul>
<li class="toctree-l3"><a class="reference internal" href="porepy.utils.derived_discretizations.html">porepy.utils.derived_discretizations package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="porepy.utils.derived_discretizations.implicit_euler.html">porepy.utils.derived_discretizations.implicit_euler module</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="porepy.utils.accumarray.html">porepy.utils.accumarray module</a></li>
<li class="toctree-l3"><a class="reference internal" href="porepy.utils.adtree.html">porepy.utils.adtree module</a></li>
<li class="toctree-l3"><a class="reference internal" href="porepy.utils.array_operations.html">porepy.utils.array_operations module</a></li>
<li class="toctree-l3"><a class="reference internal" href="porepy.utils.common_constants.html">porepy.utils.common_constants module</a></li>
<li class="toctree-l3"><a class="reference internal" href="porepy.utils.default_domains.html">porepy.utils.default_domains module</a></li>
<li class="toctree-l3"><a class="reference internal" href="porepy.utils.error.html">porepy.utils.error module</a></li>
<li class="toctree-l3"><a class="reference internal" href="porepy.utils.graph.html">porepy.utils.graph module</a></li>
<li class="toctree-l3"><a class="reference internal" href="porepy.utils.grid_utils.html">porepy.utils.grid_utils module</a></li>
<li class="toctree-l3"><a class="reference internal" href="porepy.utils.interpolation_tables.html">porepy.utils.interpolation_tables module</a></li>
<li class="toctree-l3"><a class="reference internal" href="porepy.utils.mcolon.html">porepy.utils.mcolon module</a></li>
<li class="toctree-l3"><a class="reference internal" href="porepy.utils.permutations.html">porepy.utils.permutations module</a></li>
<li class="toctree-l3"><a class="reference internal" href="porepy.utils.porepy_types.html">porepy.utils.porepy_types module</a></li>
<li class="toctree-l3"><a class="reference internal" href="porepy.utils.setmembership.html">porepy.utils.setmembership module</a></li>
<li class="toctree-l3"><a class="reference internal" href="porepy.utils.sort_points.html">porepy.utils.sort_points module</a></li>
<li class="toctree-l3"><a class="reference internal" href="porepy.utils.tags.html">porepy.utils.tags module</a></li>
<li class="toctree-l3"><a class="reference internal" href="porepy.utils.tangential_normal_projection.html">porepy.utils.tangential_normal_projection module</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="porepy.viz.html">porepy.viz package</a><ul>
<li class="toctree-l3"><a class="reference internal" href="porepy.viz.data_saving_model_mixin.html">porepy.viz.data_saving_model_mixin module</a></li>
<li class="toctree-l3"><a class="reference internal" href="porepy.viz.exporter.html">porepy.viz.exporter module</a></li>
<li class="toctree-l3"><a class="reference internal" href="porepy.viz.fracture_visualization.html">porepy.viz.fracture_visualization module</a></li>
<li class="toctree-l3"><a class="reference internal" href="porepy.viz.plot_grid.html">porepy.viz.plot_grid module</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../howto/howto-docstring.html">1. How to docstring</a></li>
<li class="toctree-l1"><a class="reference internal" href="../howto/howto-build-docs.html">2. How to build documentation</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu"  style="background: #2980B9" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">PorePy</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content style-external-links">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home"></a></li>
          <li class="breadcrumb-item"><a href="porepy.html">porepy package</a></li>
          <li class="breadcrumb-item"><a href="porepy.numerics.html">porepy.numerics package</a></li>
      <li class="breadcrumb-item active">porepy.numerics.ad package</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="module-porepy.numerics.ad">
<span id="porepy-numerics-ad-package"></span><h1>porepy.numerics.ad package<a class="headerlink" href="#module-porepy.numerics.ad" title="Permalink to this heading"></a></h1>
<p>Init file for all AD functionality.</p>
<dl>
<dt>They should all be accessible through a calling</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span>&gt;&gt;&gt; import porepy as pp
&gt;&gt;&gt; pp.ad.Matrix???
</pre></div>
</div>
</dd>
</dl>
<p>etc.</p>
<dl class="py class">
<dt class="sig sig-object py" id="porepy.numerics.ad.ADmethod">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ADmethod</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">func</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ad_function_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">Function</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">operator_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/porepy/numerics/ad/operator_functions.html#ADmethod"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#porepy.numerics.ad.ADmethod" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>(Decorator) Class for methods representing e.g., physical properties.
The decorated function is expected to take scalars/vectors and return a scalar/vector.</p>
<p>The return value will be an AD operator of a type passed to the decorator.</p>
<div class="admonition-examples admonition">
<p class="admonition-title">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">porepy</span> <span class="k">as</span> <span class="nn">pp</span>

<span class="c1"># decorating class methods</span>
<span class="k">class</span> <span class="nc">IdealGas</span><span class="p">:</span>

    <span class="nd">@ADmethod</span><span class="p">(</span><span class="n">ad_operator</span><span class="o">=</span><span class="n">pp</span><span class="o">.</span><span class="n">ad</span><span class="o">.</span><span class="n">DiagonalJacobianFunction</span><span class="p">,</span>
            <span class="n">operators_args</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;multipliers&quot;</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]})</span>
    <span class="k">def</span> <span class="nf">density</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">p</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">T</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">p</span><span class="o">/</span><span class="n">T</span>

<span class="c1"># decorating function</span>
<span class="nd">@ADmethod</span><span class="p">(</span><span class="n">ad_operator</span><span class="o">=</span><span class="n">pp</span><span class="o">.</span><span class="n">ad</span><span class="o">.</span><span class="n">Function</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">dummy_rel_perm</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">s</span><span class="o">**</span><span class="mi">2</span>
</pre></div>
</div>
<p>With above code, the density of an instance of <code class="docutils literal notranslate"><span class="pre">IdealGas</span></code> can be called using
<code class="xref py py-class docutils literal notranslate"><span class="pre">MergedVariable</span></code> representing
pressure and temperature.
Analogously, <code class="docutils literal notranslate"><span class="pre">dummy_rel_perm</span></code> can be called with one representing the saturation.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If used as decorator WITHOUT explicit instantiation, the instantiation will be
done implicitly with above default arguments (that’s how Python decorators work).</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>func</strong> (<em>Optional</em><em>[</em><em>Callable</em><em>]</em>) – decorated function object</p></li>
<li><p><strong>ad_function_type</strong> (<em>Type</em><em>[</em><em>AbstractFunction</em><em>]</em>) – type reference to an AD operator function to be instantiated.
When instantiated, that instance will effectively replace <code class="docutils literal notranslate"><span class="pre">func</span></code>.</p></li>
<li><p><strong>operator_kwargs</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.11)"><em>dict</em></a>) – keyword arguments to be passed when instantiating an operator
of type <code class="docutils literal notranslate"><span class="pre">ad_function_type</span></code>.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="porepy.numerics.ad.ADmethod.ad_wrapper">
<span class="sig-name descname"><span class="pre">ad_wrapper</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/porepy/numerics/ad/operator_functions.html#ADmethod.ad_wrapper"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#porepy.numerics.ad.ADmethod.ad_wrapper" title="Permalink to this definition"></a></dt>
<dd><p>Actual wrapper function.
Constructs the necessary AD-Operator class wrapping the decorated callable
and performs the evaluation/call.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>*args</strong> – arguments for the call to the wrapping AD operator function</p></li>
<li><p><strong>**kwargs</strong> – keyword argument for the call to the wrapping Ad operator function</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference internal" href="porepy.numerics.ad.operators.html#porepy.numerics.ad.operators.Operator" title="porepy.numerics.ad.operators.Operator"><em>Operator</em></a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="porepy.numerics.ad.Ad_array">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Ad_array</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">jac</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/porepy/numerics/ad/forward_mode.html#Ad_array"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#porepy.numerics.ad.Ad_array" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="porepy.numerics.ad.Ad_array.copy">
<span class="sig-name descname"><span class="pre">copy</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/porepy/numerics/ad/forward_mode.html#Ad_array.copy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#porepy.numerics.ad.Ad_array.copy" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="porepy.numerics.ad.Ad_array.diagvec_mul_jac">
<span class="sig-name descname"><span class="pre">diagvec_mul_jac</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/porepy/numerics/ad/forward_mode.html#Ad_array.diagvec_mul_jac"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#porepy.numerics.ad.Ad_array.diagvec_mul_jac" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="porepy.numerics.ad.Ad_array.full_jac">
<span class="sig-name descname"><span class="pre">full_jac</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/porepy/numerics/ad/forward_mode.html#Ad_array.full_jac"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#porepy.numerics.ad.Ad_array.full_jac" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="porepy.numerics.ad.Ad_array.jac_mul_diagvec">
<span class="sig-name descname"><span class="pre">jac_mul_diagvec</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/porepy/numerics/ad/forward_mode.html#Ad_array.jac_mul_diagvec"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#porepy.numerics.ad.Ad_array.jac_mul_diagvec" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="porepy.numerics.ad.Array">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Array</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">values</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/porepy/numerics/ad/operators.html#Array"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#porepy.numerics.ad.Array" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="porepy.numerics.ad.operators.html#porepy.numerics.ad.operators.Operator" title="porepy.numerics.ad.operators.Operator"><code class="xref py py-class docutils literal notranslate"><span class="pre">Operator</span></code></a></p>
<p>AD representation of a constant numpy array.</p>
<p>For sparse matrices, use <a class="reference internal" href="#porepy.numerics.ad.Matrix" title="porepy.numerics.ad.Matrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">Matrix</span></code></a> instead.
For time-dependent arrays see <a class="reference internal" href="#porepy.numerics.ad.TimeDependentArray" title="porepy.numerics.ad.TimeDependentArray"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeDependentArray</span></code></a>.</p>
<p>This is a shallow wrapper around the real array; it is needed to combine the array
with other types of AD operators.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>values</strong> (<em>np.ndarray</em>) – Numpy array to be represented.</p></li>
<li><p><strong>name</strong> (<em>Optional</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><em>str</em></a><em>]</em>) – </p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="porepy.numerics.ad.Array.parse">
<span class="sig-name descname"><span class="pre">parse</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mdg</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/porepy/numerics/ad/operators.html#Array.parse"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#porepy.numerics.ad.Array.parse" title="Permalink to this definition"></a></dt>
<dd><p>See <a class="reference internal" href="#porepy.numerics.ad.Operator.parse" title="porepy.numerics.ad.Operator.parse"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Operator.parse()</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The wrapped array.</p>
</dd>
<dt class="field-even">Parameters</dt>
<dd class="field-even"><p><strong>mdg</strong> (<a class="reference internal" href="porepy.grids.md_grid.html#porepy.grids.md_grid.MixedDimensionalGrid" title="porepy.grids.md_grid.MixedDimensionalGrid"><em>MixedDimensionalGrid</em></a>) – </p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.24)"><em>ndarray</em></a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="porepy.numerics.ad.BiotAd">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">BiotAd</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">keyword</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subdomains</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flow_keyword</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'flow'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/porepy/numerics/ad/discretizations.html#BiotAd"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#porepy.numerics.ad.BiotAd" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="porepy.numerics.ad.discretizations.html#porepy.numerics.ad.discretizations.Discretization" title="porepy.numerics.ad.discretizations.Discretization"><code class="xref py py-class docutils literal notranslate"><span class="pre">Discretization</span></code></a></p>
<p>Ad wrapper around the Biot discretization class.</p>
<p>For description of the method, we refer to the standard Biot class.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>keyword</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><em>str</em></a>) – </p></li>
<li><p><strong>subdomains</strong> (<em>List</em><em>[</em><em>pp.Grid</em><em>]</em>) – </p></li>
<li><p><strong>flow_keyword</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><em>str</em></a>) – </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="porepy.numerics.ad.BiotStabilizationAd">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">BiotStabilizationAd</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">keyword</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subdomains</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/porepy/numerics/ad/discretizations.html#BiotStabilizationAd"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#porepy.numerics.ad.BiotStabilizationAd" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="porepy.numerics.ad.discretizations.html#porepy.numerics.ad.discretizations.Discretization" title="porepy.numerics.ad.discretizations.Discretization"><code class="xref py py-class docutils literal notranslate"><span class="pre">Discretization</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>keyword</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><em>str</em></a>) – </p></li>
<li><p><strong>subdomains</strong> (<em>List</em><em>[</em><em>pp.Grid</em><em>]</em>) – </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="porepy.numerics.ad.BoundaryCondition">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">BoundaryCondition</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">keyword</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subdomains</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/porepy/numerics/ad/grid_operators.html#BoundaryCondition"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#porepy.numerics.ad.BoundaryCondition" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="porepy.numerics.ad.operators.html#porepy.numerics.ad.operators.Operator" title="porepy.numerics.ad.operators.Operator"><code class="xref py py-class docutils literal notranslate"><span class="pre">Operator</span></code></a></p>
<p>Wrapper class for Ad representations of boundary conditions for a given keyword.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>keyword</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><em>str</em></a>) – </p></li>
<li><p><strong>subdomains</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.11)"><em>list</em></a><em>[</em><em>pp.Grid</em><em>]</em>) – </p></li>
<li><p><strong>name</strong> (<em>Optional</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><em>str</em></a><em>]</em>) – </p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="porepy.numerics.ad.BoundaryCondition.parse">
<span class="sig-name descname"><span class="pre">parse</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mdg</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/porepy/numerics/ad/grid_operators.html#BoundaryCondition.parse"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#porepy.numerics.ad.BoundaryCondition.parse" title="Permalink to this definition"></a></dt>
<dd><p>Convert the Ad expression into numerical values for the boundary conditions,
in the form of an np.ndarray concatenated for all subdomains.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>mdg</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">pp.MixedDimensionalGrid</span></code>) – Mixed-dimensional grid. The boundary condition
will be taken from the data dictionaries with the relevant keyword.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Value of boundary conditions.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="porepy.numerics.ad.ColoumbContactAd">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ColoumbContactAd</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">keyword</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interfaces</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/porepy/numerics/ad/discretizations.html#ColoumbContactAd"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#porepy.numerics.ad.ColoumbContactAd" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="porepy.numerics.ad.discretizations.html#porepy.numerics.ad.discretizations.Discretization" title="porepy.numerics.ad.discretizations.Discretization"><code class="xref py py-class docutils literal notranslate"><span class="pre">Discretization</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>keyword</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><em>str</em></a>) – </p></li>
<li><p><strong>interfaces</strong> (<em>List</em><em>[</em><em>pp.MortarGrid</em><em>]</em>) – </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="porepy.numerics.ad.ConstantFunction">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ConstantFunction</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">values</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/porepy/numerics/ad/operator_functions.html#ConstantFunction"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#porepy.numerics.ad.ConstantFunction" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">AbstractFunction</span></code></p>
<p>Function representing constant, scalar values with no dependencies and ergo a
zero Jacobian.</p>
<p>It still has to be called though since it fulfills the notion of a ‘function’.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>values</strong> (<em>np.ndarray</em>) – constant values per cell.</p></li>
<li><p><strong>name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><em>str</em></a>) – </p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="porepy.numerics.ad.ConstantFunction.get_jacobian">
<span class="sig-name descname"><span class="pre">get_jacobian</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/porepy/numerics/ad/operator_functions.html#ConstantFunction.get_jacobian"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#porepy.numerics.ad.ConstantFunction.get_jacobian" title="Permalink to this definition"></a></dt>
<dd><div class="admonition note">
<p class="admonition-title">Note</p>
<p>The return value is not a sparse matrix as imposed by the parent method signature,
but a zero.
Numerical operations with a zero always works with any numeric formats in
numpy, scipy and PorePy’s AD framework.
Since the constant function (most likely) gets no arguments passed, we have
no way of knowing the necessary shape for a zero matrix. Hence scalar.</p>
</div>
<p>Returns: the trivial derivative of a constant.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>args</strong> (<a class="reference internal" href="porepy.numerics.ad.forward_mode.html#porepy.numerics.ad.forward_mode.Ad_array" title="porepy.numerics.ad.forward_mode.Ad_array"><em>Ad_array</em></a>) – </p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.sparse.spmatrix.html#scipy.sparse.spmatrix" title="(in SciPy v1.10.0)"><em>spmatrix</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="porepy.numerics.ad.ConstantFunction.get_values">
<span class="sig-name descname"><span class="pre">get_values</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/porepy/numerics/ad/operator_functions.html#ConstantFunction.get_values"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#porepy.numerics.ad.ConstantFunction.get_values" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The values passed at instantiation.</p>
</dd>
<dt class="field-even">Parameters</dt>
<dd class="field-even"><p><strong>args</strong> (<a class="reference internal" href="porepy.numerics.ad.forward_mode.html#porepy.numerics.ad.forward_mode.Ad_array" title="porepy.numerics.ad.forward_mode.Ad_array"><em>Ad_array</em></a>) – </p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.24)"><em>ndarray</em></a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="porepy.numerics.ad.ContactTractionAd">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ContactTractionAd</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">keyword</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interfaces</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">low_dim_subdomains</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/porepy/numerics/ad/discretizations.html#ContactTractionAd"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#porepy.numerics.ad.ContactTractionAd" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="porepy.numerics.ad.discretizations.html#porepy.numerics.ad.discretizations.Discretization" title="porepy.numerics.ad.discretizations.Discretization"><code class="xref py py-class docutils literal notranslate"><span class="pre">Discretization</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>keyword</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><em>str</em></a>) – </p></li>
<li><p><strong>interfaces</strong> (<em>List</em><em>[</em><em>pp.MortarGrid</em><em>]</em>) – </p></li>
<li><p><strong>low_dim_subdomains</strong> (<em>List</em><em>[</em><em>pp.Grid</em><em>]</em>) – </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="porepy.numerics.ad.DiagonalJacobianFunction">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">DiagonalJacobianFunction</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">func</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">multipliers</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">array_compatible</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/porepy/numerics/ad/operator_functions.html#DiagonalJacobianFunction"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#porepy.numerics.ad.DiagonalJacobianFunction" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">AbstractJacobianFunction</span></code></p>
<p>Approximates the Jacobian of the function using identities and scalar multipliers
per dependency.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>multipliers</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><em>float</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.11)"><em>list</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><em>float</em></a><em>]</em>) – scalar multipliers for the identity blocks in the Jacobian,
per dependency of <code class="docutils literal notranslate"><span class="pre">func</span></code>. The order in <code class="docutils literal notranslate"><span class="pre">multipliers</span></code> is expected to match
the order of AD operators passed to the call of this function.</p></li>
<li><p><strong>func</strong> (<em>Callable</em>) – </p></li>
<li><p><strong>name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><em>str</em></a>) – </p></li>
<li><p><strong>array_compatible</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><em>bool</em></a>) – </p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="porepy.numerics.ad.DiagonalJacobianFunction.get_jacobian">
<span class="sig-name descname"><span class="pre">get_jacobian</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/porepy/numerics/ad/operator_functions.html#DiagonalJacobianFunction.get_jacobian"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#porepy.numerics.ad.DiagonalJacobianFunction.get_jacobian" title="Permalink to this definition"></a></dt>
<dd><p>The approximate Jacobian consists of identity blocks times scalar multiplier
per every function dependency.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>args</strong> (<a class="reference internal" href="porepy.numerics.ad.forward_mode.html#porepy.numerics.ad.forward_mode.Ad_array" title="porepy.numerics.ad.forward_mode.Ad_array"><em>Ad_array</em></a>) – </p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.sparse.spmatrix.html#scipy.sparse.spmatrix" title="(in SciPy v1.10.0)"><em>spmatrix</em></a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="porepy.numerics.ad.DifferentiableFVAd">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">DifferentiableFVAd</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">subdomains</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mdg</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">base_discr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">system_manager</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">permeability_function</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">permeability_argument</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">potential</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keyword</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/porepy/numerics/ad/discretizations.html#DifferentiableFVAd"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#porepy.numerics.ad.DifferentiableFVAd" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>This class represents the application of the product and chain rule of the
flux expression</p>
<blockquote>
<div><p>q = T(k(u)) * p</p>
</div></blockquote>
<p>Where the transmissibility matrix T is a function of the cell permeability k, which
again is a function of a primary variable u, while p is the potential (pressure).
The chain rule applied to this expression reads</p>
<blockquote>
<div><p>dq = p * dT/dk * dk/du * du + T * dp</p>
</div></blockquote>
<p>The transmissibility matrix can be computed from a Tpfa or Mpfa discretization, or
(in principle) any other finite volume method. The derivative of the
transmissibilities, dT/dk, is approximated with a two-point flux stencil.</p>
<p>If vector sources are included, p should be replaced by (p - dist * vector_source),
with dist the distance roughly corresponding to the inverse of the gradient.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>subdomains</strong> (<em>List</em><em>[</em><em>pp.Grid</em><em>]</em>) – </p></li>
<li><p><strong>mdg</strong> (<em>pp.MixedDimensionalGrid</em>) – </p></li>
<li><p><strong>base_discr</strong> (<em>Union</em><em>[</em><em>pp.ad.MpfaAd</em><em>, </em><em>pp.ad.TpfaAd</em><em>]</em>) – </p></li>
<li><p><strong>system_manager</strong> (<em>pp.ad.EquationSystem</em>) – </p></li>
<li><p><strong>permeability_function</strong> (<em>Callable</em><em>[</em><em>[</em><em>pp.ad.Variable</em><em>]</em><em>, </em><em>pp.ad.Ad_array</em><em>]</em>) – </p></li>
<li><p><strong>permeability_argument</strong> (<em>pp.ad.Variable</em>) – </p></li>
<li><p><strong>potential</strong> (<em>pp.ad.Variable</em>) – </p></li>
<li><p><strong>keyword</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><em>str</em></a>) – </p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="porepy.numerics.ad.DifferentiableFVAd.bound_pressure_face">
<span class="sig-name descname"><span class="pre">bound_pressure_face</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/porepy/numerics/ad/discretizations.html#DifferentiableFVAd.bound_pressure_face"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#porepy.numerics.ad.DifferentiableFVAd.bound_pressure_face" title="Permalink to this definition"></a></dt>
<dd><p>Boundary face contribution to pressure reconstruction.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><dl class="simple">
<dt>pp.ad.Operator representing the value and jacobian of bound_pressure_face,</dt><dd><p>which is used to reconstruct the pressure trace on the boundary (see FV
discretizations).</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference internal" href="porepy.numerics.ad.operators.html#porepy.numerics.ad.operators.Operator" title="porepy.numerics.ad.operators.Operator"><em>Operator</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="porepy.numerics.ad.DifferentiableFVAd.flux">
<span class="sig-name descname"><span class="pre">flux</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/porepy/numerics/ad/discretizations.html#DifferentiableFVAd.flux"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#porepy.numerics.ad.DifferentiableFVAd.flux" title="Permalink to this definition"></a></dt>
<dd><p>Flux from potential, BCs and vector sources.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>pp.ad.Operator representing the flux.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference internal" href="porepy.numerics.ad.operators.html#porepy.numerics.ad.operators.Operator" title="porepy.numerics.ad.operators.Operator"><em>Operator</em></a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="porepy.numerics.ad.Discretization">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Discretization</span></span><a class="reference internal" href="../../_modules/porepy/numerics/ad/discretizations.html#Discretization"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#porepy.numerics.ad.Discretization" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/abc.html#abc.ABC" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ABC</span></code></a></p>
<p>General/utility methods for AD discretization classes.</p>
<p>The init of the children classes below typically calls wrap_discretization
and has arguments including subdomains or interfaces and keywords for parameter and
possibly matrix storage.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="porepy.numerics.ad.DivUAd">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">DivUAd</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">keyword</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subdomains</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mat_dict_keyword</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/porepy/numerics/ad/discretizations.html#DivUAd"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#porepy.numerics.ad.DivUAd" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="porepy.numerics.ad.discretizations.html#porepy.numerics.ad.discretizations.Discretization" title="porepy.numerics.ad.discretizations.Discretization"><code class="xref py py-class docutils literal notranslate"><span class="pre">Discretization</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>keyword</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><em>str</em></a>) – </p></li>
<li><p><strong>subdomains</strong> (<em>List</em><em>[</em><em>pp.Grid</em><em>]</em>) – </p></li>
<li><p><strong>mat_dict_keyword</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><em>str</em></a>) – </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="porepy.numerics.ad.Divergence">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Divergence</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">subdomains</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/porepy/numerics/ad/grid_operators.html#Divergence"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#porepy.numerics.ad.Divergence" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="porepy.numerics.ad.operators.html#porepy.numerics.ad.operators.Operator" title="porepy.numerics.ad.operators.Operator"><code class="xref py py-class docutils literal notranslate"><span class="pre">Operator</span></code></a></p>
<p>Wrapper class for Ad representations of divergence operators.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>subdomains</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.11)"><em>list</em></a><em>[</em><em>pp.Grid</em><em>]</em>) – </p></li>
<li><p><strong>dim</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a>) – </p></li>
<li><p><strong>name</strong> (<em>Optional</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><em>str</em></a><em>]</em>) – </p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="porepy.numerics.ad.Divergence.parse">
<span class="sig-name descname"><span class="pre">parse</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mdg</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/porepy/numerics/ad/grid_operators.html#Divergence.parse"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#porepy.numerics.ad.Divergence.parse" title="Permalink to this definition"></a></dt>
<dd><p>Convert the Ad expression into a divergence operators on all relevant subdomains,
represented as a sparse block matrix.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>mdg</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">pp.MixedDimensionalGrid</span></code>) – Not used, but needed for compatibility with
the general parsing method for Operators.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><dl class="simple">
<dt>Block matrix representation of a divergence operator on</dt><dd><p>multiple subdomains.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>sps.spmatrix</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="porepy.numerics.ad.EquationManager">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">EquationManager</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mdg</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dof_manager</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">equations</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">secondary_variables</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/porepy/numerics/ad/equation_manager.html#EquationManager"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#porepy.numerics.ad.EquationManager" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Representation of a set of equations specified on Ad form.</p>
<p>The equations are tied to a specific MixedDimensionalGrid, with variables fixed in a
corresponding DofManager.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mdg</strong> (<em>pp.MixedDimensionalGrid</em>) – </p></li>
<li><p><strong>dof_manager</strong> (<em>pp.DofManager</em>) – </p></li>
<li><p><strong>equations</strong> (<em>Optional</em><em>[</em><em>Dict</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><em>str</em></a><em>, </em><em>'pp.ad.Operator'</em><em>]</em><em>]</em>) – </p></li>
<li><p><strong>secondary_variables</strong> (<em>Optional</em><em>[</em><em>Sequence</em><em>[</em><em>'pp.ad.Variable'</em><em>]</em><em>]</em>) – </p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="porepy.numerics.ad.EquationManager.mdg">
<span class="sig-name descname"><span class="pre">mdg</span></span><a class="headerlink" href="#porepy.numerics.ad.EquationManager.mdg" title="Permalink to this definition"></a></dt>
<dd><p>Mixed-dimensional grid on which this EquationManager
operates.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">pp.MixedDimensionalGrid</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="porepy.numerics.ad.EquationManager.dof_manager">
<span class="sig-name descname"><span class="pre">dof_manager</span></span><a class="headerlink" href="#porepy.numerics.ad.EquationManager.dof_manager" title="Permalink to this definition"></a></dt>
<dd><p>Degree of freedom manager used for this
EquationManager.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">pp.DofManager</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="porepy.numerics.ad.EquationManager.equations">
<span class="sig-name descname"><span class="pre">equations</span></span><a class="headerlink" href="#porepy.numerics.ad.EquationManager.equations" title="Permalink to this definition"></a></dt>
<dd><p>Equations assigned to this EquationManager.
can be expanded by direct addition to the list.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">List</span> <span class="pre">of</span> <span class="pre">Ad</span> <span class="pre">Operators</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="porepy.numerics.ad.EquationManager.variables">
<span class="sig-name descname"><span class="pre">variables</span></span><a class="headerlink" href="#porepy.numerics.ad.EquationManager.variables" title="Permalink to this definition"></a></dt>
<dd><p>Mapping from subdomains or grid tuples (interfaces) to Ad
variables. These are set at initialization from the MixedDimensionalGrid, and
should not be changed later.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="porepy.numerics.ad.EquationManager.secondary_variables">
<span class="sig-name descname"><span class="pre">secondary_variables</span></span><a class="headerlink" href="#porepy.numerics.ad.EquationManager.secondary_variables" title="Permalink to this definition"></a></dt>
<dd><p>List of variables that are secondary,
that is, their derivatives will not be included in the Jacobian matrix.
Variables will be represented on atomic form, that is, mixed-dimensional variables
are unravelled. Secondary variables act as a filter during assembly, that is,
they do not impact the ordering or treatment of variables.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">List</span> <span class="pre">of</span> <span class="pre">Ad</span> <span class="pre">Variables</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="porepy.numerics.ad.EquationManager.row_block_indices_last_assembled">
<span class="sig-name descname"><span class="pre">row_block_indices_last_assembled</span></span><a class="headerlink" href="#porepy.numerics.ad.EquationManager.row_block_indices_last_assembled" title="Permalink to this definition"></a></dt>
<dd><p>Row indices for the start of blocks
corresponding to different equations in the last assembled system. The last item
in the array is the total number of rows, so that row indices for block i can
be recovered by np.arange(row_bl..[i], row_bl..[i+1]). The user must relate the
indices to equations (either in self.equations or the equation list given to the
relevant assembly method). This information is intended for diagnostic usage.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">np.ndarray</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="porepy.numerics.ad.EquationManager.assemble">
<span class="sig-name descname"><span class="pre">assemble</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/porepy/numerics/ad/equation_manager.html#EquationManager.assemble"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#porepy.numerics.ad.EquationManager.assemble" title="Permalink to this definition"></a></dt>
<dd><p>Assemble Jacobian matrix and residual vector with respect to the current
state represented in self.mdg.</p>
<p>Derivatives for secondary variables are not included in the Jacobian matrix.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>state</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">np.ndarray,</span> <span class="pre">optional</span></code>) – State vector to assemble from. If not provided,
the default behavior of pp.ad.Expression.to_ad() will be followed.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><dl class="simple">
<dt>Jacobian matrix corresponding to the current variable state,</dt><dd><p>as found in self.mdg. The ordering of the equations is determined by
the ordering in self.equations (for rows) and self.dof_manager (for
columns).</p>
</dd>
<dt>np.ndarray: Residual vector corresponding to the current variable state,</dt><dd><p>as found in self.mdg. Scaled with -1 (moved to rhs).</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>sps.spmatrix</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="porepy.numerics.ad.EquationManager.assemble_schur_complement_system">
<span class="sig-name descname"><span class="pre">assemble_schur_complement_system</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">primary_equations</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">primary_variables</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inverter</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/porepy/numerics/ad/equation_manager.html#EquationManager.assemble_schur_complement_system"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#porepy.numerics.ad.EquationManager.assemble_schur_complement_system" title="Permalink to this definition"></a></dt>
<dd><p>Assemble Jacobian matrix and residual vector using a Schur complement
elimination of the variables and equations not to be included.</p>
<p>The specified equations and variables will define a reordering of the linearized
system into</p>
<blockquote>
<div><dl class="simple">
<dt>[A_pp, A_ps  [x_p   = [b_p</dt><dd><p>A_sp, A_ss]  x_s]     b_s]</p>
</dd>
</dl>
</div></blockquote>
<p>Where subscripts p and s define primary and secondary quantities. The Schur
complement system is then given by</p>
<blockquote>
<div><p>(A_pp - A_ps * inv(A_ss) * A_sp) * x_p = b_p - A_ps * inv(A_pp) * b_s.</p>
</div></blockquote>
<p>The Schur complement is well-defined only if the inverse of A_ss exists,
and the efficiency of the approach assumes that an efficient inverter for
A_ss can be found. The user must ensure both requirements are fulfilled.
The simplest option is a lambda function on the form:</p>
<blockquote>
<div><p>inverter = lambda A: sps.csr_matrix(np.linalg.inv(A.A))</p>
</div></blockquote>
<p>but depending on A (size and sparsity pattern), this can be costly in terms of
computational time and memory.</p>
<p>The method can be used e.g. for splitting between primary and secondary variables,
where the latter can be efficiently eliminated (for instance, they contain no
spatial derivatives).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>primary_equations</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span> <span class="pre">of</span> <span class="pre">str</span></code>) – Equations to be assembled, specified
as keys in self.equations. Should have length &gt; 0.</p></li>
<li><p><strong>primary_variables</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span> <span class="pre">of</span> <span class="pre">Variables</span></code>) – Variables to be assembled. Should have
length &gt; 0.</p></li>
<li><p><strong>inverter</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Callable</span></code>) – Method to compute the inverse of the matrix A_ss.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><dl class="simple">
<dt>Jacobian matrix corresponding to the current variable state,</dt><dd><p>as found in self.mdg, for the specified equations and variables.</p>
</dd>
<dt>np.ndarray: Residual vector corresponding to the current variable state,</dt><dd><p>as found in self.mdg, for the specified equations and variables.
Scaled with -1 (moved to rhs).</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>sps.spmatrix</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="porepy.numerics.ad.EquationManager.assemble_subsystem">
<span class="sig-name descname"><span class="pre">assemble_subsystem</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eq_names</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">variables</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/porepy/numerics/ad/equation_manager.html#EquationManager.assemble_subsystem"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#porepy.numerics.ad.EquationManager.assemble_subsystem" title="Permalink to this definition"></a></dt>
<dd><p>Assemble Jacobian matrix and residual vector using a specified subset of
equations and variables.</p>
<p>The method is intended for use in splitting algorithms. Matrix blocks not
included will simply be ignored.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>eq_names</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span> <span class="pre">of</span> <span class="pre">str,</span> <span class="pre">optional</span></code>) – Equations to be assembled, specified
as keys in self.equations. If not provided (None), all equations known to
this EquationManager will be included.</p></li>
<li><p><strong>variables</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span> <span class="pre">of</span> <span class="pre">Variables,</span> <span class="pre">optional</span></code>) – Variables to be assembled.
If not provided (None), all variables known to this EquationManager will be
included. If a secondary variable is specified, this will be included in
the returned system.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><dl class="simple">
<dt>Jacobian matrix corresponding to the current variable state,</dt><dd><p>as found in self.mdg, for the specified equations and variables.</p>
</dd>
<dt>np.ndarray: Residual vector corresponding to the current variable state,</dt><dd><p>as found in self.mdg, for the specified equations and variables.
Scaled with -1 (moved to rhs).</p>
</dd>
<dt>NOTE: The ordering of columns in the system are defined by the order of the</dt><dd><p>variables specified in DofManager. For the rows, no corresponding global
ordering of equations exists, and the rows will therefore be organized
by the ordering in the parameter eq_names.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>sps.spmatrix</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="porepy.numerics.ad.EquationManager.discretize">
<span class="sig-name descname"><span class="pre">discretize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mdg</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/porepy/numerics/ad/equation_manager.html#EquationManager.discretize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#porepy.numerics.ad.EquationManager.discretize" title="Permalink to this definition"></a></dt>
<dd><p>Loop over all discretizations in self.equations, find all unique discretizations
and discretize.</p>
<p>This is more efficient than discretizing on the Operator level, since
discretizations which occur more than once in a set of equations will be
identified and only discretized once.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>mdg</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">pp.MixedDimensionalGrid</span></code>) – Mixed-dimensional grid from which parameters etc.
will be taken and where discretization matrices will be stored.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="porepy.numerics.ad.EquationManager.merge_variables">
<span class="sig-name descname"><span class="pre">merge_variables</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">grid_var</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/porepy/numerics/ad/equation_manager.html#EquationManager.merge_variables"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#porepy.numerics.ad.EquationManager.merge_variables" title="Permalink to this definition"></a></dt>
<dd><p>Concatenate a variable defined over several subdomains or interfaces.</p>
<p>The mixed-dimensional variable can be used to define mathematical operations on
multiple subdomains simultaneously (provided it is combined with other operators
defined on the same subdomains).</p>
<p>NOTE: mixed-dimensional variables are assigned unique ids (see documentation of
Variable and MixedDimensionalVariable), thus two MixedDimensionalVariables will have
different ids even if they represent the same combination of subdomains and variables.
This does not impact the parsing of the variables into numerical values.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>grid_var</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Sequence" title="(in Python v3.11)"><em>Sequence</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.11)"><em>Tuple</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.11)"><em>Union</em></a><em>[</em><a class="reference internal" href="porepy.grids.grid.html#porepy.grids.grid.Grid" title="porepy.grids.grid.Grid"><em>Grid</em></a><em>, </em><a class="reference internal" href="porepy.grids.mortar_grid.html#porepy.grids.mortar_grid.MortarGrid" title="porepy.grids.mortar_grid.MortarGrid"><em>MortarGrid</em></a><em>]</em><em>, </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><em>str</em></a><em>]</em><em>]</em>) – Tuple containing first a (Mortar)grid representing the subdomain
or interface and second the name of the variable.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><dl class="simple">
<dt>Joint representation of the variable on the</dt><dd><p>specified subdomains.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>pp.ad.MixedDimensionalVariable</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="porepy.numerics.ad.EquationManager.name_and_assign_equations">
<span class="sig-name descname"><span class="pre">name_and_assign_equations</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">equation_dictionary</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/porepy/numerics/ad/equation_manager.html#EquationManager.name_and_assign_equations"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#porepy.numerics.ad.EquationManager.name_and_assign_equations" title="Permalink to this definition"></a></dt>
<dd><p>Convenience method for assigning and naming equations.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>equation_dictionary</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code>) – Dictionary containing name: equation pairs.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="porepy.numerics.ad.EquationManager.subsystem_equation_manager">
<span class="sig-name descname"><span class="pre">subsystem_equation_manager</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eq_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">variables</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/porepy/numerics/ad/equation_manager.html#EquationManager.subsystem_equation_manager"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#porepy.numerics.ad.EquationManager.subsystem_equation_manager" title="Permalink to this definition"></a></dt>
<dd><p>Extract an EquationManager for a subset of variables and equations.
In effect, this produce a nonlinear subsystem.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>eq_names</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span> <span class="pre">of</span> <span class="pre">str</span></code>) – Equations assigned to the new EquationManager,
specified as keys in self.equations.</p></li>
<li><p><strong>variables</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span> <span class="pre">of</span> <span class="pre">Variables</span></code>) – Variables for which the new EquationManager is
defined.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><dl class="simple">
<dt>System of nonlinear equations. The ordering of the</dt><dd><p>equations in the subsystem will be the same as in the original
EquationManager (i.e. self),  disregarding equations not included in the
subset. Variables that were excluded are added to the set of
secondary_variables in the new EquationManager.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#porepy.numerics.ad.EquationManager" title="porepy.numerics.ad.EquationManager">EquationManager</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="porepy.numerics.ad.EquationManager.variable">
<span class="sig-name descname"><span class="pre">variable</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">grid_like</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">variable</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/porepy/numerics/ad/equation_manager.html#EquationManager.variable"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#porepy.numerics.ad.EquationManager.variable" title="Permalink to this definition"></a></dt>
<dd><p>Get a variable for a specified grid or interface between grids, that is
a mortar grid.</p>
<p>Subsequent calls of this method with the same grid and variable will return
references to the same variable.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Ad representation of a variable.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>pp.ad.Variable</p>
</dd>
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>grid_like</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.11)"><em>Union</em></a><em>[</em><a class="reference internal" href="porepy.grids.grid.html#porepy.grids.grid.Grid" title="porepy.grids.grid.Grid"><em>Grid</em></a><em>, </em><a class="reference internal" href="porepy.grids.mortar_grid.html#porepy.grids.mortar_grid.MortarGrid" title="porepy.grids.mortar_grid.MortarGrid"><em>MortarGrid</em></a><em>]</em>) – </p></li>
<li><p><strong>variable</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><em>str</em></a>) – </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="porepy.numerics.ad.EquationManager.variable_state">
<span class="sig-name descname"><span class="pre">variable_state</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">grid_var</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/porepy/numerics/ad/equation_manager.html#EquationManager.variable_state"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#porepy.numerics.ad.EquationManager.variable_state" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>grid_var</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.11)"><em>List</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.11)"><em>Tuple</em></a><em>[</em><a class="reference internal" href="porepy.grids.grid.html#porepy.grids.grid.Grid" title="porepy.grids.grid.Grid"><em>Grid</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><em>str</em></a><em>]</em><em>]</em>) – </p></li>
<li><p><strong>state</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.24)"><em>ndarray</em></a>) – </p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.11)"><em>List</em></a>[<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.24)"><em>ndarray</em></a>]</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="porepy.numerics.ad.EquationSystem">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">EquationSystem</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mdg</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/porepy/numerics/ad/equation_system.html#EquationSystem"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#porepy.numerics.ad.EquationSystem" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Represents an equation system, modelled by AD variables and equations in AD form.</p>
<p>This class provides functionalities to create and manage variables, as well as
managing equations on the form of <a class="reference internal" href="porepy.numerics.ad.operators.html#porepy.numerics.ad.operators.Operator" title="porepy.numerics.ad.operators.Operator"><code class="xref py py-class docutils literal notranslate"><span class="pre">Operator</span></code></a>.
It further provides functions to assemble subsystems and using subsets of equations
and variables.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>As of now, the system matrix (Jacobian) is assembled with respect to ALL
variables and then the columns belonging to the requested subset of variables
and grids are sliced out and returned. This will be optimized with minor changes
to the AD operator class and its recursive forward AD mode in the future.</p>
<p>Currently, this class optimizes the block structure of the Jacobian only
regarding the subdomains and interfaces. A more localized optimization (e.g.
cell-wise for equations without spatial differential operators) is not
performed.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>mdg</strong> (<em>pp.MixedDimensionalGrid</em>) – </p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="porepy.numerics.ad.EquationSystem.SubSystem">
<span class="sig-name descname"><span class="pre">SubSystem</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">equation_names</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">variable_names</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/porepy/numerics/ad/equation_system.html#EquationSystem.SubSystem"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#porepy.numerics.ad.EquationSystem.SubSystem" title="Permalink to this definition"></a></dt>
<dd><p>Creates an <a class="reference internal" href="#porepy.numerics.ad.EquationSystem" title="porepy.numerics.ad.EquationSystem"><code class="xref py py-class docutils literal notranslate"><span class="pre">EquationSystem</span></code></a> for a given subset of equations and
variables.</p>
<p>Currently only subsystems containing <em>whole</em> equations and variables in the
mixed-dimensional sense can be created. Restrictions of equations to subdomains
is not supported.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>equation_names</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><em>Optional</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.11)"><em>Union</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.11)"><em>list</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><em>str</em></a><em>]</em><em>, </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.11)"><em>list</em></a><em>[</em><a class="reference internal" href="porepy.numerics.ad.operators.html#porepy.numerics.ad.operators.Operator" title="porepy.numerics.ad.operators.Operator"><em>porepy.numerics.ad.operators.Operator</em></a><em>]</em><em>]</em><em>]</em>) – Names of equations for the new subsystem. If None, all
equations known to the <a class="reference internal" href="#porepy.numerics.ad.EquationSystem" title="porepy.numerics.ad.EquationSystem"><code class="xref py py-class docutils literal notranslate"><span class="pre">EquationSystem</span></code></a> are used.</p></li>
<li><p><strong>variable_names</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><em>Optional</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.11)"><em>Union</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.11)"><em>list</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><em>str</em></a><em>]</em><em>, </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.11)"><em>list</em></a><em>[</em><a class="reference internal" href="porepy.numerics.ad.operators.html#porepy.numerics.ad.operators.Variable" title="porepy.numerics.ad.operators.Variable"><em>porepy.numerics.ad.operators.Variable</em></a><em>]</em><em>, </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.11)"><em>list</em></a><em>[</em><a class="reference internal" href="porepy.numerics.ad.operators.html#porepy.numerics.ad.operators.MixedDimensionalVariable" title="porepy.numerics.ad.operators.MixedDimensionalVariable"><em>porepy.numerics.ad.operators.MixedDimensionalVariable</em></a><em>]</em><em>]</em><em>]</em>) – Names of known variables for the new subsystem. If None, all
variables known to the <a class="reference internal" href="#porepy.numerics.ad.EquationSystem" title="porepy.numerics.ad.EquationSystem"><code class="xref py py-class docutils literal notranslate"><span class="pre">EquationSystem</span></code></a> are used.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A new instance of <a class="reference internal" href="#porepy.numerics.ad.EquationSystem" title="porepy.numerics.ad.EquationSystem"><code class="xref py py-class docutils literal notranslate"><span class="pre">EquationSystem</span></code></a>. The subsystem equations and
variables are ordered as imposed by this systems’s order.</p>
</dd>
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.11)"><strong>ValueError</strong></a> – if passed names are not among created variables and set
    equations.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference internal" href="porepy.numerics.ad.equation_system.html#porepy.numerics.ad.equation_system.EquationSystem" title="porepy.numerics.ad.equation_system.EquationSystem"><em>EquationSystem</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="porepy.numerics.ad.EquationSystem.assemble">
<span class="sig-name descname"><span class="pre">assemble</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/porepy/numerics/ad/equation_system.html#EquationSystem.assemble"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#porepy.numerics.ad.EquationSystem.assemble" title="Permalink to this definition"></a></dt>
<dd><p>Assemble Jacobian matrix and residual vector of the whole system.</p>
<p>This is a shallow wrapper of <a class="reference internal" href="#porepy.numerics.ad.EquationSystem.assemble_subsystem" title="porepy.numerics.ad.EquationSystem.assemble_subsystem"><code class="xref py py-meth docutils literal notranslate"><span class="pre">assemble_subsystem()</span></code></a>. Here, the subsystem is
the complete set of equations, variables and grids.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>state</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">optional</span></code>) – see <a class="reference internal" href="#porepy.numerics.ad.EquationSystem.assemble_subsystem" title="porepy.numerics.ad.EquationSystem.assemble_subsystem"><code class="xref py py-meth docutils literal notranslate"><span class="pre">assemble_subsystem()</span></code></a>. Defaults to None.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><dl>
<dt>Tuple containing</dt><dd><p>sps.spmatrix: Jacobian matrix corresponding to the targeted state.
The ordering of the equations (rows) is determined by the order the
equations were added. The DOFs (columns) are ordered according to the
global order.</p>
<p>np.ndarray: Residual vector corresponding to the targeted state, scaled
by -1 (moved to rhs).</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.11)">tuple</a>[<a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.sparse.spmatrix.html#scipy.sparse.spmatrix" title="(in SciPy v1.10.0)">scipy.sparse._base.spmatrix</a>, <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.24)">numpy.ndarray</a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="porepy.numerics.ad.EquationSystem.assemble_schur_complement_system">
<span class="sig-name descname"><span class="pre">assemble_schur_complement_system</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">primary_equations</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">primary_variables</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inverter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/porepy/numerics/ad/equation_system.html#EquationSystem.assemble_schur_complement_system"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#porepy.numerics.ad.EquationSystem.assemble_schur_complement_system" title="Permalink to this definition"></a></dt>
<dd><p>Assemble Jacobian matrix and residual vector using a Schur complement
elimination of the variables and equations not to be included.</p>
<p>The specified equations and variables will define blocks of the linearized
system as</p>
<div class="math notranslate nohighlight">
\[\begin{split}\left [ \begin{matrix} A_{pp} &amp; A_{ps} \\ A_{sp} &amp; A_{ss} \end{matrix} \right]
\left [ \begin{matrix} x_p \\ x_s \end{matrix}\right]
= \left [ \begin{matrix} b_p \\ b_s \end{matrix}\right]\end{split}\]</div>
<p>where subscripts p and s define primary and secondary blocks.
The Schur complement system is then given by</p>
<div class="math notranslate nohighlight">
\[\left( A_{pp} - A_{ps} * A_{ss}^{-1} * A_{sp}\right) * x_p
= b_p - A_{ps} * A_{ss} * b_s\]</div>
<p>The Schur complement is well-defined only if the inverse of <span class="math notranslate nohighlight">\(A_{ss}\)</span>
exists, and the efficiency of the approach assumes that an efficient inverter
for <span class="math notranslate nohighlight">\(A_{ss}\)</span> can be found.
<strong>The user must ensure both requirements are fulfilled.</strong></p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The optional arguments defining the secondary block, and the flag
<code class="docutils literal notranslate"><span class="pre">excl_loc_prim_to_sec</span></code> are meant for nested Schur-complements and
splitting solvers. This is an advanced usage and requires the user to be
careful, since the resulting blocks <span class="math notranslate nohighlight">\(A_{pp}\)</span> and <span class="math notranslate nohighlight">\(A_{ss}\)</span> might
end up to be not square. This will result in errors.</p>
</div>
<div class="admonition-examples admonition">
<p class="admonition-title">Examples</p>
<p>The default inverter can be defined by</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">scipy.sparse</span> <span class="k">as</span> <span class="nn">sps</span>
<span class="n">inverter</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">A</span><span class="p">:</span> <span class="n">sps</span><span class="o">.</span><span class="n">csr_matrix</span><span class="p">(</span><span class="n">sps</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="n">A</span><span class="o">.</span><span class="n">A</span><span class="p">))</span>
</pre></div>
</div>
<p>It is costly in terms of computational time and memory, though.</p>
<p>TODO: We should rather use the block inverter in pp.matrix_operations. This
will require some work on ensuring the system is block-diagonal.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>primary_equations</strong> (<em>EquationList</em><em> | </em><em>EquationRestriction</em>) – a subset of equations specifying the primary subspace in
row-sense.</p></li>
<li><p><strong>primary_variables</strong> (<em>VariableList</em>) – VariableType input specifying the primary subspace in
column-sense.</p></li>
<li><p><strong>inverter</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">optional</span></code>) – callable object to compute the inverse of the matrix
<span class="math notranslate nohighlight">\(A_{ss}\)</span>. By default, the scipy direct sparse inverter is used.</p></li>
<li><p><strong>state</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">optional</span></code>) – see <a class="reference internal" href="#porepy.numerics.ad.EquationSystem.assemble_subsystem" title="porepy.numerics.ad.EquationSystem.assemble_subsystem"><code class="xref py py-meth docutils literal notranslate"><span class="pre">assemble_subsystem()</span></code></a>. Defaults to None.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p>Tuple containing</p>
<blockquote>
<div><p>sps.spmatrix: Jacobian matrix representing the Schur complement with
respect to the targeted state.
np.ndarray: Residual vector for the Schur complement with respect to the
targeted state. Scaled with -1 (moved to rhs).</p>
</div></blockquote>
</p>
</dd>
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><ul class="simple">
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#AssertionError" title="(in Python v3.11)"><strong>AssertionError</strong></a> – <ul>
<li><p>If the primary block would have 0 rows or columns.
    - If the secondary block would have 0 rows or columns.
    - If the secondary block is not square.</p></li>
</ul>
</p></li>
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.11)"><strong>ValueError</strong></a> – If primary and secondary columns overlap.</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.11)">tuple</a>[sps.spmatrix, np.ndarray]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="porepy.numerics.ad.EquationSystem.assemble_subsystem">
<span class="sig-name descname"><span class="pre">assemble_subsystem</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">equations</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">variables</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/porepy/numerics/ad/equation_system.html#EquationSystem.assemble_subsystem"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#porepy.numerics.ad.EquationSystem.assemble_subsystem" title="Permalink to this definition"></a></dt>
<dd><p>Assemble Jacobian matrix and residual vector using a specified subset of
equations, variables and grids.</p>
<p>The method is intended for use in splitting algorithms. Matrix blocks not
included will simply be sliced out.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The ordering of columns in the returned system are defined by the global
DOF order. The row blocks are in the same order as equations were added to
this system. If an equation is defined on multiple grids, the respective
row-block is internally ordered as given by the mixed-dimensional grid
(for sd in subdomains, for intf in interfaces).</p>
<p>The columns of the subsystem are assumed to be properly defined by
<code class="docutils literal notranslate"><span class="pre">variables</span></code>, otherwise a matrix of shape <code class="docutils literal notranslate"><span class="pre">(M,)</span></code> is returned. This
happens if grid variables are passed which are unknown to this
<a class="reference internal" href="#porepy.numerics.ad.EquationSystem" title="porepy.numerics.ad.EquationSystem"><code class="xref py py-class docutils literal notranslate"><span class="pre">EquationSystem</span></code></a>.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>equations</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">optional</span></code>) – <p>a subset of equations to which the subsystem should be
restricted. If not provided (None), all equations known to this
<a class="reference internal" href="#porepy.numerics.ad.EquationSystem" title="porepy.numerics.ad.EquationSystem"><code class="xref py py-class docutils literal notranslate"><span class="pre">EquationSystem</span></code></a> will be included.</p>
<p>The user can specify grids per equation (name) to which the subsystem
should be restricted in the row-sense. Grids not belonging to the domain
of an equation will raise an error.</p>
</p></li>
<li><p><strong>variables</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">optional</span></code>) – VariableType input specifying the subspace in
column-sense. If not provided (None), all variables will be included.</p></li>
<li><p><strong>state</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">optional</span></code>) – State vector to assemble from. By default, the stored
<code class="docutils literal notranslate"><span class="pre">pp.ITERATE</span></code> or <code class="docutils literal notranslate"><span class="pre">pp.STATE</span></code> are used, in that order.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p>Tuple with two elements</p>
<blockquote>
<div><p>spmatrix: (Part of the) Jacobian matrix corresponding to the targeted
variable state, for the specified equations and variables.
ndarray: Residual vector corresponding to the targeted variable state,
for the specified equations. Scaled with -1 (moved to rhs).</p>
</div></blockquote>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.11)">tuple</a>[sps.spmatrix, np.ndarray]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="porepy.numerics.ad.EquationSystem.create_variables">
<span class="sig-name descname"><span class="pre">create_variables</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dof_info</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subdomains</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interfaces</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tags</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/porepy/numerics/ad/equation_system.html#EquationSystem.create_variables"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#porepy.numerics.ad.EquationSystem.create_variables" title="Permalink to this definition"></a></dt>
<dd><p>Creates new variables according to specifications.</p>
<p>This method does not assign any values to the variable. This has to be done in a
subsequent step (e.g. using <code class="xref py py-meth docutils literal notranslate"><span class="pre">set_var_values()</span></code>).</p>
<div class="admonition-examples admonition">
<p class="admonition-title">Examples</p>
<p>An example on how to define a pressure variable with cell-wise one DOF
(default) on <strong>all</strong> subdomains and <strong>no</strong> interfaces would be</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">p</span> <span class="o">=</span> <span class="n">ad_system</span><span class="o">.</span><span class="n">create_variables</span><span class="p">(</span><span class="s1">&#39;pressure&#39;</span><span class="p">,</span> <span class="n">subdomains</span><span class="o">=</span><span class="n">mdg</span><span class="o">.</span><span class="n">subdomains</span><span class="p">())</span>
</pre></div>
</div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><em>str</em></a>) – Name of the variable.</p></li>
<li><p><strong>dof_info</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><em>Optional</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.11)"><em>dict</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Literal" title="(in Python v3.11)"><em>Literal</em></a><em>[</em><em>'cells'</em><em>, </em><em>'faces'</em><em>, </em><em>'nodes'</em><em>]</em><em>, </em><em>int</em><em>]</em><em>]</em>) – Dictionary containing information about number of DOFs per
admissible type. Defaults to <code class="docutils literal notranslate"><span class="pre">{'cells':1}</span></code>.</p></li>
<li><p><strong>subdomains</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">optional</span></code>) – List of subdomains on which the variable is defined.
If None, then it will not be defined on any subdomain.</p></li>
<li><p><strong>interfaces</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">optional</span></code>) – list of interfaces on which the variable is defined.
If None, then it will not be defined on any interface.</p></li>
<li><p><strong>tags</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">optional</span></code>) – dictionary containing tags for the variables. The tags are
assigned to all variables created by this method and can be updated
using <a class="reference internal" href="#porepy.numerics.ad.EquationSystem.update_variable_tags" title="porepy.numerics.ad.EquationSystem.update_variable_tags"><code class="xref py py-meth docutils literal notranslate"><span class="pre">update_variable_tags()</span></code></a>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A mixed-dimensional variable with above specifications.</p>
</dd>
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><ul class="simple">
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.11)"><strong>ValueError</strong></a> – If non-admissible DOF types are used as local DOFs.</p></li>
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.11)"><strong>ValueError</strong></a> – If one attempts to create a variable not defined on any grid.</p></li>
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#KeyError" title="(in Python v3.11)"><strong>KeyError</strong></a> – If a variable with given name is already defined.</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference internal" href="porepy.numerics.ad.operators.html#porepy.numerics.ad.operators.MixedDimensionalVariable" title="porepy.numerics.ad.operators.MixedDimensionalVariable"><em>MixedDimensionalVariable</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="porepy.numerics.ad.EquationSystem.discretize">
<span class="sig-name descname"><span class="pre">discretize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">equations</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/porepy/numerics/ad/equation_system.html#EquationSystem.discretize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#porepy.numerics.ad.EquationSystem.discretize" title="Permalink to this definition"></a></dt>
<dd><p>Find and loop over all discretizations in the equation operators, extract
unique references and discretize.</p>
<p>This is more efficient than discretizing on the Operator level, since
discretizations which occur more than once in a set of equations will be
identified and only discretized once.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>equations</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">optional</span></code>) – A subset of equations. If not provided (None), all
known equations will be discretized.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="porepy.numerics.ad.EquationSystem.dofs_of">
<span class="sig-name descname"><span class="pre">dofs_of</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">variables</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/porepy/numerics/ad/equation_system.html#EquationSystem.dofs_of"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#porepy.numerics.ad.EquationSystem.dofs_of" title="Permalink to this definition"></a></dt>
<dd><p>Get the indices in the global vector of unknowns belonging to the variable(s).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>variables</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.11)"><em>Union</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.11)"><em>list</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><em>str</em></a><em>]</em><em>, </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.11)"><em>list</em></a><em>[</em><a class="reference internal" href="porepy.numerics.ad.operators.html#porepy.numerics.ad.operators.Variable" title="porepy.numerics.ad.operators.Variable"><em>porepy.numerics.ad.operators.Variable</em></a><em>]</em><em>, </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.11)"><em>list</em></a><em>[</em><a class="reference internal" href="porepy.numerics.ad.operators.html#porepy.numerics.ad.operators.MixedDimensionalVariable" title="porepy.numerics.ad.operators.MixedDimensionalVariable"><em>porepy.numerics.ad.operators.MixedDimensionalVariable</em></a><em>]</em><em>]</em>) – VariableType input for which the indices are requested.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>an order-preserving array of indices of DOFs belonging to the VariableType input.</p>
</dd>
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.11)"><strong>ValueError</strong></a> – if unknown VariableType arguments are passed.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.24)"><em>ndarray</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="porepy.numerics.ad.EquationSystem.expand_schur_complement_solution">
<span class="sig-name descname"><span class="pre">expand_schur_complement_solution</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">reduced_solution</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/porepy/numerics/ad/equation_system.html#EquationSystem.expand_schur_complement_solution"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#porepy.numerics.ad.EquationSystem.expand_schur_complement_solution" title="Permalink to this definition"></a></dt>
<dd><p>Expands the solution of the <em>last assembled</em> Schur complement system to the
whole solution.</p>
<p>With <code class="docutils literal notranslate"><span class="pre">reduced_solution</span></code> as <span class="math notranslate nohighlight">\(x_p\)</span> from</p>
<div class="math notranslate nohighlight">
\[\begin{split}\left [ \begin{matrix} A_{pp} &amp; A_{ps} \\ A_{sp} &amp; A_{ss} \end{matrix} \right]
\left [ \begin{matrix} x_p \\ x_s \end{matrix}\right]
= \left [ \begin{matrix} b_p \\ b_s \end{matrix}\right],\end{split}\]</div>
<p>the method returns the whole vector <span class="math notranslate nohighlight">\([x_p, x_s]\)</span>, where</p>
<div class="math notranslate nohighlight">
\[x_s = A_{ss}^{-1} * (b_s - A_{sp} * x_p).\]</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Independent of how the primary and secondary blocks were chosen, this method
always returns a vector of size <code class="docutils literal notranslate"><span class="pre">num_dofs</span></code>.
Especially when the primary and secondary variables did not constitute the
whole vector of unknowns, the result is still of size <code class="docutils literal notranslate"><span class="pre">num_dofs</span></code>.
The entries corresponding to the excluded grid variables are zero.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>reduced_solution</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.24)"><em>ndarray</em></a>) – Solution to the linear system returned by
<a class="reference internal" href="#porepy.numerics.ad.EquationSystem.assemble_schur_complement_system" title="porepy.numerics.ad.EquationSystem.assemble_schur_complement_system"><code class="xref py py-meth docutils literal notranslate"><span class="pre">assemble_schur_complement_system()</span></code></a>.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The expanded Schur solution in global size.</p>
</dd>
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.11)"><strong>ValueError</strong></a> – If the Schur complement system was not assembled before.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.24)"><em>ndarray</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="porepy.numerics.ad.EquationSystem.get_variable_values">
<span class="sig-name descname"><span class="pre">get_variable_values</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">variables</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">from_iterate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/porepy/numerics/ad/equation_system.html#EquationSystem.get_variable_values"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#porepy.numerics.ad.EquationSystem.get_variable_values" title="Permalink to this definition"></a></dt>
<dd><p>Assembles an array containing values for the passed variable-like argument.</p>
<p>The global order is preserved and independent of the order of the argument.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>variables</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">optional</span></code>) – VariableType input for which the values are
requested. If None (default), the global vector of unknowns is returned.</p></li>
<li><p><strong>from_iterate</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">optional</span></code>) – flag to return values stored as ITERATE,
instead of STATE (default).</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><dl class="simple">
<dt>The respective (sub) vector in numerical format, size anywhere between 0 and</dt><dd><p><a class="reference internal" href="#porepy.numerics.ad.EquationSystem.num_dofs" title="porepy.numerics.ad.EquationSystem.num_dofs"><code class="xref py py-meth docutils literal notranslate"><span class="pre">num_dofs()</span></code></a>.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><ul class="simple">
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#KeyError" title="(in Python v3.11)"><strong>KeyError</strong></a> – If no values are stored for the VariableType input.</p></li>
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.11)"><strong>ValueError</strong></a> – If unknown VariableType arguments are passed.</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.24)"><em>ndarray</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="porepy.numerics.ad.EquationSystem.get_variables">
<span class="sig-name descname"><span class="pre">get_variables</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">variables</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grids</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tag_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tag_value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/porepy/numerics/ad/equation_system.html#EquationSystem.get_variables"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#porepy.numerics.ad.EquationSystem.get_variables" title="Permalink to this definition"></a></dt>
<dd><p>Filter variables based on grid, tag name and tag value.</p>
<p>Particular usage: calling without arguments will return all variables in the
system.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>variables</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><em>Optional</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.11)"><em>Union</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.11)"><em>list</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><em>str</em></a><em>]</em><em>, </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.11)"><em>list</em></a><em>[</em><a class="reference internal" href="porepy.numerics.ad.operators.html#porepy.numerics.ad.operators.Variable" title="porepy.numerics.ad.operators.Variable"><em>porepy.numerics.ad.operators.Variable</em></a><em>]</em><em>, </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.11)"><em>list</em></a><em>[</em><a class="reference internal" href="porepy.numerics.ad.operators.html#porepy.numerics.ad.operators.MixedDimensionalVariable" title="porepy.numerics.ad.operators.MixedDimensionalVariable"><em>porepy.numerics.ad.operators.MixedDimensionalVariable</em></a><em>]</em><em>]</em><em>]</em>) – List of variables to filter. If None, all variables in the system
are included. Variables can be given as a list of variables, mixed-
dimensional variables, or variable names (strings).</p></li>
<li><p><strong>grids</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><em>Optional</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.11)"><em>list</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.11)"><em>Union</em></a><em>[</em><a class="reference internal" href="porepy.grids.grid.html#porepy.grids.grid.Grid" title="porepy.grids.grid.Grid"><em>porepy.grids.grid.Grid</em></a><em>, </em><a class="reference internal" href="porepy.grids.mortar_grid.html#porepy.grids.mortar_grid.MortarGrid" title="porepy.grids.mortar_grid.MortarGrid"><em>porepy.grids.mortar_grid.MortarGrid</em></a><em>]</em><em>]</em><em>]</em>) – List of grids to filter on. If None, all grids are included.</p></li>
<li><p><strong>tag_name</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><em>Optional</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><em>str</em></a><em>]</em>) – Name of the tag to filter on. If None, no filtering on tags.</p></li>
<li><p><strong>tag_value</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><em>Optional</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.11)"><em>Any</em></a><em>]</em>) – Value of the tag to filter on. If None, no filtering on tag
values. If tag_name is not None, but tag_value is None, all variables
with the given tag_name are returned regardless of value.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>List of filtered variables.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.11)">list</a>[<a class="reference internal" href="porepy.numerics.ad.operators.html#porepy.numerics.ad.operators.Variable" title="porepy.numerics.ad.operators.Variable">porepy.numerics.ad.operators.Variable</a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="porepy.numerics.ad.EquationSystem.identify_dof">
<span class="sig-name descname"><span class="pre">identify_dof</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dof</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/porepy/numerics/ad/equation_system.html#EquationSystem.identify_dof"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#porepy.numerics.ad.EquationSystem.identify_dof" title="Permalink to this definition"></a></dt>
<dd><p>Identifies the variable to which a specific DOF index belongs.</p>
<p>The intended use is to help identify entries in the global vector or the column
of the Jacobian.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>dof</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a>) – a single index in the global vector.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference internal" href="porepy.numerics.ad.operators.html#porepy.numerics.ad.operators.Variable" title="porepy.numerics.ad.operators.Variable"><em>Variable</em></a></p>
</dd>
</dl>
<p>Returns: the identified Variable object.</p>
<dl class="field-list simple">
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#KeyError" title="(in Python v3.11)"><strong>KeyError</strong></a> – if the dof is out of range (larger than <code class="docutils literal notranslate"><span class="pre">num_dofs</span></code> or smaller
    than 0).</p>
</dd>
<dt class="field-even">Parameters</dt>
<dd class="field-even"><p><strong>dof</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a>) – </p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="porepy.numerics.ad.operators.html#porepy.numerics.ad.operators.Variable" title="porepy.numerics.ad.operators.Variable"><em>Variable</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="porepy.numerics.ad.EquationSystem.md_variable">
<span class="sig-name descname"><span class="pre">md_variable</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grids</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/porepy/numerics/ad/equation_system.html#EquationSystem.md_variable"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#porepy.numerics.ad.EquationSystem.md_variable" title="Permalink to this definition"></a></dt>
<dd><p>Create a mixed-dimensional variable for a given name-domain list combination.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>) – Name of the mixed-dimensional variable.</p></li>
<li><p><strong>grids</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">optional</span></code>) – List of grids where the variable is defined. If None
(default), all grids where the variable is defined are used.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A mixed-dimensional variable.</p>
</dd>
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.11)"><strong>ValueError</strong></a> – If variables name exist on both grids and interfaces and domain
    type is not specified (grids is None).</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference internal" href="porepy.numerics.ad.operators.html#porepy.numerics.ad.operators.MixedDimensionalVariable" title="porepy.numerics.ad.operators.MixedDimensionalVariable"><em>MixedDimensionalVariable</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="porepy.numerics.ad.EquationSystem.num_dofs">
<span class="sig-name descname"><span class="pre">num_dofs</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/porepy/numerics/ad/equation_system.html#EquationSystem.num_dofs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#porepy.numerics.ad.EquationSystem.num_dofs" title="Permalink to this definition"></a></dt>
<dd><p>Returns the total number of dofs managed by this system.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)">int</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="porepy.numerics.ad.EquationSystem.projection_to">
<span class="sig-name descname"><span class="pre">projection_to</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">variables</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/porepy/numerics/ad/equation_system.html#EquationSystem.projection_to"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#porepy.numerics.ad.EquationSystem.projection_to" title="Permalink to this definition"></a></dt>
<dd><p>Create a projection matrix from the global vector of unknowns to a specified
subspace.</p>
<p>The transpose of the returned matrix can be used to slice respective columns out
of the global Jacobian.</p>
<p>The projection preserves the global order defined by the system, i.e. it
includes no permutation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>variables</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">optional</span></code>) – VariableType input for which the subspace is
requested. If no subspace is specified using <code class="docutils literal notranslate"><span class="pre">variables</span></code>,
a null-space projection is returned.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>a sparse projection matrix of shape <code class="docutils literal notranslate"><span class="pre">(M,</span> <span class="pre">num_dofs)</span></code>, where
<code class="docutils literal notranslate"><span class="pre">0</span> <span class="pre">&lt;=</span> <span class="pre">M</span> <span class="pre">&lt;=</span> <span class="pre">num_dofs</span></code>.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.sparse.csr_matrix.html#scipy.sparse.csr_matrix" title="(in SciPy v1.10.0)"><em>csr_matrix</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="porepy.numerics.ad.EquationSystem.remove_equation">
<span class="sig-name descname"><span class="pre">remove_equation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/porepy/numerics/ad/equation_system.html#EquationSystem.remove_equation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#porepy.numerics.ad.EquationSystem.remove_equation" title="Permalink to this definition"></a></dt>
<dd><p>Removes a previously set equation and all related information.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>A reference to the equation in operator form or None, if the equation is
unknown.</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.11)"><strong>ValueError</strong></a> – If an unknown equation is attempted removed.</p>
</dd>
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><em>str</em></a>) – </p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference internal" href="#porepy.numerics.ad.Operator" title="porepy.numerics.ad.Operator">Operator</a> | None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="porepy.numerics.ad.EquationSystem.set_equation">
<span class="sig-name descname"><span class="pre">set_equation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">equation</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grids</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">equations_per_grid_entity</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/porepy/numerics/ad/equation_system.html#EquationSystem.set_equation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#porepy.numerics.ad.EquationSystem.set_equation" title="Permalink to this definition"></a></dt>
<dd><p>Sets an equation using the passed operator and uses its name as an identifier.</p>
<p>If an equation already exists under that name, it is overwritten.</p>
<p>Information about the image space must be provided for now, such that grid-wise
row slicing is possible. This will hopefully be provided automatically in the
future.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Regarding the number of equations, this method assumes that the AD framework
assembles row blocks per grid in subdomains, then per grid in interfaces,
for each operator representing an equation. This is assumed to be the way
PorePy AD works.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>equation</strong> (<a class="reference internal" href="porepy.numerics.ad.operators.html#porepy.numerics.ad.operators.Operator" title="porepy.numerics.ad.operators.Operator"><em>Operator</em></a>) – An equation in AD operator form, assuming the right-hand side is
zero and this instance represents the left-hand side.</p></li>
<li><p><strong>grids</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.11)"><em>Union</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.11)"><em>list</em></a><em>[</em><a class="reference internal" href="porepy.grids.grid.html#porepy.grids.grid.Grid" title="porepy.grids.grid.Grid"><em>porepy.grids.grid.Grid</em></a><em>]</em><em>, </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.11)"><em>list</em></a><em>[</em><a class="reference internal" href="porepy.grids.mortar_grid.html#porepy.grids.mortar_grid.MortarGrid" title="porepy.grids.mortar_grid.MortarGrid"><em>porepy.grids.mortar_grid.MortarGrid</em></a><em>]</em><em>]</em>) – A list of subdomain <em>or</em> interface grids on which the equation is
defined.</p></li>
<li><p><strong>equations_per_grid_entity</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.11)"><em>dict</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Literal" title="(in Python v3.11)"><em>Literal</em></a><em>[</em><em>'cells'</em><em>, </em><em>'faces'</em><em>, </em><em>'nodes'</em><em>]</em><em>, </em><em>int</em><em>]</em>) – a dictionary describing how many equations
<code class="docutils literal notranslate"><span class="pre">equation_operator</span></code> provides. This is a temporary work-around until
operators are able to provide information on their image space.
The dictionary must contain the number of equations per grid entity
(cells, faces, nodes) for the operator.</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><ul class="simple">
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.11)"><strong>ValueError</strong></a> – If the equation operator has a name already assigned to a
    previously set equation.</p></li>
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.11)"><strong>ValueError</strong></a> – If the equation is defined on both subdomains and interfaces.</p></li>
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#AssertionError" title="(in Python v3.11)"><strong>AssertionError</strong></a> – If the equation is defined on an unknown grid.</p></li>
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.11)"><strong>ValueError</strong></a> – If indicated number of equations does not match the actual
    number as per evaluation of operator.</p></li>
</ul>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="porepy.numerics.ad.EquationSystem.set_variable_values">
<span class="sig-name descname"><span class="pre">set_variable_values</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">values</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">variables</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">to_state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">to_iterate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">additive</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/porepy/numerics/ad/equation_system.html#EquationSystem.set_variable_values"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#porepy.numerics.ad.EquationSystem.set_variable_values" title="Permalink to this definition"></a></dt>
<dd><p>Sets values for a (sub) vector of the global vector of unknowns.</p>
<p>The order of values is assumed to fit the global order.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The vector is assumed to be of proper size and will be dissected according
to the global order, starting with the index 0.
Mismatches of is-size and should-be-size according to the subspace specified
by <code class="docutils literal notranslate"><span class="pre">variables</span></code> will raise respective errors by numpy.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>values</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.24)"><em>ndarray</em></a>) – Vector of size corresponding to number of DOFs of the specified
variables.</p></li>
<li><p><strong>variables</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">optional</span></code>) – VariableType input for which the values are
requested. If None (default), the global vector of unknowns will be
set.</p></li>
<li><p><strong>to_state</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">optional</span></code>) – Flag to write values to <code class="docutils literal notranslate"><span class="pre">pp.STATE</span></code>.</p></li>
<li><p><strong>to_iterate</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">optional</span></code>) – Flag to write values to <code class="docutils literal notranslate"><span class="pre">pp.ITERATE</span></code>.</p></li>
<li><p><strong>additive</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">optional</span></code>) – Flag to write values additively. To be used in
iterative procedures.</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.11)"><strong>ValueError</strong></a> – If unknown VariableType arguments are passed.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="porepy.numerics.ad.EquationSystem.update_variable_tags">
<span class="sig-name descname"><span class="pre">update_variable_tags</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tags</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">variables</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/porepy/numerics/ad/equation_system.html#EquationSystem.update_variable_tags"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#porepy.numerics.ad.EquationSystem.update_variable_tags" title="Permalink to this definition"></a></dt>
<dd><p>Assigns tags to variables.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tag_name</strong> – Tag dictionary (tag-value pairs). This will be assigned to all
variables in the list.</p></li>
<li><p><strong>variables</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><em>Optional</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.11)"><em>Union</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.11)"><em>list</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><em>str</em></a><em>]</em><em>, </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.11)"><em>list</em></a><em>[</em><a class="reference internal" href="porepy.numerics.ad.operators.html#porepy.numerics.ad.operators.Variable" title="porepy.numerics.ad.operators.Variable"><em>porepy.numerics.ad.operators.Variable</em></a><em>]</em><em>, </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.11)"><em>list</em></a><em>[</em><a class="reference internal" href="porepy.numerics.ad.operators.html#porepy.numerics.ad.operators.MixedDimensionalVariable" title="porepy.numerics.ad.operators.MixedDimensionalVariable"><em>porepy.numerics.ad.operators.MixedDimensionalVariable</em></a><em>]</em><em>]</em><em>]</em>) – List of variables to which the tag should be assigned. None is
interpreted as all variables. If a mixed-dimensional variable is passed,
the tags will be assigned to its sub-variables (living on individual
grids).</p></li>
<li><p><strong>tags</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.11)"><em>dict</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><em>str</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.11)"><em>Any</em></a><em>]</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="porepy.numerics.ad.EquationSystem.admissible_dof_types">
<span class="sig-name descname"><span class="pre">admissible_dof_types</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.11)"><span class="pre">tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Literal" title="(in Python v3.11)"><span class="pre">Literal</span></a><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'cells'</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Literal" title="(in Python v3.11)"><span class="pre">Literal</span></a><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'faces'</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Literal" title="(in Python v3.11)"><span class="pre">Literal</span></a><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'nodes'</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#porepy.numerics.ad.EquationSystem.admissible_dof_types" title="Permalink to this definition"></a></dt>
<dd><p>A set denoting admissible types of local DOFs for variables.</p>
<ul class="simple">
<li><p>nodes: DOFs per grid node.</p></li>
<li><p>cells: DOFs per grid cell.</p></li>
<li><p>faces: DOFS per grid face.</p></li>
</ul>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="porepy.numerics.ad.EquationSystem.assembled_equation_indices">
<span class="sig-name descname"><span class="pre">assembled_equation_indices</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.11)"><span class="pre">dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.24)"><span class="pre">numpy.ndarray</span></a><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#porepy.numerics.ad.EquationSystem.assembled_equation_indices" title="Permalink to this definition"></a></dt>
<dd><p>Contains the row indices in the last assembled (sub-) system for a given
equation name (key).</p>
<p>This dictionary changes with every call to any assemble-method.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="porepy.numerics.ad.EquationSystem.equations">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">equations</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.11)"><span class="pre">dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="porepy.numerics.ad.operators.html#porepy.numerics.ad.operators.Operator" title="porepy.numerics.ad.operators.Operator"><span class="pre">porepy.numerics.ad.operators.Operator</span></a><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#porepy.numerics.ad.EquationSystem.equations" title="Permalink to this definition"></a></dt>
<dd><p>Dictionary containing names of operators (keys) and operators (values), which
have been set as equations in this system.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="porepy.numerics.ad.EquationSystem.mdg">
<span class="sig-name descname"><span class="pre">mdg</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="porepy.grids.md_grid.html#porepy.grids.md_grid.MixedDimensionalGrid" title="porepy.grids.md_grid.MixedDimensionalGrid"><span class="pre">MixedDimensionalGrid</span></a></em><a class="headerlink" href="#porepy.numerics.ad.EquationSystem.mdg" title="Permalink to this definition"></a></dt>
<dd><p>Mixed-dimensional domain passed at instantiation.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="porepy.numerics.ad.EquationSystem.variable_domains">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">variable_domains</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.11)"><span class="pre">list</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.11)"><span class="pre">Union</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="porepy.grids.grid.html#porepy.grids.grid.Grid" title="porepy.grids.grid.Grid"><span class="pre">porepy.grids.grid.Grid</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="porepy.grids.mortar_grid.html#porepy.grids.mortar_grid.MortarGrid" title="porepy.grids.mortar_grid.MortarGrid"><span class="pre">porepy.grids.mortar_grid.MortarGrid</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#porepy.numerics.ad.EquationSystem.variable_domains" title="Permalink to this definition"></a></dt>
<dd><p>List containing all domains where at least one variable is defined.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="porepy.numerics.ad.EquationSystem.variables">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">variables</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.11)"><span class="pre">list</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="porepy.numerics.ad.operators.html#porepy.numerics.ad.operators.Variable" title="porepy.numerics.ad.operators.Variable"><span class="pre">porepy.numerics.ad.operators.Variable</span></a><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#porepy.numerics.ad.EquationSystem.variables" title="Permalink to this definition"></a></dt>
<dd><p>List containing all :class:<a href="#id1"><span class="problematic" id="id2">`</span></a>~porepy.numerics.ad.Variable`s known to this
system.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="porepy.numerics.ad.Function">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Function</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">func</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">array_compatible</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/porepy/numerics/ad/operator_functions.html#Function"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#porepy.numerics.ad.Function" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">AbstractFunction</span></code></p>
<p>Ad representation of an analytically given function,
where it is expected that passing Ad_arrays directly to <code class="docutils literal notranslate"><span class="pre">func</span></code> will
return the proper result.</p>
<p>Here the values <strong>and</strong> the Jacobian are obtained exactly by the AD framework.</p>
<p>The intended use is as a wrapper for operations on pp.ad.Ad_array objects,
in forms which are not directly or easily expressed by the rest of the Ad
framework.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This is a special case where the abstract methods for getting values and the
Jacobian are formally implemented but never used by the AD framework. A separate
operation called <code class="docutils literal notranslate"><span class="pre">evaluate</span></code> is implemented instead, which simply feeds the AD
arrays to <code class="docutils literal notranslate"><span class="pre">func</span></code>.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>func</strong> (<em>Callable</em>) – </p></li>
<li><p><strong>name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><em>str</em></a>) – </p></li>
<li><p><strong>array_compatible</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><em>bool</em></a>) – </p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="porepy.numerics.ad.Function.get_jacobian">
<span class="sig-name descname"><span class="pre">get_jacobian</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/porepy/numerics/ad/operator_functions.html#Function.get_jacobian"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#porepy.numerics.ad.Function.get_jacobian" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>args</strong> (<a class="reference internal" href="porepy.numerics.ad.forward_mode.html#porepy.numerics.ad.forward_mode.Ad_array" title="porepy.numerics.ad.forward_mode.Ad_array"><em>Ad_array</em></a>) – </p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.24)"><em>ndarray</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="porepy.numerics.ad.Function.get_values">
<span class="sig-name descname"><span class="pre">get_values</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/porepy/numerics/ad/operator_functions.html#Function.get_values"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#porepy.numerics.ad.Function.get_values" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>args</strong> (<a class="reference internal" href="porepy.numerics.ad.forward_mode.html#porepy.numerics.ad.forward_mode.Ad_array" title="porepy.numerics.ad.forward_mode.Ad_array"><em>Ad_array</em></a>) – </p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.24)"><em>ndarray</em></a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="porepy.numerics.ad.Geometry">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Geometry</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">subdomains</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nd</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">matrix_names</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/porepy/numerics/ad/grid_operators.html#Geometry"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#porepy.numerics.ad.Geometry" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="porepy.numerics.ad.operators.html#porepy.numerics.ad.operators.Operator" title="porepy.numerics.ad.operators.Operator"><code class="xref py py-class docutils literal notranslate"><span class="pre">Operator</span></code></a></p>
<p>Wrapper class for Ad representations of grids.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>subdomains</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.11)"><em>list</em></a><em>[</em><em>pp.Grid</em><em>]</em>) – </p></li>
<li><p><strong>nd</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a>) – </p></li>
<li><p><strong>name</strong> (<em>Optional</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><em>str</em></a><em>]</em>) – </p></li>
<li><p><strong>matrix_names</strong> (<em>Optional</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.11)"><em>list</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><em>str</em></a><em>]</em><em>]</em>) – </p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="porepy.numerics.ad.Geometry.cell_volumes">
<span class="sig-name descname"><span class="pre">cell_volumes</span></span><a class="headerlink" href="#porepy.numerics.ad.Geometry.cell_volumes" title="Permalink to this definition"></a></dt>
<dd><p>Diagonal ad matrix of cell volumes.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">pp.ad.Matrix</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="porepy.numerics.ad.Geometry.face_areas">
<span class="sig-name descname"><span class="pre">face_areas</span></span><a class="headerlink" href="#porepy.numerics.ad.Geometry.face_areas" title="Permalink to this definition"></a></dt>
<dd><p>Diagonal ad matrix of face areas.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">pp.ad.Matrix</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="porepy.numerics.ad.Geometry.nd">
<span class="sig-name descname"><span class="pre">nd</span></span><a class="headerlink" href="#porepy.numerics.ad.Geometry.nd" title="Permalink to this definition"></a></dt>
<dd><p>Ambient/highest dimension of the mixed-dimensional grid.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a></p>
</dd>
</dl>
</dd></dl>

<p>FIXME: Implement parse??</p>
<dl class="py method">
<dt class="sig sig-object py" id="porepy.numerics.ad.Geometry.basis">
<span class="sig-name descname"><span class="pre">basis</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/porepy/numerics/ad/grid_operators.html#Geometry.basis"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#porepy.numerics.ad.Geometry.basis" title="Permalink to this definition"></a></dt>
<dd><p>Return a cell-wise basis for all subdomains.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>dim</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int,</span> <span class="pre">optional</span></code>) – Dimension of the base. Defaults to the dimension of
the Geometry.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Array of dim pp.ad.Matrix, each of which is represents a basis function.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.11)">list</a>[<a class="reference internal" href="porepy.numerics.ad.operators.html#porepy.numerics.ad.operators.Matrix" title="porepy.numerics.ad.operators.Matrix">porepy.numerics.ad.operators.Matrix</a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="porepy.numerics.ad.Geometry.e_i">
<span class="sig-name descname"><span class="pre">e_i</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">i</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/porepy/numerics/ad/grid_operators.html#Geometry.e_i"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#porepy.numerics.ad.Geometry.e_i" title="Permalink to this definition"></a></dt>
<dd><p>Return a cell-wise basis function for all subdomains.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dim</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>) – Dimension of the functions.</p></li>
<li><p><strong>i</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>) – Index of the basis function. Note: Counts from 0.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><dl class="simple">
<dt>Ad representation of a matrix with the basis functions as</dt><dd><p>columns.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>pp.ad.Matrix</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="porepy.numerics.ad.GradPAd">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">GradPAd</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">keyword</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subdomains</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/porepy/numerics/ad/discretizations.html#GradPAd"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#porepy.numerics.ad.GradPAd" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="porepy.numerics.ad.discretizations.html#porepy.numerics.ad.discretizations.Discretization" title="porepy.numerics.ad.discretizations.Discretization"><code class="xref py py-class docutils literal notranslate"><span class="pre">Discretization</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>keyword</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><em>str</em></a>) – </p></li>
<li><p><strong>subdomains</strong> (<em>List</em><em>[</em><em>pp.Grid</em><em>]</em>) – </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="porepy.numerics.ad.InterpolatedFunction">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">InterpolatedFunction</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">func</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_val</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_val</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">npt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">preval</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">array_compatible</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/porepy/numerics/ad/operator_functions.html#InterpolatedFunction"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#porepy.numerics.ad.InterpolatedFunction" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">AbstractFunction</span></code></p>
<p>Represents the passed function as an interpolation of chosen order on a cartesian,
uniform grid.</p>
<p>The image of the function is expected to be of dimension 1, while the domain can be
multidimensional.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All vector-valued ndarray arguments are assumed to be column vectors.
Each row-entry represents a value for an argument of <code class="docutils literal notranslate"><span class="pre">func</span></code> in
respective order.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>min_val</strong> (<em>np.ndarray</em>) – lower bounds for the domain of <code class="docutils literal notranslate"><span class="pre">func</span></code>.</p></li>
<li><p><strong>max_val</strong> (<em>np.ndarray</em>) – upper bound for the domain.</p></li>
<li><p><strong>npt</strong> (<em>np.ndarray</em>) – number of interpolation points per dimension of the domain.</p></li>
<li><p><strong>order</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a>) – Order of interpolation. Supports currently only linear order.</p></li>
<li><p><strong>preval</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">optional</span></code>) – If True, pre-evaluates the values of the function at
the points of interpolation and stores them.
If False, evaluates them if necessary.
Influences the runtime.
Defaults to False.</p></li>
<li><p><strong>func</strong> (<em>Callable</em>) – </p></li>
<li><p><strong>name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><em>str</em></a>) – </p></li>
<li><p><strong>array_compatible</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><em>bool</em></a>) – </p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="porepy.numerics.ad.InterpolatedFunction.get_jacobian">
<span class="sig-name descname"><span class="pre">get_jacobian</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/porepy/numerics/ad/operator_functions.html#InterpolatedFunction.get_jacobian"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#porepy.numerics.ad.InterpolatedFunction.get_jacobian" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>args</strong> (<a class="reference internal" href="porepy.numerics.ad.forward_mode.html#porepy.numerics.ad.forward_mode.Ad_array" title="porepy.numerics.ad.forward_mode.Ad_array"><em>Ad_array</em></a>) – </p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.sparse.spmatrix.html#scipy.sparse.spmatrix" title="(in SciPy v1.10.0)"><em>spmatrix</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="porepy.numerics.ad.InterpolatedFunction.get_values">
<span class="sig-name descname"><span class="pre">get_values</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/porepy/numerics/ad/operator_functions.html#InterpolatedFunction.get_values"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#porepy.numerics.ad.InterpolatedFunction.get_values" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>args</strong> (<a class="reference internal" href="porepy.numerics.ad.forward_mode.html#porepy.numerics.ad.forward_mode.Ad_array" title="porepy.numerics.ad.forward_mode.Ad_array"><em>Ad_array</em></a>) – </p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.24)"><em>ndarray</em></a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="porepy.numerics.ad.MassMatrixAd">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">MassMatrixAd</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">keyword</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subdomains</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/porepy/numerics/ad/discretizations.html#MassMatrixAd"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#porepy.numerics.ad.MassMatrixAd" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="porepy.numerics.ad.discretizations.html#porepy.numerics.ad.discretizations.Discretization" title="porepy.numerics.ad.discretizations.Discretization"><code class="xref py py-class docutils literal notranslate"><span class="pre">Discretization</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>keyword</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><em>str</em></a>) – </p></li>
<li><p><strong>subdomains</strong> (<em>List</em><em>[</em><em>pp.Grid</em><em>]</em>) – </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="porepy.numerics.ad.Matrix">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Matrix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/porepy/numerics/ad/operators.html#Matrix"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#porepy.numerics.ad.Matrix" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="porepy.numerics.ad.operators.html#porepy.numerics.ad.operators.Operator" title="porepy.numerics.ad.operators.Operator"><code class="xref py py-class docutils literal notranslate"><span class="pre">Operator</span></code></a></p>
<p>Ad representation of a sparse matrix.</p>
<p>For dense matrices, use <a class="reference internal" href="#porepy.numerics.ad.Array" title="porepy.numerics.ad.Array"><code class="xref py py-class docutils literal notranslate"><span class="pre">Array</span></code></a> instead.</p>
<p>This is a shallow wrapper around the real matrix; it is needed to combine the matrix
with other types of Ad objects.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mat</strong> (<em>sps.spmatrix</em>) – Sparse matrix to be wrapped as an AD operator.</p></li>
<li><p><strong>name</strong> (<em>Optional</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><em>str</em></a><em>]</em>) – Name of this operator</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="porepy.numerics.ad.Matrix.parse">
<span class="sig-name descname"><span class="pre">parse</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mdg</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/porepy/numerics/ad/operators.html#Matrix.parse"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#porepy.numerics.ad.Matrix.parse" title="Permalink to this definition"></a></dt>
<dd><p>See <a class="reference internal" href="#porepy.numerics.ad.Operator.parse" title="porepy.numerics.ad.Operator.parse"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Operator.parse()</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The wrapped matrix.</p>
</dd>
<dt class="field-even">Parameters</dt>
<dd class="field-even"><p><strong>mdg</strong> (<a class="reference internal" href="porepy.grids.md_grid.html#porepy.grids.md_grid.MixedDimensionalGrid" title="porepy.grids.md_grid.MixedDimensionalGrid"><em>MixedDimensionalGrid</em></a>) – </p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.sparse.spmatrix.html#scipy.sparse.spmatrix" title="(in SciPy v1.10.0)"><em>spmatrix</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="porepy.numerics.ad.Matrix.transpose">
<span class="sig-name descname"><span class="pre">transpose</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/porepy/numerics/ad/operators.html#Matrix.transpose"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#porepy.numerics.ad.Matrix.transpose" title="Permalink to this definition"></a></dt>
<dd><p>Returns an AD operator representing the transposed matrix.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="porepy.numerics.ad.operators.html#porepy.numerics.ad.operators.Matrix" title="porepy.numerics.ad.operators.Matrix"><em>Matrix</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="porepy.numerics.ad.Matrix.T">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">T</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="porepy.numerics.ad.operators.html#porepy.numerics.ad.operators.Matrix" title="porepy.numerics.ad.operators.Matrix"><span class="pre">Matrix</span></a></em><a class="headerlink" href="#porepy.numerics.ad.Matrix.T" title="Permalink to this definition"></a></dt>
<dd><p>Shorthand for transpose.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="porepy.numerics.ad.Matrix.shape">
<span class="sig-name descname"><span class="pre">shape</span></span><a class="headerlink" href="#porepy.numerics.ad.Matrix.shape" title="Permalink to this definition"></a></dt>
<dd><p>Shape of the wrapped matrix.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="porepy.numerics.ad.MixedDimensionalVariable">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">MixedDimensionalVariable</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">variables</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/porepy/numerics/ad/operators.html#MixedDimensionalVariable"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#porepy.numerics.ad.MixedDimensionalVariable" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="porepy.numerics.ad.operators.html#porepy.numerics.ad.operators.Variable" title="porepy.numerics.ad.operators.Variable"><code class="xref py py-class docutils literal notranslate"><span class="pre">Variable</span></code></a></p>
<p>Ad representation of a collection of variables that individually live on separate
subdomains or interfaces, but treated jointly in the mixed-dimensional sense.</p>
<p>Conversion of the variables into numerical value should be done with respect to the
state of an array; see <a class="reference internal" href="#porepy.numerics.ad.Operator.evaluate" title="porepy.numerics.ad.Operator.evaluate"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Operator.evaluate()</span></code></a>. Therefore, the MergedVariable does
not implement the method <a class="reference internal" href="#porepy.numerics.ad.Operator.parse" title="porepy.numerics.ad.Operator.parse"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Operator.parse()</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>variables</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.11)"><em>list</em></a><em>[</em><a class="reference internal" href="#porepy.numerics.ad.Variable" title="porepy.numerics.ad.Variable"><em>Variable</em></a><em>]</em>) – List of variables to be merged. Should all have the same name.</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="porepy.numerics.ad.MixedDimensionalVariable.copy">
<span class="sig-name descname"><span class="pre">copy</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/porepy/numerics/ad/operators.html#MixedDimensionalVariable.copy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#porepy.numerics.ad.MixedDimensionalVariable.copy" title="Permalink to this definition"></a></dt>
<dd><p>Copy the mixed-dimensional variable.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>A shallow copy should be sufficient here; the attributes are not expected to
change.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference internal" href="porepy.numerics.ad.operators.html#porepy.numerics.ad.operators.MixedDimensionalVariable" title="porepy.numerics.ad.operators.MixedDimensionalVariable"><em>MixedDimensionalVariable</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="porepy.numerics.ad.MixedDimensionalVariable.copy_common_sub_tags">
<span class="sig-name descname"><span class="pre">copy_common_sub_tags</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/porepy/numerics/ad/operators.html#MixedDimensionalVariable.copy_common_sub_tags"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#porepy.numerics.ad.MixedDimensionalVariable.copy_common_sub_tags" title="Permalink to this definition"></a></dt>
<dd><p>Copy any shared tags from the sub variables to this variable.</p>
<p>Only tags with identical values are copied. Thus, the md variable can “trust” that
its tags are consistent with all sub variables.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="porepy.numerics.ad.MixedDimensionalVariable.previous_iteration">
<span class="sig-name descname"><span class="pre">previous_iteration</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/porepy/numerics/ad/operators.html#MixedDimensionalVariable.previous_iteration"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#porepy.numerics.ad.MixedDimensionalVariable.previous_iteration" title="Permalink to this definition"></a></dt>
<dd><p>Return a representation of this mixed-dimensional variable on the previous
iteration.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>A representation of this merged variable on the previous
iteration, with its <code class="docutils literal notranslate"><span class="pre">prev_iter</span></code> attribute set to <code class="docutils literal notranslate"><span class="pre">True</span></code></p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference internal" href="porepy.numerics.ad.operators.html#porepy.numerics.ad.operators.MixedDimensionalVariable" title="porepy.numerics.ad.operators.MixedDimensionalVariable"><em>MixedDimensionalVariable</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="porepy.numerics.ad.MixedDimensionalVariable.previous_timestep">
<span class="sig-name descname"><span class="pre">previous_timestep</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/porepy/numerics/ad/operators.html#MixedDimensionalVariable.previous_timestep"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#porepy.numerics.ad.MixedDimensionalVariable.previous_timestep" title="Permalink to this definition"></a></dt>
<dd><p>Return a representation of this mixed-dimensional variable on the previous
time step.</p>
<p>If the md-variable is already defined on the previous time step, return itself.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>A representation of this merged variable on the previous time
iteration, with its <code class="docutils literal notranslate"><span class="pre">prev_iter</span></code> attribute set to <code class="docutils literal notranslate"><span class="pre">True</span></code>.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference internal" href="porepy.numerics.ad.operators.html#porepy.numerics.ad.operators.MixedDimensionalVariable" title="porepy.numerics.ad.operators.MixedDimensionalVariable"><em>MixedDimensionalVariable</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="porepy.numerics.ad.MixedDimensionalVariable.size">
<span class="sig-name descname"><span class="pre">size</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/porepy/numerics/ad/operators.html#MixedDimensionalVariable.size"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#porepy.numerics.ad.MixedDimensionalVariable.size" title="Permalink to this definition"></a></dt>
<dd><p>Returns the total size of the mixed-dimensional variable
by summing the sizes of sub-variables.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)">int</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="porepy.numerics.ad.MixedDimensionalVariable.domain">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">domain</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.11)"><span class="pre">list</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.11)"><span class="pre">Union</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="porepy.grids.grid.html#porepy.grids.grid.Grid" title="porepy.grids.grid.Grid"><span class="pre">porepy.grids.grid.Grid</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="porepy.grids.mortar_grid.html#porepy.grids.mortar_grid.MortarGrid" title="porepy.grids.mortar_grid.MortarGrid"><span class="pre">porepy.grids.mortar_grid.MortarGrid</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#porepy.numerics.ad.MixedDimensionalVariable.domain" title="Permalink to this definition"></a></dt>
<dd><p>A tuple of all domains on which the atomic sub-variables are defined.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="porepy.numerics.ad.MixedDimensionalVariable.id">
<span class="sig-name descname"><span class="pre">id</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><span class="pre">int</span></a></em><a class="headerlink" href="#porepy.numerics.ad.MixedDimensionalVariable.id" title="Permalink to this definition"></a></dt>
<dd><p>ID counter. Used to identify variables during operator parsing.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="porepy.numerics.ad.MixedDimensionalVariable.original_variable">
<span class="sig-name descname"><span class="pre">original_variable</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="porepy.numerics.ad.operators.html#porepy.numerics.ad.operators.MixedDimensionalVariable" title="porepy.numerics.ad.operators.MixedDimensionalVariable"><span class="pre">MixedDimensionalVariable</span></a></em><a class="headerlink" href="#porepy.numerics.ad.MixedDimensionalVariable.original_variable" title="Permalink to this definition"></a></dt>
<dd><p>The original variable, if this variable is a copy of another variable.</p>
<p>This attribute is used by the methods <a class="reference internal" href="#porepy.numerics.ad.Variable.previous_timestep" title="porepy.numerics.ad.Variable.previous_timestep"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Variable.previous_timestep()</span></code></a> and
<a class="reference internal" href="#porepy.numerics.ad.Variable.previous_iteration" title="porepy.numerics.ad.Variable.previous_iteration"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Variable.previous_iteration()</span></code></a> to keep a link to the original variable.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="porepy.numerics.ad.MixedDimensionalVariable.prev_iter">
<span class="sig-name descname"><span class="pre">prev_iter</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><span class="pre">bool</span></a></em><a class="headerlink" href="#porepy.numerics.ad.MixedDimensionalVariable.prev_iter" title="Permalink to this definition"></a></dt>
<dd><p>Flag indicating if the variable represents the state at the previous iteration.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="porepy.numerics.ad.MixedDimensionalVariable.prev_time">
<span class="sig-name descname"><span class="pre">prev_time</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><span class="pre">bool</span></a></em><a class="headerlink" href="#porepy.numerics.ad.MixedDimensionalVariable.prev_time" title="Permalink to this definition"></a></dt>
<dd><p>Flag indicating if the variable represents the state at the previous time step.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="porepy.numerics.ad.MixedDimensionalVariable.sub_vars">
<span class="sig-name descname"><span class="pre">sub_vars</span></span><a class="headerlink" href="#porepy.numerics.ad.MixedDimensionalVariable.sub_vars" title="Permalink to this definition"></a></dt>
<dd><p>List of sub-variables passed at instantiation, each defined on a separate
domain.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="porepy.numerics.ad.MortarProjections">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">MortarProjections</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mdg</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subdomains</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interfaces</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/porepy/numerics/ad/grid_operators.html#MortarProjections"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#porepy.numerics.ad.MortarProjections" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="porepy.numerics.ad.operators.html#porepy.numerics.ad.operators.Operator" title="porepy.numerics.ad.operators.Operator"><code class="xref py py-class docutils literal notranslate"><span class="pre">Operator</span></code></a></p>
<p>Wrapper class to generate projections to and from MortarGrids.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mdg</strong> (<em>pp.MixedDimensionalGrid</em>) – </p></li>
<li><p><strong>subdomains</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.11)"><em>list</em></a><em>[</em><em>pp.Grid</em><em>]</em>) – </p></li>
<li><p><strong>interfaces</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.11)"><em>list</em></a><em>[</em><em>pp.MortarGrid</em><em>]</em>) – </p></li>
<li><p><strong>dim</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a>) – </p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="porepy.numerics.ad.MortarProjections.mortar_to_primary_int">
<span class="sig-name descname"><span class="pre">mortar_to_primary_int</span></span><a class="headerlink" href="#porepy.numerics.ad.MortarProjections.mortar_to_primary_int" title="Permalink to this definition"></a></dt>
<dd><p>Matrix of projections from the mortar
grid to the primary grid. Intended for extensive quantities (so fluxes).
Represented as an Ad Matrix operator.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">pp.ad.Matrix</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="porepy.numerics.ad.MortarProjections.mortar_to_primary_avg">
<span class="sig-name descname"><span class="pre">mortar_to_primary_avg</span></span><a class="headerlink" href="#porepy.numerics.ad.MortarProjections.mortar_to_primary_avg" title="Permalink to this definition"></a></dt>
<dd><p>Matrix of projections from the mortar
grid to the primary grid. Intended for intensive quantities (so pressures).
Represented as an Ad Matrix operator.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">pp.ad.Matrix</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="porepy.numerics.ad.MortarProjections.primary_to_mortar_int">
<span class="sig-name descname"><span class="pre">primary_to_mortar_int</span></span><a class="headerlink" href="#porepy.numerics.ad.MortarProjections.primary_to_mortar_int" title="Permalink to this definition"></a></dt>
<dd><p>Matrix of projections from the primary
grid to the mortar grid. Intended for extensive quantities (so fluxes).
Represented as an Ad Matrix operator.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">pp.ad.Matrix</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="porepy.numerics.ad.MortarProjections.primary_to_mortar_avg">
<span class="sig-name descname"><span class="pre">primary_to_mortar_avg</span></span><a class="headerlink" href="#porepy.numerics.ad.MortarProjections.primary_to_mortar_avg" title="Permalink to this definition"></a></dt>
<dd><p>Matrix of projections from the primary
grid to the mortar grid. Intended for intensive quantities (so pressures).
Represented as an Ad Matrix operator.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">pp.ad.Matrix</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="porepy.numerics.ad.MortarProjections.mortar_to_secondary_int">
<span class="sig-name descname"><span class="pre">mortar_to_secondary_int</span></span><a class="headerlink" href="#porepy.numerics.ad.MortarProjections.mortar_to_secondary_int" title="Permalink to this definition"></a></dt>
<dd><p>Matrix of projections from the mortar
grid to the secondary grid. Intended for extensive quantities (so fluxes).
Represented as an Ad Matrix operator.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">pp.ad.Matrix</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="porepy.numerics.ad.MortarProjections.mortar_to_secondary_avg">
<span class="sig-name descname"><span class="pre">mortar_to_secondary_avg</span></span><a class="headerlink" href="#porepy.numerics.ad.MortarProjections.mortar_to_secondary_avg" title="Permalink to this definition"></a></dt>
<dd><p>Matrix of projections from the mortar
grid to the secondary grid. Intended for intensive quantities (so pressures).
Represented as an Ad Matrix operator.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">pp.ad.Matrix</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="porepy.numerics.ad.MortarProjections.secondary_to_mortar_int">
<span class="sig-name descname"><span class="pre">secondary_to_mortar_int</span></span><a class="headerlink" href="#porepy.numerics.ad.MortarProjections.secondary_to_mortar_int" title="Permalink to this definition"></a></dt>
<dd><p>Matrix of projections from the secondary
grid to the mortar grid. Intended for extensive quantities (so fluxes).
Represented as an Ad Matrix operator.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">pp.ad.Matrix</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="porepy.numerics.ad.MortarProjections.secondary_to_mortar_avg">
<span class="sig-name descname"><span class="pre">secondary_to_mortar_avg</span></span><a class="headerlink" href="#porepy.numerics.ad.MortarProjections.secondary_to_mortar_avg" title="Permalink to this definition"></a></dt>
<dd><p>Matrix of projections from the secondary
grid to the mortar grid. Intended for intensive quantities (so pressures).
Represented as an Ad Matrix operator.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">pp.ad.Matrix</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="porepy.numerics.ad.MortarProjections.sign_of_mortar_sides">
<span class="sig-name descname"><span class="pre">sign_of_mortar_sides</span></span><a class="headerlink" href="#porepy.numerics.ad.MortarProjections.sign_of_mortar_sides" title="Permalink to this definition"></a></dt>
<dd><p>Matrix representation that assigns signs
to two mortar sides. Needed to implement a jump operator in contact
mechanics.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">pp.Ad.Matrix</span></code></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="porepy.numerics.ad.MpfaAd">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">MpfaAd</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">keyword</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subdomains</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/porepy/numerics/ad/discretizations.html#MpfaAd"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#porepy.numerics.ad.MpfaAd" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="porepy.numerics.ad.discretizations.html#porepy.numerics.ad.discretizations.Discretization" title="porepy.numerics.ad.discretizations.Discretization"><code class="xref py py-class docutils literal notranslate"><span class="pre">Discretization</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>keyword</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><em>str</em></a>) – </p></li>
<li><p><strong>subdomains</strong> (<em>List</em><em>[</em><em>pp.Grid</em><em>]</em>) – </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="porepy.numerics.ad.MpsaAd">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">MpsaAd</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">keyword</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subdomains</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/porepy/numerics/ad/discretizations.html#MpsaAd"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#porepy.numerics.ad.MpsaAd" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="porepy.numerics.ad.discretizations.html#porepy.numerics.ad.discretizations.Discretization" title="porepy.numerics.ad.discretizations.Discretization"><code class="xref py py-class docutils literal notranslate"><span class="pre">Discretization</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>keyword</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><em>str</em></a>) – </p></li>
<li><p><strong>subdomains</strong> (<em>List</em><em>[</em><em>pp.Grid</em><em>]</em>) – </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="porepy.numerics.ad.Operator">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Operator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subdomains</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interfaces</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tree</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/porepy/numerics/ad/operators.html#Operator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#porepy.numerics.ad.Operator" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Parent class for all AD operators.</p>
<p>Objects of this class are not meant to be initiated directly, rather the various
subclasses should be used. Instances of this class will still be created when
subclasses are combined by Operator.Operations.</p>
<p>Contains a tree structure of child operators for the recursive forward evaluation.</p>
<p>Provides overload functions for basic arithmetic operations.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> (<em>Optional</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><em>str</em></a><em>]</em>) – Name of this operator. Used for string representations</p></li>
<li><p><strong>subdomains</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">optional</span></code>) – List of subdomains on which the operator is defined.
Will be empty for operators not associated with any subdomains.
Defaults to None (converted to empty list).</p></li>
<li><p><strong>interfaces</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">optional</span></code>) – List of interfaces in the mixed-dimensional grid on which the
operator is defined.
Will be empty for operators not associated with any interface.
Defaults to None (converted to empty list).</p></li>
<li><p><strong>tree</strong> (<em>Optional</em><em>[</em><em>Tree</em><em>]</em>) – </p></li>
</ul>
</dd>
</dl>
<dl class="py class">
<dt class="sig sig-object py" id="porepy.numerics.ad.Operator.Operations">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Operations</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#porepy.numerics.ad.Operator.Operations" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/enum.html#enum.Enum" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Enum</span></code></a></p>
<p>Object representing all supported operations by the operator class.</p>
<p>Used to construct the operator tree and identify Operator.Operations.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="porepy.numerics.ad.Operator.Operations.add">
<span class="sig-name descname"><span class="pre">add</span></span><a class="headerlink" href="#porepy.numerics.ad.Operator.Operations.add" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="porepy.numerics.ad.Operator.Operations.approximate">
<span class="sig-name descname"><span class="pre">approximate</span></span><a class="headerlink" href="#porepy.numerics.ad.Operator.Operations.approximate" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="porepy.numerics.ad.Operator.Operations.div">
<span class="sig-name descname"><span class="pre">div</span></span><a class="headerlink" href="#porepy.numerics.ad.Operator.Operations.div" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="porepy.numerics.ad.Operator.Operations.evaluate">
<span class="sig-name descname"><span class="pre">evaluate</span></span><a class="headerlink" href="#porepy.numerics.ad.Operator.Operations.evaluate" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="porepy.numerics.ad.Operator.Operations.mul">
<span class="sig-name descname"><span class="pre">mul</span></span><a class="headerlink" href="#porepy.numerics.ad.Operator.Operations.mul" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="porepy.numerics.ad.Operator.Operations.pow">
<span class="sig-name descname"><span class="pre">pow</span></span><a class="headerlink" href="#porepy.numerics.ad.Operator.Operations.pow" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="porepy.numerics.ad.Operator.Operations.sub">
<span class="sig-name descname"><span class="pre">sub</span></span><a class="headerlink" href="#porepy.numerics.ad.Operator.Operations.sub" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="porepy.numerics.ad.Operator.Operations.void">
<span class="sig-name descname"><span class="pre">void</span></span><a class="headerlink" href="#porepy.numerics.ad.Operator.Operations.void" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="porepy.numerics.ad.Operator.discretize">
<span class="sig-name descname"><span class="pre">discretize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mdg</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/porepy/numerics/ad/operators.html#Operator.discretize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#porepy.numerics.ad.Operator.discretize" title="Permalink to this definition"></a></dt>
<dd><p>Perform discretization operation on all discretizations identified in
the tree of this operator, using data from mdg.</p>
<p>IMPLEMENTATION NOTE: The discretizations was identified at initialization of
Expression - it is now done here to accommodate updates (?) and</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>mdg</strong> (<a class="reference internal" href="porepy.grids.md_grid.html#porepy.grids.md_grid.MixedDimensionalGrid" title="porepy.grids.md_grid.MixedDimensionalGrid"><em>MixedDimensionalGrid</em></a>) – </p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="porepy.numerics.ad.Operator.evaluate">
<span class="sig-name descname"><span class="pre">evaluate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">system_manager</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/porepy/numerics/ad/operators.html#Operator.evaluate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#porepy.numerics.ad.Operator.evaluate" title="Permalink to this definition"></a></dt>
<dd><p>Evaluate the residual and Jacobian matrix for a given state.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>system_manager</strong> (<em>pp.ad.EquationSystem</em><em> | </em><em>pp.DofManager</em>) – Used to represent the problem. Will be used
to parse the sub-operators that combine to form this operator.</p></li>
<li><p><strong>state</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">optional</span></code>) – State vector for which the residual and its
derivatives should be formed. If not provided, the state will be pulled from
the previous iterate (if this exists), or alternatively from the state
at the previous time step.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A representation of the residual and Jacobian in form of an AD Array.
Note that the Jacobian matrix need not be invertible, or even square;
this depends on the operator.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="porepy.numerics.ad.Operator.is_leaf">
<span class="sig-name descname"><span class="pre">is_leaf</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/porepy/numerics/ad/operators.html#Operator.is_leaf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#porepy.numerics.ad.Operator.is_leaf" title="Permalink to this definition"></a></dt>
<dd><p>Check if this operator is a leaf in the tree-representation of an expression.</p>
<p>Note that this implies that the method <code class="docutils literal notranslate"><span class="pre">parse()</span></code> is expected to be implemented.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>True if the operator has no children.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)">bool</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="porepy.numerics.ad.Operator.parse">
<span class="sig-name descname"><span class="pre">parse</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mdg</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/porepy/numerics/ad/operators.html#Operator.parse"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#porepy.numerics.ad.Operator.parse" title="Permalink to this definition"></a></dt>
<dd><p>Translate the operator into a numerical expression.</p>
<p>Subclasses that represent atomic operators (leaves in a tree-representation of
an operator) should override this method to return e.g. a number, an array or a
matrix.
This method should not be called on operators that are formed as combinations
of atomic operators; such operators should be evaluated by the method <a class="reference internal" href="#porepy.numerics.ad.Operator.evaluate" title="porepy.numerics.ad.Operator.evaluate"><code class="xref py py-meth docutils literal notranslate"><span class="pre">evaluate()</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>mdg</strong> (<a class="reference internal" href="porepy.grids.md_grid.html#porepy.grids.md_grid.MixedDimensionalGrid" title="porepy.grids.md_grid.MixedDimensionalGrid"><em>MixedDimensionalGrid</em></a>) – Mixed-dimensional grid on which this operator is to be parsed.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A numerical format representing this operator;s values on given domain.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.11)"><em>Any</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="porepy.numerics.ad.Operator.previous_timestep">
<span class="sig-name descname"><span class="pre">previous_timestep</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/porepy/numerics/ad/operators.html#Operator.previous_timestep"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#porepy.numerics.ad.Operator.previous_timestep" title="Permalink to this definition"></a></dt>
<dd><p>Return an operator that represents the value of this operator at the previous
timestep.</p>
<p>The operator tree at the previous time step is created as a shallow copy, and will
thus be identical to the original operator, except that all time dependent operators
are evaluated at the previous time step.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>A copy of self, with all time dependent operators evaluated at the previous
time step.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference internal" href="porepy.numerics.ad.operators.html#porepy.numerics.ad.operators.Operator" title="porepy.numerics.ad.operators.Operator"><em>Operator</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="porepy.numerics.ad.Operator.set_name">
<span class="sig-name descname"><span class="pre">set_name</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/porepy/numerics/ad/operators.html#Operator.set_name"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#porepy.numerics.ad.Operator.set_name" title="Permalink to this definition"></a></dt>
<dd><p>Reset this object’s name originally passed at instantiation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><em>str</em></a>) – the new name to be assigned.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="porepy.numerics.ad.Operator.viz">
<span class="sig-name descname"><span class="pre">viz</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/porepy/numerics/ad/operators.html#Operator.viz"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#porepy.numerics.ad.Operator.viz" title="Permalink to this definition"></a></dt>
<dd><p>Draws a visualization of the operator tree that has this operator as its root.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="porepy.numerics.ad.Operator.interfaces">
<span class="sig-name descname"><span class="pre">interfaces</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.11)"><span class="pre">list</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="porepy.grids.mortar_grid.html#porepy.grids.mortar_grid.MortarGrid" title="porepy.grids.mortar_grid.MortarGrid"><span class="pre">porepy.grids.mortar_grid.MortarGrid</span></a><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#porepy.numerics.ad.Operator.interfaces" title="Permalink to this definition"></a></dt>
<dd><p>List of interfaces on which the operator is defined, passed at instantiation.</p>
<p>Will be empty for operators not associated with specific interfaces.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="porepy.numerics.ad.Operator.name">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">name</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><span class="pre">str</span></a></em><a class="headerlink" href="#porepy.numerics.ad.Operator.name" title="Permalink to this definition"></a></dt>
<dd><p>The name given to this variable.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="porepy.numerics.ad.Operator.subdomains">
<span class="sig-name descname"><span class="pre">subdomains</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.11)"><span class="pre">list</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="porepy.grids.grid.html#porepy.grids.grid.Grid" title="porepy.grids.grid.Grid"><span class="pre">porepy.grids.grid.Grid</span></a><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#porepy.numerics.ad.Operator.subdomains" title="Permalink to this definition"></a></dt>
<dd><p>List of subdomains on which the operator is defined, passed at instantiation.</p>
<p>Will be empty for operators not associated with specific subdomains.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="porepy.numerics.ad.ParameterArray">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ParameterArray</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">param_keyword</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">array_keyword</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subdomains</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interfaces</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/porepy/numerics/ad/grid_operators.html#ParameterArray"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#porepy.numerics.ad.ParameterArray" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="porepy.numerics.ad.operators.html#porepy.numerics.ad.operators.Operator" title="porepy.numerics.ad.operators.Operator"><code class="xref py py-class docutils literal notranslate"><span class="pre">Operator</span></code></a></p>
<p>Extract an array from the parameter dictionaries for a given set of subdomains.</p>
<p>Can be used to implement sources, and general arrays to be picked from the
parameter array (and thereby could be changed during the simulation, without
having to redefine the abstract Ad representation of the equations).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>param_keyword</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><em>str</em></a>) – </p></li>
<li><p><strong>array_keyword</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><em>str</em></a>) – </p></li>
<li><p><strong>subdomains</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.11)"><em>list</em></a><em>[</em><a class="reference internal" href="porepy.grids.grid.html#porepy.grids.grid.Grid" title="porepy.grids.grid.Grid"><em>porepy.grids.grid.Grid</em></a><em>]</em>) – </p></li>
<li><p><strong>interfaces</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.11)"><em>list</em></a><em>[</em><a class="reference internal" href="porepy.grids.mortar_grid.html#porepy.grids.mortar_grid.MortarGrid" title="porepy.grids.mortar_grid.MortarGrid"><em>porepy.grids.mortar_grid.MortarGrid</em></a><em>]</em>) – </p></li>
<li><p><strong>name</strong> (<em>Optional</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><em>str</em></a><em>]</em>) – </p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="porepy.numerics.ad.ParameterArray.parse">
<span class="sig-name descname"><span class="pre">parse</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mdg</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/porepy/numerics/ad/grid_operators.html#ParameterArray.parse"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#porepy.numerics.ad.ParameterArray.parse" title="Permalink to this definition"></a></dt>
<dd><p>Convert the Ad expression into numerical values for the scalar sources,
in the form of an np.ndarray concatenated for all subdomains.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>mdg</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">pp.MixedDimensionalGrid</span></code>) – Mixed-dimensional grid. The boundary condition
will be taken from the data dictionaries with the relevant keyword.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Value of boundary conditions.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="porepy.numerics.ad.ParameterArray.interfaces">
<span class="sig-name descname"><span class="pre">interfaces</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.11)"><span class="pre">list</span></a><span class="p"><span class="pre">[</span></span><span class="pre">pp.MortarGrid</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#porepy.numerics.ad.ParameterArray.interfaces" title="Permalink to this definition"></a></dt>
<dd><p>List of interfaces on which the operator is defined, passed at instantiation.</p>
<p>Will be empty for operators not associated with specific interfaces.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="porepy.numerics.ad.ParameterArray.subdomains">
<span class="sig-name descname"><span class="pre">subdomains</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.11)"><span class="pre">list</span></a><span class="p"><span class="pre">[</span></span><span class="pre">pp.Grid</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#porepy.numerics.ad.ParameterArray.subdomains" title="Permalink to this definition"></a></dt>
<dd><p>List of subdomains on which the operator is defined, passed at instantiation.</p>
<p>Will be empty for operators not associated with specific subdomains.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="porepy.numerics.ad.ParameterMatrix">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ParameterMatrix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">param_keyword</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">array_keyword</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subdomains</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interfaces</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/porepy/numerics/ad/grid_operators.html#ParameterMatrix"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#porepy.numerics.ad.ParameterMatrix" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="porepy.numerics.ad.grid_operators.html#porepy.numerics.ad.grid_operators.ParameterArray" title="porepy.numerics.ad.grid_operators.ParameterArray"><code class="xref py py-class docutils literal notranslate"><span class="pre">ParameterArray</span></code></a></p>
<p>Extract a matrix from the parameter dictionaries for a given set of subdomains.</p>
<dl class="simple">
<dt>Typical use: Parameters which are left multiplied with an ad expression. Note that</dt><dd><p>array parameters are represented by one diagonal matrix for each grid.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>param_keyword</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><em>str</em></a>) – </p></li>
<li><p><strong>array_keyword</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><em>str</em></a>) – </p></li>
<li><p><strong>subdomains</strong> (<em>Optional</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.11)"><em>list</em></a><em>[</em><em>pp.Grid</em><em>]</em><em>]</em>) – </p></li>
<li><p><strong>interfaces</strong> (<em>Optional</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.11)"><em>list</em></a><em>[</em><em>pp.MortarGrid</em><em>]</em><em>]</em>) – </p></li>
<li><p><strong>name</strong> (<em>Optional</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><em>str</em></a><em>]</em>) – </p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="porepy.numerics.ad.ParameterMatrix.parse">
<span class="sig-name descname"><span class="pre">parse</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mdg</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/porepy/numerics/ad/grid_operators.html#ParameterMatrix.parse"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#porepy.numerics.ad.ParameterMatrix.parse" title="Permalink to this definition"></a></dt>
<dd><p>Convert the Ad expression into numerical values for the scalar sources,
in the form of an np.ndarray concatenated for all subdomains.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>mdg</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">pp.MixedDimensionalGrid</span></code>) – Mixed-dimensional grid. The boundary condition
will be taken from the data dictionaries with the relevant keyword.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Value of boundary conditions.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>sps.spmatrix</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="porepy.numerics.ad.ParameterMatrix.interfaces">
<span class="sig-name descname"><span class="pre">interfaces</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.11)"><span class="pre">list</span></a><span class="p"><span class="pre">[</span></span><span class="pre">pp.MortarGrid</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#porepy.numerics.ad.ParameterMatrix.interfaces" title="Permalink to this definition"></a></dt>
<dd><p>List of interfaces on which the operator is defined, passed at instantiation.</p>
<p>Will be empty for operators not associated with specific interfaces.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="porepy.numerics.ad.ParameterMatrix.subdomains">
<span class="sig-name descname"><span class="pre">subdomains</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.11)"><span class="pre">list</span></a><span class="p"><span class="pre">[</span></span><span class="pre">pp.Grid</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#porepy.numerics.ad.ParameterMatrix.subdomains" title="Permalink to this definition"></a></dt>
<dd><p>List of subdomains on which the operator is defined, passed at instantiation.</p>
<p>Will be empty for operators not associated with specific subdomains.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="porepy.numerics.ad.RegularizedHeaviside">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">RegularizedHeaviside</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">regularization</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/porepy/numerics/ad/functions.html#RegularizedHeaviside"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#porepy.numerics.ad.RegularizedHeaviside" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>regularization</strong> (<em>Callable</em>) – </p>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="porepy.numerics.ad.RobinCouplingAd">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">RobinCouplingAd</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">keyword</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interfaces</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/porepy/numerics/ad/discretizations.html#RobinCouplingAd"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#porepy.numerics.ad.RobinCouplingAd" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="porepy.numerics.ad.discretizations.html#porepy.numerics.ad.discretizations.Discretization" title="porepy.numerics.ad.discretizations.Discretization"><code class="xref py py-class docutils literal notranslate"><span class="pre">Discretization</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>keyword</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><em>str</em></a>) – </p></li>
<li><p><strong>interfaces</strong> (<em>List</em><em>[</em><em>pp.MortarGrid</em><em>]</em>) – </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="porepy.numerics.ad.Scalar">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Scalar</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/porepy/numerics/ad/operators.html#Scalar"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#porepy.numerics.ad.Scalar" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="porepy.numerics.ad.operators.html#porepy.numerics.ad.operators.Operator" title="porepy.numerics.ad.operators.Operator"><code class="xref py py-class docutils literal notranslate"><span class="pre">Operator</span></code></a></p>
<p>Ad representation of a scalar.</p>
<p>This is a shallow wrapper around a real scalar. It may be useful to combine
the scalar with other types of Ad objects.</p>
<p>NOTE: Since this is a wrapper around a Python immutable, copying a Scalar will
effectively create a deep copy, i.e., changes in the value of one Scalar will not
be reflected in the other. This is in contrast to the behavior of the other
Ad objects.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>value</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><em>float</em></a>) – </p></li>
<li><p><strong>name</strong> (<em>Optional</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><em>str</em></a><em>]</em>) – </p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="porepy.numerics.ad.Scalar.parse">
<span class="sig-name descname"><span class="pre">parse</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mdg</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/porepy/numerics/ad/operators.html#Scalar.parse"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#porepy.numerics.ad.Scalar.parse" title="Permalink to this definition"></a></dt>
<dd><p>See <a class="reference internal" href="#porepy.numerics.ad.Operator.parse" title="porepy.numerics.ad.Operator.parse"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Operator.parse()</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The wrapped number.</p>
</dd>
<dt class="field-even">Parameters</dt>
<dd class="field-even"><p><strong>mdg</strong> (<a class="reference internal" href="porepy.grids.md_grid.html#porepy.grids.md_grid.MixedDimensionalGrid" title="porepy.grids.md_grid.MixedDimensionalGrid"><em>MixedDimensionalGrid</em></a>) – </p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)">float</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="porepy.numerics.ad.Scalar.interfaces">
<span class="sig-name descname"><span class="pre">interfaces</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.11)"><span class="pre">list</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="porepy.grids.mortar_grid.html#porepy.grids.mortar_grid.MortarGrid" title="porepy.grids.mortar_grid.MortarGrid"><span class="pre">porepy.grids.mortar_grid.MortarGrid</span></a><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#porepy.numerics.ad.Scalar.interfaces" title="Permalink to this definition"></a></dt>
<dd><p>List of interfaces on which the operator is defined, passed at instantiation.</p>
<p>Will be empty for operators not associated with specific interfaces.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="porepy.numerics.ad.Scalar.subdomains">
<span class="sig-name descname"><span class="pre">subdomains</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.11)"><span class="pre">list</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="porepy.grids.grid.html#porepy.grids.grid.Grid" title="porepy.grids.grid.Grid"><span class="pre">porepy.grids.grid.Grid</span></a><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#porepy.numerics.ad.Scalar.subdomains" title="Permalink to this definition"></a></dt>
<dd><p>List of subdomains on which the operator is defined, passed at instantiation.</p>
<p>Will be empty for operators not associated with specific subdomains.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="porepy.numerics.ad.SubdomainProjections">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">SubdomainProjections</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">subdomains</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/porepy/numerics/ad/grid_operators.html#SubdomainProjections"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#porepy.numerics.ad.SubdomainProjections" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="porepy.numerics.ad.operators.html#porepy.numerics.ad.operators.Operator" title="porepy.numerics.ad.operators.Operator"><code class="xref py py-class docutils literal notranslate"><span class="pre">Operator</span></code></a></p>
<p>Wrapper class for generating projection to and from subdomains.</p>
<p>One use case in when variables are defined on only some subdomains.</p>
<p>The class should be used through the methods {cell, face}_{projection, restriction}.</p>
<p>See also MortarProjections for projections to and from mortar subdomains.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>subdomains</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.11)"><em>list</em></a><em>[</em><a class="reference internal" href="porepy.grids.grid.html#porepy.grids.grid.Grid" title="porepy.grids.grid.Grid"><em>porepy.grids.grid.Grid</em></a><em>]</em>) – </p></li>
<li><p><strong>dim</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a>) – </p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="porepy.numerics.ad.SubdomainProjections.cell_prolongation">
<span class="sig-name descname"><span class="pre">cell_prolongation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">subdomains</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/porepy/numerics/ad/grid_operators.html#SubdomainProjections.cell_prolongation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#porepy.numerics.ad.SubdomainProjections.cell_prolongation" title="Permalink to this definition"></a></dt>
<dd><p>Construct prolongation from subdomain to global cell quantities.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>subdomains</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">List</span> <span class="pre">of</span> <span class="pre">pp.Grid</span></code>) – One or several subdomains to which
the prolongation should apply.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><dl class="simple">
<dt>Matrix operator (in the Ad sense) that represent the</dt><dd><p>prolongation.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>pp.ad.Matrix</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="porepy.numerics.ad.SubdomainProjections.cell_restriction">
<span class="sig-name descname"><span class="pre">cell_restriction</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">subdomains</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/porepy/numerics/ad/grid_operators.html#SubdomainProjections.cell_restriction"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#porepy.numerics.ad.SubdomainProjections.cell_restriction" title="Permalink to this definition"></a></dt>
<dd><p>Construct restrictions from global to subdomain cell quantities.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>subdomains</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">List</span> <span class="pre">of</span> <span class="pre">pp.Grid</span></code>) – One or several subdomains to which
the projection should apply.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><dl class="simple">
<dt>Matrix operator (in the Ad sense) that represents the</dt><dd><p>projection.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>pp.ad.Matrix</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="porepy.numerics.ad.SubdomainProjections.face_prolongation">
<span class="sig-name descname"><span class="pre">face_prolongation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">subdomains</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/porepy/numerics/ad/grid_operators.html#SubdomainProjections.face_prolongation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#porepy.numerics.ad.SubdomainProjections.face_prolongation" title="Permalink to this definition"></a></dt>
<dd><p>Construct prolongation from subdomain to global face quantities.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>subdomains</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">List</span> <span class="pre">of</span> <span class="pre">pp.Grid</span></code>) – One or several subdomains to which
the prolongation should apply.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><dl class="simple">
<dt>Matrix operator (in the Ad sense) that represent the</dt><dd><p>prolongation.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>pp.ad.Matrix</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="porepy.numerics.ad.SubdomainProjections.face_restriction">
<span class="sig-name descname"><span class="pre">face_restriction</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">subdomains</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/porepy/numerics/ad/grid_operators.html#SubdomainProjections.face_restriction"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#porepy.numerics.ad.SubdomainProjections.face_restriction" title="Permalink to this definition"></a></dt>
<dd><p>Construct restrictions from global to subdomain face quantities.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>subdomains</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">List</span> <span class="pre">of</span> <span class="pre">pp.Grid</span></code>) – One or several subdomains to which
the projection should apply.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><dl class="simple">
<dt>Matrix operator (in the Ad sense) that represent the</dt><dd><p>projection.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>pp.ad.Matrix</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="porepy.numerics.ad.SubdomainProjections.interfaces">
<span class="sig-name descname"><span class="pre">interfaces</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.11)"><span class="pre">list</span></a><span class="p"><span class="pre">[</span></span><span class="pre">pp.MortarGrid</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#porepy.numerics.ad.SubdomainProjections.interfaces" title="Permalink to this definition"></a></dt>
<dd><p>List of interfaces on which the operator is defined, passed at instantiation.</p>
<p>Will be empty for operators not associated with specific interfaces.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="porepy.numerics.ad.SubdomainProjections.subdomains">
<span class="sig-name descname"><span class="pre">subdomains</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.11)"><span class="pre">list</span></a><span class="p"><span class="pre">[</span></span><span class="pre">pp.Grid</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#porepy.numerics.ad.SubdomainProjections.subdomains" title="Permalink to this definition"></a></dt>
<dd><p>List of subdomains on which the operator is defined, passed at instantiation.</p>
<p>Will be empty for operators not associated with specific subdomains.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="porepy.numerics.ad.TimeDependentArray">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">TimeDependentArray</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subdomains</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interfaces</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">previous_timestep</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/porepy/numerics/ad/operators.html#TimeDependentArray"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#porepy.numerics.ad.TimeDependentArray" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="porepy.numerics.ad.operators.html#porepy.numerics.ad.operators.Array" title="porepy.numerics.ad.operators.Array"><code class="xref py py-class docutils literal notranslate"><span class="pre">Array</span></code></a></p>
<p>An Ad-wrapper around a time-dependent numpy array.</p>
<p>The array is tied to a MixedDimensionalGrid, and is distributed among the data
dictionaries associated with subdomains and interfaces.
The array values are stored
in <code class="docutils literal notranslate"><span class="pre">data[pp.STATE][pp.ITERATE][self._name]</span></code> for the current time and
<code class="docutils literal notranslate"><span class="pre">data[pp.STATE][self._name]</span></code> for the previous time.</p>
<p>The array can be differentiated in time using <code class="docutils literal notranslate"><span class="pre">pp.ad.dt()</span></code>.</p>
<p>The intended use is to represent time-varying quantities in equations, e.g., source
terms. Future use will also include numerical values of boundary conditions,
however, this is pending an update to the model classes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><em>str</em></a>) – Name of the variable. Should correspond to items in data[pp.STATE].</p></li>
<li><p><strong>subdomains</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.11)"><em>list</em></a><em>[</em><a class="reference internal" href="porepy.grids.grid.html#porepy.grids.grid.Grid" title="porepy.grids.grid.Grid"><em>porepy.grids.grid.Grid</em></a><em>]</em>) – Subdomains on which the array is defined. Defaults to None.</p></li>
<li><p><strong>interfaces</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.11)"><em>list</em></a><em>[</em><a class="reference internal" href="porepy.grids.mortar_grid.html#porepy.grids.mortar_grid.MortarGrid" title="porepy.grids.mortar_grid.MortarGrid"><em>porepy.grids.mortar_grid.MortarGrid</em></a><em>]</em>) – Interfaces on which the array is defined. Defaults to None.
Exactly one of subdomains and interfaces must be non-empty.</p></li>
<li><p><strong>previous_timestep</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><em>bool</em></a>) – Flag indicating if the array should be evaluated at the
previous time step.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="porepy.numerics.ad.TimeDependentArray.previous_timestep">
<span class="sig-name descname"><span class="pre">previous_timestep</span></span><a class="reference internal" href="../../_modules/porepy/numerics/ad/operators.html#TimeDependentArray.previous_timestep"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#porepy.numerics.ad.TimeDependentArray.previous_timestep" title="Permalink to this definition"></a></dt>
<dd><p>If True, the array will be evaluated using data[pp.STATE]
(data being the data dictionaries for subdomains and interfaces), if False,
data[pp.STATE][pp.ITERATE] is used.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="porepy.numerics.ad.operators.html#porepy.numerics.ad.operators.TimeDependentArray" title="porepy.numerics.ad.operators.TimeDependentArray"><em>TimeDependentArray</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="field-list simple">
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.11)"><strong>ValueError</strong></a> – If either none of, or both of, subdomains and interfaces are empty.</p>
</dd>
<dt class="field-even">Parameters</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><em>str</em></a>) – </p></li>
<li><p><strong>subdomains</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.11)"><em>list</em></a><em>[</em><a class="reference internal" href="porepy.grids.grid.html#porepy.grids.grid.Grid" title="porepy.grids.grid.Grid"><em>porepy.grids.grid.Grid</em></a><em>]</em>) – </p></li>
<li><p><strong>interfaces</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.11)"><em>list</em></a><em>[</em><a class="reference internal" href="porepy.grids.mortar_grid.html#porepy.grids.mortar_grid.MortarGrid" title="porepy.grids.mortar_grid.MortarGrid"><em>porepy.grids.mortar_grid.MortarGrid</em></a><em>]</em>) – </p></li>
<li><p><strong>previous_timestep</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><em>bool</em></a>) – </p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="porepy.numerics.ad.TimeDependentArray.parse">
<span class="sig-name descname"><span class="pre">parse</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mdg</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/porepy/numerics/ad/operators.html#TimeDependentArray.parse"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#porepy.numerics.ad.TimeDependentArray.parse" title="Permalink to this definition"></a></dt>
<dd><p>Convert this array into numerical values.</p>
<p>The numerical values will be picked from the representation of the array in
<code class="docutils literal notranslate"><span class="pre">data[pp.STATE][pp.ITERATE]</span></code> (where data is the data dictionary of the subdomains
or interfaces of this Array), or, if <code class="docutils literal notranslate"><span class="pre">self.prev_time</span> <span class="pre">=</span> <span class="pre">True</span></code>,
from <code class="docutils literal notranslate"><span class="pre">data[pp.STATE]</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>mdg</strong> (<a class="reference internal" href="porepy.grids.md_grid.html#porepy.grids.md_grid.MixedDimensionalGrid" title="porepy.grids.md_grid.MixedDimensionalGrid"><em>MixedDimensionalGrid</em></a>) – Mixed-dimensional grid.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A numpy ndarray containing the numerical values of this array.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.24)"><em>ndarray</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id0">
<span class="sig-name descname"><span class="pre">previous_timestep</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/porepy/numerics/ad/operators.html#TimeDependentArray.previous_timestep"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id0" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>This array represented at the previous time step.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference internal" href="porepy.numerics.ad.operators.html#porepy.numerics.ad.operators.TimeDependentArray" title="porepy.numerics.ad.operators.TimeDependentArray"><em>TimeDependentArray</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="porepy.numerics.ad.TimeDependentArray.interfaces">
<span class="sig-name descname"><span class="pre">interfaces</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.11)"><span class="pre">list</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="porepy.grids.mortar_grid.html#porepy.grids.mortar_grid.MortarGrid" title="porepy.grids.mortar_grid.MortarGrid"><span class="pre">porepy.grids.mortar_grid.MortarGrid</span></a><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#porepy.numerics.ad.TimeDependentArray.interfaces" title="Permalink to this definition"></a></dt>
<dd><p>List of interfaces on which the operator is defined, passed at instantiation.</p>
<p>Will be empty for operators not associated with specific interfaces.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="porepy.numerics.ad.TimeDependentArray.prev_time">
<span class="sig-name descname"><span class="pre">prev_time</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><span class="pre">bool</span></a></em><a class="headerlink" href="#porepy.numerics.ad.TimeDependentArray.prev_time" title="Permalink to this definition"></a></dt>
<dd><p>If True, the array will be evaluated using <code class="docutils literal notranslate"><span class="pre">data[pp.STATE]</span></code>
(data being the data dictionaries for subdomains and interfaces).</p>
<p>If False, <code class="docutils literal notranslate"><span class="pre">data[pp.STATE][pp.ITERATE]</span></code> is used.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="porepy.numerics.ad.TimeDependentArray.subdomains">
<span class="sig-name descname"><span class="pre">subdomains</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.11)"><span class="pre">list</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="porepy.grids.grid.html#porepy.grids.grid.Grid" title="porepy.grids.grid.Grid"><span class="pre">porepy.grids.grid.Grid</span></a><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#porepy.numerics.ad.TimeDependentArray.subdomains" title="Permalink to this definition"></a></dt>
<dd><p>List of subdomains on which the operator is defined, passed at instantiation.</p>
<p>Will be empty for operators not associated with specific subdomains.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="porepy.numerics.ad.TpfaAd">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">TpfaAd</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">keyword</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subdomains</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/porepy/numerics/ad/discretizations.html#TpfaAd"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#porepy.numerics.ad.TpfaAd" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="porepy.numerics.ad.discretizations.html#porepy.numerics.ad.discretizations.Discretization" title="porepy.numerics.ad.discretizations.Discretization"><code class="xref py py-class docutils literal notranslate"><span class="pre">Discretization</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>keyword</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><em>str</em></a>) – </p></li>
<li><p><strong>subdomains</strong> (<em>List</em><em>[</em><em>pp.Grid</em><em>]</em>) – </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="porepy.numerics.ad.Trace">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Trace</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">subdomains</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/porepy/numerics/ad/grid_operators.html#Trace"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#porepy.numerics.ad.Trace" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="porepy.numerics.ad.operators.html#porepy.numerics.ad.operators.Operator" title="porepy.numerics.ad.operators.Operator"><code class="xref py py-class docutils literal notranslate"><span class="pre">Operator</span></code></a></p>
<p>Wrapper class for Ad representations of trace operators and their inverse,
that is, mappings between grid cells and faces.</p>
<p>NOTE: The mapping will hit both boundary and interior faces, so the values
to be mapped should be carefully filtered (e.g. by combining it with a
mortar mapping).</p>
<p>The mapping does not alter signs of variables, that is, the direction
of face normal vectors is not accounted for.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>subdomains</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.11)"><em>list</em></a><em>[</em><a class="reference internal" href="porepy.grids.grid.html#porepy.grids.grid.Grid" title="porepy.grids.grid.Grid"><em>porepy.grids.grid.Grid</em></a><em>]</em>) – </p></li>
<li><p><strong>dim</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a>) – </p></li>
<li><p><strong>name</strong> (<em>Optional</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><em>str</em></a><em>]</em>) – </p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="porepy.numerics.ad.Trace.trace">
<span class="sig-name descname"><span class="pre">trace</span></span><a class="headerlink" href="#porepy.numerics.ad.Trace.trace" title="Permalink to this definition"></a></dt>
<dd><p>Matrix of trace projections from cells to faces.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">pp.ad.Matrix</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="porepy.numerics.ad.Trace.inv_trace">
<span class="sig-name descname"><span class="pre">inv_trace</span></span><a class="headerlink" href="#porepy.numerics.ad.Trace.inv_trace" title="Permalink to this definition"></a></dt>
<dd><p>Matrix of trace projections from faces to cells.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">pp.ad.Matrix</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="porepy.numerics.ad.Trace.interfaces">
<span class="sig-name descname"><span class="pre">interfaces</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.11)"><span class="pre">list</span></a><span class="p"><span class="pre">[</span></span><span class="pre">pp.MortarGrid</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#porepy.numerics.ad.Trace.interfaces" title="Permalink to this definition"></a></dt>
<dd><p>List of interfaces on which the operator is defined, passed at instantiation.</p>
<p>Will be empty for operators not associated with specific interfaces.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="porepy.numerics.ad.Trace.subdomains">
<span class="sig-name descname"><span class="pre">subdomains</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.11)"><span class="pre">list</span></a><span class="p"><span class="pre">[</span></span><span class="pre">pp.Grid</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#porepy.numerics.ad.Trace.subdomains" title="Permalink to this definition"></a></dt>
<dd><p>List of subdomains on which the operator is defined, passed at instantiation.</p>
<p>Will be empty for operators not associated with specific subdomains.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="porepy.numerics.ad.UpwindAd">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">UpwindAd</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">keyword</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subdomains</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/porepy/numerics/ad/discretizations.html#UpwindAd"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#porepy.numerics.ad.UpwindAd" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="porepy.numerics.ad.discretizations.html#porepy.numerics.ad.discretizations.Discretization" title="porepy.numerics.ad.discretizations.Discretization"><code class="xref py py-class docutils literal notranslate"><span class="pre">Discretization</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>keyword</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><em>str</em></a>) – </p></li>
<li><p><strong>subdomains</strong> (<em>List</em><em>[</em><em>pp.Grid</em><em>]</em>) – </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="porepy.numerics.ad.UpwindCouplingAd">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">UpwindCouplingAd</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">keyword</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interfaces</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/porepy/numerics/ad/discretizations.html#UpwindCouplingAd"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#porepy.numerics.ad.UpwindCouplingAd" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="porepy.numerics.ad.discretizations.html#porepy.numerics.ad.discretizations.Discretization" title="porepy.numerics.ad.discretizations.Discretization"><code class="xref py py-class docutils literal notranslate"><span class="pre">Discretization</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>keyword</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><em>str</em></a>) – </p></li>
<li><p><strong>interfaces</strong> (<em>List</em><em>[</em><em>pp.MortarGrid</em><em>]</em>) – </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="porepy.numerics.ad.Variable">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Variable</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ndof</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">domain</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tags</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">previous_timestep</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">previous_iteration</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/porepy/numerics/ad/operators.html#Variable"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#porepy.numerics.ad.Variable" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="porepy.numerics.ad.operators.html#porepy.numerics.ad.operators.Operator" title="porepy.numerics.ad.operators.Operator"><code class="xref py py-class docutils literal notranslate"><span class="pre">Operator</span></code></a></p>
<p>AD operator representing a variable defined on a single grid or mortar grid.</p>
<p>For combinations of variables on different subdomains, see <code class="xref py py-class docutils literal notranslate"><span class="pre">MergedVariable</span></code>.</p>
<p>Conversion of the variable into numerical value should be done with respect to the
state of an array; see <a class="reference internal" href="#porepy.numerics.ad.Operator.evaluate" title="porepy.numerics.ad.Operator.evaluate"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Operator.evaluate()</span></code></a>. Therefore, the variable does not
implement the method <a class="reference internal" href="#porepy.numerics.ad.Operator.parse" title="porepy.numerics.ad.Operator.parse"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Operator.parse()</span></code></a>.</p>
<p>A variable is associated with either a grid or an interface. Therefore it is assumed
that either <code class="docutils literal notranslate"><span class="pre">subdomains</span></code> or <code class="docutils literal notranslate"><span class="pre">interfaces</span></code> is passed as an argument.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><em>str</em></a>) – Variable name.</p></li>
<li><p><strong>ndof</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.11)"><em>dict</em></a><em>[</em><em>Literal</em><em>[</em><em>'cells'</em><em>, </em><em>'faces'</em><em>, </em><em>'nodes'</em><em>]</em><em>, </em><em>int</em><em>]</em>) – Number of dofs per grid element.
Valid keys are <code class="docutils literal notranslate"><span class="pre">cells</span></code>, <code class="docutils literal notranslate"><span class="pre">faces</span></code> and <code class="docutils literal notranslate"><span class="pre">nodes</span></code>.</p></li>
<li><p><strong>subdomains</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">length=1</span></code>) – List containing a single grid.</p></li>
<li><p><strong>interfaces</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">length=1</span></code>) – List containing a single mortar grid.</p></li>
<li><p><strong>num_cells</strong> – Number of cells in the grid.
Only relevant if this is an interface variable.</p></li>
<li><p><strong>domain</strong> (<em>GridLike</em>) – </p></li>
<li><p><strong>tags</strong> (<em>Optional</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.11)"><em>dict</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><em>str</em></a><em>, </em><em>Any</em><em>]</em><em>]</em>) – </p></li>
<li><p><strong>previous_timestep</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><em>bool</em></a>) – </p></li>
<li><p><strong>previous_iteration</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><em>bool</em></a>) – </p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="porepy.numerics.ad.Variable.previous_iteration">
<span class="sig-name descname"><span class="pre">previous_iteration</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/porepy/numerics/ad/operators.html#Variable.previous_iteration"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#porepy.numerics.ad.Variable.previous_iteration" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>A representation of this variable on the previous time iteration,
with its <code class="docutils literal notranslate"><span class="pre">prev_iter</span></code> attribute set to <code class="docutils literal notranslate"><span class="pre">True</span></code>.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference internal" href="porepy.numerics.ad.operators.html#porepy.numerics.ad.operators.Variable" title="porepy.numerics.ad.operators.Variable"><em>Variable</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="porepy.numerics.ad.Variable.previous_timestep">
<span class="sig-name descname"><span class="pre">previous_timestep</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/porepy/numerics/ad/operators.html#Variable.previous_timestep"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#porepy.numerics.ad.Variable.previous_timestep" title="Permalink to this definition"></a></dt>
<dd><p>Return a representation of this variable on the previous time step.</p>
<p>If the variable is already a representation of the previous time step, the
method returns itself.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>A representation of this variable at the previous time step,
with its <code class="docutils literal notranslate"><span class="pre">prev_time</span></code> attribute set to <code class="docutils literal notranslate"><span class="pre">True</span></code>.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference internal" href="porepy.numerics.ad.operators.html#porepy.numerics.ad.operators.Variable" title="porepy.numerics.ad.operators.Variable"><em>Variable</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="porepy.numerics.ad.Variable.set_name">
<span class="sig-name descname"><span class="pre">set_name</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/porepy/numerics/ad/operators.html#Variable.set_name"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#porepy.numerics.ad.Variable.set_name" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#RuntimeError" title="(in Python v3.11)"><strong>RuntimeError</strong></a> – Variables must not be re-named once defined,
    since the name is used as an identifier.</p>
</dd>
<dt class="field-even">Parameters</dt>
<dd class="field-even"><p><strong>name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><em>str</em></a>) – </p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="porepy.numerics.ad.Variable.size">
<span class="sig-name descname"><span class="pre">size</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/porepy/numerics/ad/operators.html#Variable.size"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#porepy.numerics.ad.Variable.size" title="Permalink to this definition"></a></dt>
<dd><p>Returns the total number of dofs this variable has.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)">int</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="porepy.numerics.ad.Variable.domain">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">domain</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.11)"><span class="pre">Union</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="porepy.grids.grid.html#porepy.grids.grid.Grid" title="porepy.grids.grid.Grid"><span class="pre">Grid</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="porepy.grids.mortar_grid.html#porepy.grids.mortar_grid.MortarGrid" title="porepy.grids.mortar_grid.MortarGrid"><span class="pre">MortarGrid</span></a><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#porepy.numerics.ad.Variable.domain" title="Permalink to this definition"></a></dt>
<dd><p>The grid or mortar grid on which this variable is defined.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="porepy.numerics.ad.Variable.id">
<span class="sig-name descname"><span class="pre">id</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><span class="pre">int</span></a></em><a class="headerlink" href="#porepy.numerics.ad.Variable.id" title="Permalink to this definition"></a></dt>
<dd><p>ID counter. Used to identify variables during operator parsing.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="porepy.numerics.ad.Variable.interfaces">
<span class="sig-name descname"><span class="pre">interfaces</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.11)"><span class="pre">list</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="porepy.grids.mortar_grid.html#porepy.grids.mortar_grid.MortarGrid" title="porepy.grids.mortar_grid.MortarGrid"><span class="pre">porepy.grids.mortar_grid.MortarGrid</span></a><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#porepy.numerics.ad.Variable.interfaces" title="Permalink to this definition"></a></dt>
<dd><p>List of interfaces on which the operator is defined, passed at instantiation.</p>
<p>Will be empty for operators not associated with specific interfaces.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="porepy.numerics.ad.Variable.original_variable">
<span class="sig-name descname"><span class="pre">original_variable</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="porepy.numerics.ad.operators.html#porepy.numerics.ad.operators.Variable" title="porepy.numerics.ad.operators.Variable"><span class="pre">Variable</span></a></em><a class="headerlink" href="#porepy.numerics.ad.Variable.original_variable" title="Permalink to this definition"></a></dt>
<dd><p>The original variable, if this variable is a copy of another variable.</p>
<p>This attribute is used by the methods <a class="reference internal" href="#porepy.numerics.ad.Variable.previous_timestep" title="porepy.numerics.ad.Variable.previous_timestep"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Variable.previous_timestep()</span></code></a> and
<a class="reference internal" href="#porepy.numerics.ad.Variable.previous_iteration" title="porepy.numerics.ad.Variable.previous_iteration"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Variable.previous_iteration()</span></code></a> to keep a link to the original variable.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="porepy.numerics.ad.Variable.prev_iter">
<span class="sig-name descname"><span class="pre">prev_iter</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><span class="pre">bool</span></a></em><a class="headerlink" href="#porepy.numerics.ad.Variable.prev_iter" title="Permalink to this definition"></a></dt>
<dd><p>Flag indicating if the variable represents the state at the previous iteration.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="porepy.numerics.ad.Variable.prev_time">
<span class="sig-name descname"><span class="pre">prev_time</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><span class="pre">bool</span></a></em><a class="headerlink" href="#porepy.numerics.ad.Variable.prev_time" title="Permalink to this definition"></a></dt>
<dd><p>Flag indicating if the variable represents the state at the previous time step.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="porepy.numerics.ad.Variable.subdomains">
<span class="sig-name descname"><span class="pre">subdomains</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.11)"><span class="pre">list</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="porepy.grids.grid.html#porepy.grids.grid.Grid" title="porepy.grids.grid.Grid"><span class="pre">porepy.grids.grid.Grid</span></a><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#porepy.numerics.ad.Variable.subdomains" title="Permalink to this definition"></a></dt>
<dd><p>List of subdomains on which the operator is defined, passed at instantiation.</p>
<p>Will be empty for operators not associated with specific subdomains.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="porepy.numerics.ad.Variable.tags">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">tags</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.11)"><span class="pre">dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.11)"><span class="pre">Any</span></a><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#porepy.numerics.ad.Variable.tags" title="Permalink to this definition"></a></dt>
<dd><p>A dictionary of tags associated with this variable.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="porepy.numerics.ad.WellCouplingAd">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">WellCouplingAd</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">keyword</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interfaces</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/porepy/numerics/ad/discretizations.html#WellCouplingAd"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#porepy.numerics.ad.WellCouplingAd" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="porepy.numerics.ad.discretizations.html#porepy.numerics.ad.discretizations.Discretization" title="porepy.numerics.ad.discretizations.Discretization"><code class="xref py py-class docutils literal notranslate"><span class="pre">Discretization</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>keyword</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><em>str</em></a>) – </p></li>
<li><p><strong>interfaces</strong> (<em>List</em><em>[</em><em>pp.MortarGrid</em><em>]</em>) – </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="porepy.numerics.ad.abs">
<span class="sig-name descname"><span class="pre">abs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">var</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/porepy/numerics/ad/functions.html#abs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#porepy.numerics.ad.abs" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="porepy.numerics.ad.arccos">
<span class="sig-name descname"><span class="pre">arccos</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">var</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/porepy/numerics/ad/functions.html#arccos"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#porepy.numerics.ad.arccos" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="porepy.numerics.ad.arccosh">
<span class="sig-name descname"><span class="pre">arccosh</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">var</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/porepy/numerics/ad/functions.html#arccosh"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#porepy.numerics.ad.arccosh" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="porepy.numerics.ad.arcsin">
<span class="sig-name descname"><span class="pre">arcsin</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">var</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/porepy/numerics/ad/functions.html#arcsin"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#porepy.numerics.ad.arcsin" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="porepy.numerics.ad.arcsinh">
<span class="sig-name descname"><span class="pre">arcsinh</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">var</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/porepy/numerics/ad/functions.html#arcsinh"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#porepy.numerics.ad.arcsinh" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="porepy.numerics.ad.arctan">
<span class="sig-name descname"><span class="pre">arctan</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">var</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/porepy/numerics/ad/functions.html#arctan"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#porepy.numerics.ad.arctan" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="porepy.numerics.ad.arctanh">
<span class="sig-name descname"><span class="pre">arctanh</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">var</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/porepy/numerics/ad/functions.html#arctanh"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#porepy.numerics.ad.arctanh" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="porepy.numerics.ad.characteristic_function">
<span class="sig-name descname"><span class="pre">characteristic_function</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">var</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/porepy/numerics/ad/functions.html#characteristic_function"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#porepy.numerics.ad.characteristic_function" title="Permalink to this definition"></a></dt>
<dd><p>Characteristic function of an ad variable.</p>
<p>Returns 1 if <code class="docutils literal notranslate"><span class="pre">var.val</span></code> is within absolute tolerance = <code class="docutils literal notranslate"><span class="pre">tol</span></code> of zero.
The derivative is set to zero independent of <code class="docutils literal notranslate"><span class="pre">var.val</span></code>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>See module level documentation on how to wrap functions like this in <code class="docutils literal notranslate"><span class="pre">ad.Function</span></code>.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tol</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><em>float</em></a>) – Absolute tolerance for comparison with 0 using np.isclose.</p></li>
<li><p><strong>var</strong> (<a class="reference internal" href="porepy.numerics.ad.forward_mode.html#porepy.numerics.ad.forward_mode.Ad_array" title="porepy.numerics.ad.forward_mode.Ad_array"><em>Ad_array</em></a>) – Ad operator (variable or expression).</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The characteristic function of var with appropriate val and jac attributes.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="porepy.numerics.ad.cos">
<span class="sig-name descname"><span class="pre">cos</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">var</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/porepy/numerics/ad/functions.html#cos"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#porepy.numerics.ad.cos" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="porepy.numerics.ad.cosh">
<span class="sig-name descname"><span class="pre">cosh</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">var</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/porepy/numerics/ad/functions.html#cosh"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#porepy.numerics.ad.cosh" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="porepy.numerics.ad.dt">
<span class="sig-name descname"><span class="pre">dt</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">op</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_step</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/porepy/numerics/ad/time_derivatives.html#dt"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#porepy.numerics.ad.dt" title="Permalink to this definition"></a></dt>
<dd><p>Approximate the time-derivative of an operator tree.</p>
<p>This time derivative is obtained by taking a first-order finite difference.</p>
<p>The operator tree at the previous time step is created as a shallow copy, and will
thus be identical to the original operator, except that all time dependent operators
are evaluated at the previous time step.</p>
<p>If the time-dependent quantity q is already evaluated at the previous time step, its
derivative will be defined as (q(time=n-1) - q(time=n-1)) / dt = 0.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>op</strong> (<a class="reference internal" href="porepy.numerics.ad.operators.html#porepy.numerics.ad.operators.Operator" title="porepy.numerics.ad.operators.Operator"><em>Operator</em></a>) – Operator tree to be differentiated.</p></li>
<li><p><strong>dt</strong> – Size of time step.</p></li>
<li><p><strong>time_step</strong> (<a class="reference internal" href="porepy.numerics.ad.operators.html#porepy.numerics.ad.operators.Scalar" title="porepy.numerics.ad.operators.Scalar"><em>Scalar</em></a>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A first-order approximation of the time derivative of op.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="porepy.numerics.ad.operators.html#porepy.numerics.ad.operators.Operator" title="porepy.numerics.ad.operators.Operator"><em>Operator</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="porepy.numerics.ad.exp">
<span class="sig-name descname"><span class="pre">exp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">var</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/porepy/numerics/ad/functions.html#exp"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#porepy.numerics.ad.exp" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="porepy.numerics.ad.heaviside">
<span class="sig-name descname"><span class="pre">heaviside</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">var</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zerovalue</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/porepy/numerics/ad/functions.html#heaviside"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#porepy.numerics.ad.heaviside" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>zerovalue</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><em>float</em></a>) – </p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="porepy.numerics.ad.heaviside_smooth">
<span class="sig-name descname"><span class="pre">heaviside_smooth</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">var</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-3</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/porepy/numerics/ad/functions.html#heaviside_smooth"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#porepy.numerics.ad.heaviside_smooth" title="Permalink to this definition"></a></dt>
<dd><p>Smooth (regularized) version of the Heaviside function.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<dl class="simple">
<dt>The analytical expression for the smooth version Heaviside function reads:</dt><dd><p><code class="docutils literal notranslate"><span class="pre">H_eps(x)</span> <span class="pre">=</span> <span class="pre">(1/2)</span> <span class="pre">*</span> <span class="pre">(1</span> <span class="pre">+</span> <span class="pre">(2/pi)</span> <span class="pre">*</span> <span class="pre">arctan(x/eps))</span></code>,</p>
</dd>
<dt>with its derivative smoothly approximating the Dirac delta function:</dt><dd><p><code class="docutils literal notranslate"><span class="pre">d(H(x))/dx</span> <span class="pre">=</span> <span class="pre">delta_eps</span> <span class="pre">=</span> <span class="pre">(1/pi)</span> <span class="pre">*</span> <span class="pre">(eps</span> <span class="pre">/</span> <span class="pre">(eps^2</span> <span class="pre">+</span> <span class="pre">x^2))</span></code>.</p>
</dd>
</dl>
<p>Reference: <a class="reference external" href="https://ieeexplore.ieee.org/document/902291">https://ieeexplore.ieee.org/document/902291</a></p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>var</strong> – Input array.</p></li>
<li><p><strong>eps</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">optional</span></code>) – Regularization parameter. The function will converge to the
Heaviside function in the limit when <code class="docutils literal notranslate"><span class="pre">eps</span> <span class="pre">--&gt;</span> <span class="pre">0</span></code>. The default is <code class="docutils literal notranslate"><span class="pre">1e-3</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Regularized heaviside function (and its Jacobian if applicable) in form of a
Ad_array or ndarray (depending on the input).</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="porepy.numerics.ad.initAdArrays">
<span class="sig-name descname"><span class="pre">initAdArrays</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">variables</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/porepy/numerics/ad/forward_mode.html#initAdArrays"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#porepy.numerics.ad.initAdArrays" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="porepy.numerics.ad.l2_norm">
<span class="sig-name descname"><span class="pre">l2_norm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">var</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/porepy/numerics/ad/functions.html#l2_norm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#porepy.numerics.ad.l2_norm" title="Permalink to this definition"></a></dt>
<dd><p>L2 norm of a vector variable.</p>
<p>For the example of dim=3 components and n vectors, the ordering is assumed
to be <code class="docutils literal notranslate"><span class="pre">[u0,</span> <span class="pre">v0,</span> <span class="pre">w0,</span> <span class="pre">u1,</span> <span class="pre">v1,</span> <span class="pre">w1,</span> <span class="pre">...,</span> <span class="pre">un,</span> <span class="pre">vn,</span> <span class="pre">wn]</span></code></p>
<p>Vectors satisfying ui=vi=wi=0 are assigned zero entries in the jacobi matrix</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>See module level documentation on how to wrap functions like this in ad.Function.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dim</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a>) – Dimension, i.e. number of vector components.</p></li>
<li><p><strong>var</strong> (<a class="reference internal" href="porepy.numerics.ad.forward_mode.html#porepy.numerics.ad.forward_mode.Ad_array" title="porepy.numerics.ad.forward_mode.Ad_array"><em>Ad_array</em></a>) – Ad operator (variable or expression) which is argument of the norm function.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The norm of var with appropriate val and jac attributes.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="porepy.numerics.ad.forward_mode.html#porepy.numerics.ad.forward_mode.Ad_array" title="porepy.numerics.ad.forward_mode.Ad_array"><em>Ad_array</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="porepy.numerics.ad.log">
<span class="sig-name descname"><span class="pre">log</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">var</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/porepy/numerics/ad/functions.html#log"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#porepy.numerics.ad.log" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="porepy.numerics.ad.maximum">
<span class="sig-name descname"><span class="pre">maximum</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">var_0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">var_1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/porepy/numerics/ad/functions.html#maximum"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#porepy.numerics.ad.maximum" title="Permalink to this definition"></a></dt>
<dd><p>Ad maximum function represented as an Ad_array.</p>
<p>The arguments can be either Ad_arrays or ndarrays, this duality is needed to allow
for parsing of operators that can be taken at the current iteration (in which case
it will parse as an Ad_array) or at the previous iteration or time step (in which
case it will parse as a numpy array).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>var_0</strong> (<em>pp.ad.Ad_array</em>) – First argument to the maximum function.</p></li>
<li><p><strong>var_1</strong> (<em>pp.ad.Ad_array</em><em> | </em><em>np.ndarray</em>) – Second argument.</p></li>
<li><p><strong>scalar</strong> (<em>If one</em><em> of </em><em>the input arguments is</em>) – </p></li>
<li><p><strong>used.</strong> (<em>broadcasting will be</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The maximum of the two arguments, taken element-wise in the arrays. The return
type is Ad_array if at least one of the arguments is an Ad_array, otherwise it
is an ndarray. If an Ad_array is returned, the Jacobian is computed according to
the maximum values of the Ad_arrays (so if element <code class="docutils literal notranslate"><span class="pre">i</span></code> of the maximum is
picked from <code class="docutils literal notranslate"><span class="pre">var_0</span></code>, row <code class="docutils literal notranslate"><span class="pre">i</span></code> of the Jacobian is also picked from the
Jacobian of <code class="docutils literal notranslate"><span class="pre">var_0</span></code>). If <code class="docutils literal notranslate"><span class="pre">var_0</span></code> is a ndarray, its Jacobian is set to zero.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>pp.ad.Ad_array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="porepy.numerics.ad.sign">
<span class="sig-name descname"><span class="pre">sign</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">var</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/porepy/numerics/ad/functions.html#sign"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#porepy.numerics.ad.sign" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="porepy.numerics.ad.sin">
<span class="sig-name descname"><span class="pre">sin</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">var</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/porepy/numerics/ad/functions.html#sin"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#porepy.numerics.ad.sin" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="porepy.numerics.ad.sinh">
<span class="sig-name descname"><span class="pre">sinh</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">var</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/porepy/numerics/ad/functions.html#sinh"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#porepy.numerics.ad.sinh" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="porepy.numerics.ad.tan">
<span class="sig-name descname"><span class="pre">tan</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">var</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/porepy/numerics/ad/functions.html#tan"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#porepy.numerics.ad.tan" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="porepy.numerics.ad.tanh">
<span class="sig-name descname"><span class="pre">tanh</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">var</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/porepy/numerics/ad/functions.html#tanh"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#porepy.numerics.ad.tanh" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="porepy.numerics.ad.time_increment">
<span class="sig-name descname"><span class="pre">time_increment</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">op</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/porepy/numerics/ad/time_derivatives.html#time_increment"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#porepy.numerics.ad.time_increment" title="Permalink to this definition"></a></dt>
<dd><p>Find the time increment of an operator tree.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>op</strong> (<a class="reference internal" href="porepy.numerics.ad.operators.html#porepy.numerics.ad.operators.Operator" title="porepy.numerics.ad.operators.Operator"><em>Operator</em></a>) – Operator tree for which we need the time increment.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The difference of the operator tree now and at the previous time step.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="porepy.numerics.ad.operators.html#porepy.numerics.ad.operators.Operator" title="porepy.numerics.ad.operators.Operator"><em>Operator</em></a></p>
</dd>
</dl>
</dd></dl>

<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this heading"></a></h2>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="porepy.numerics.ad.discretizations.html">porepy.numerics.ad.discretizations module</a></li>
<li class="toctree-l1"><a class="reference internal" href="porepy.numerics.ad.equation_manager.html">porepy.numerics.ad.equation_manager module</a></li>
<li class="toctree-l1"><a class="reference internal" href="porepy.numerics.ad.equation_system.html">porepy.numerics.ad.equation_system module</a></li>
<li class="toctree-l1"><a class="reference internal" href="porepy.numerics.ad.forward_mode.html">porepy.numerics.ad.forward_mode module</a></li>
<li class="toctree-l1"><a class="reference internal" href="porepy.numerics.ad.functions.html">porepy.numerics.ad.functions module</a></li>
<li class="toctree-l1"><a class="reference internal" href="porepy.numerics.ad.grid_operators.html">porepy.numerics.ad.grid_operators module</a></li>
<li class="toctree-l1"><a class="reference internal" href="porepy.numerics.ad.operator_functions.html">porepy.numerics.ad.operator_functions module</a></li>
<li class="toctree-l1"><a class="reference internal" href="porepy.numerics.ad.operators.html">porepy.numerics.ad.operators module</a></li>
<li class="toctree-l1"><a class="reference internal" href="porepy.numerics.ad.time_derivatives.html">porepy.numerics.ad.time_derivatives module</a></li>
</ul>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="porepy.numerics.html" class="btn btn-neutral float-left" title="porepy.numerics package" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="porepy.numerics.ad.discretizations.html" class="btn btn-neutral float-right" title="porepy.numerics.ad.discretizations module" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022 UiB Center for Modeling of Coupled Subsurface Dynamics, GNU LESSER GENERAL PUBLIC LICENSE Version 3, 29 June 2007..</p>
  </div>

   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>